/**
 * Jindo Component
 * @version 1.1.0
 * NHN_Library:Jindo_Component-1.1.0;JavaScript Components for Jindo;
 */


jindo.Component=jindo.$Class({_htEventHandler:null,_htOption:null,$init:function(){var aInstance=this.constructor.getInstance();aInstance.push(this);this._htEventHandler={};this._htOption={};this._htOption._htSetter={};},option:function(sName,vValue){switch(typeof sName){case"undefined":var oOption={};for(var i in this._htOption){if(!(i=="htCustomEventHandler"||i=="_htSetter")){oOption[i]=this._htOption[i];}}
return oOption;case"string":if(typeof vValue!="undefined"){if(sName=="htCustomEventHandler"){if(typeof this._htOption[sName]=="undefined"){this.attach(vValue);}else{return this;}}
this._htOption[sName]=vValue;if(typeof this._htOption._htSetter[sName]=="function"){this._htOption._htSetter[sName](vValue);}}else{return this._htOption[sName];}
break;case"object":for(var sKey in sName){if(sKey=="htCustomEventHandler"){if(typeof this._htOption[sKey]=="undefined"){this.attach(sName[sKey]);}else{continue;}}
if(sKey!=="_htSetter"){this._htOption[sKey]=sName[sKey];}
if(typeof this._htOption._htSetter[sKey]=="function"){this._htOption._htSetter[sKey](sName[sKey]);}}
break;}
return this;},optionSetter:function(sName,fSetter){switch(typeof sName){case"undefined":return this._htOption._htSetter;case"string":if(typeof fSetter!="undefined"){this._htOption._htSetter[sName]=jindo.$Fn(fSetter,this).bind();}else{return this._htOption._htSetter[sName];}
break;case"object":for(var sKey in sName){this._htOption._htSetter[sKey]=jindo.$Fn(sName[sKey],this).bind();}
break;}
return this;},fireEvent:function(sEvent,oEvent){oEvent=oEvent||{};var fInlineHandler=this['on'+sEvent],aHandlerList=this._htEventHandler[sEvent]||[],bHasInlineHandler=typeof fInlineHandler=="function",bHasHandlerList=aHandlerList.length>0;if(!bHasInlineHandler&&!bHasHandlerList){return true;}
aHandlerList=aHandlerList.concat();oEvent.sType=sEvent;if(typeof oEvent._aExtend=='undefined'){oEvent._aExtend=[];oEvent.stop=function(){if(oEvent._aExtend.length>0){oEvent._aExtend[oEvent._aExtend.length-1].bCanceled=true;}};}
oEvent._aExtend.push({sType:sEvent,bCanceled:false});var aArg=[oEvent],i,nLen;for(i=2,nLen=arguments.length;i<nLen;i++){aArg.push(arguments[i]);}
if(bHasInlineHandler){fInlineHandler.apply(this,aArg);}
if(bHasHandlerList){var fHandler;for(i=0,fHandler;(fHandler=aHandlerList[i]);i++){fHandler.apply(this,aArg);}}
return!oEvent._aExtend.pop().bCanceled;},attach:function(sEvent,fHandlerToAttach){if(arguments.length==1){jindo.$H(arguments[0]).forEach(jindo.$Fn(function(fHandler,sEvent){this.attach(sEvent,fHandler);},this).bind());return this;}
var aHandler=this._htEventHandler[sEvent];if(typeof aHandler=='undefined'){aHandler=this._htEventHandler[sEvent]=[];}
aHandler.push(fHandlerToAttach);return this;},detach:function(sEvent,fHandlerToDetach){if(arguments.length==1){jindo.$H(arguments[0]).forEach(jindo.$Fn(function(fHandler,sEvent){this.detach(sEvent,fHandler);},this).bind());return this;}
var aHandler=this._htEventHandler[sEvent];if(aHandler){for(var i=0,fHandler;(fHandler=aHandler[i]);i++){if(fHandler===fHandlerToDetach){aHandler=aHandler.splice(i,1);break;}}}
return this;},detachAll:function(sEvent){var aHandler=this._htEventHandler;if(arguments.length){if(typeof aHandler[sEvent]=='undefined'){return this;}
delete aHandler[sEvent];return this;}
for(var o in aHandler){delete aHandler[o];}
return this;}});jindo.Component.factory=function(aObject,htOption){var aReturn=[],oInstance;if(typeof htOption=="undefined"){htOption={};}
for(var i=0,el;(el=aObject[i]);i++){oInstance=new this(el,htOption);aReturn[aReturn.length]=oInstance;}
return aReturn;};jindo.Component.getInstance=function(){if(typeof this._aInstance=="undefined"){this._aInstance=[];}
return this._aInstance;};jindo.UIComponent=jindo.$Class({$init:function(){this._bIsActivating=false;},isActivating:function(){return this._bIsActivating;},activate:function(){if(this.isActivating()){return this;}
this._bIsActivating=true;if(arguments.length>0){this._onActivate.apply(this,arguments);}else{this._onActivate();}
return this;},deactivate:function(){if(!this.isActivating()){return this;}
this._bIsActivating=false;if(arguments.length>0){this._onDeactivate.apply(this,arguments);}else{this._onDeactivate();}
return this;}}).extend(jindo.Component);jindo.HTMLComponent=jindo.$Class({sTagName:"",$init:function(){},paint:function(){this._onPaint();return this;}}).extend(jindo.UIComponent);jindo.HTMLComponent.paint=function(){var aInstance=this.getInstance();for(var i=0,oInstance;(oInstance=aInstance[i]);i++){oInstance.paint();}};jindo.Dialog=jindo.$Class({$init:function(htOption){var htDefaultOption={sClassPrefix:'dialog-',LayerPosition:{sPosition:"inside-center",bAuto:true}};this.option(htDefaultOption);this.option(htOption||{});this._bIsEventAttached=false;this._bIsShown=false;this._assignHTMLElements();this._initLayerPosition();},_assignHTMLElements:function(){this._elLayer=jindo.$('<div class="'+this.option("sClassPrefix")+'layer"></div>');this._welLayer=jindo.$Element(this._elLayer);this._wfClick=jindo.$Fn(this._onClick,this);jindo.$Element.prototype.preventTapHighlight&&this._welLayer.preventTapHighlight(true);},_initLayerPosition:function(){this._oLayerPosition=new jindo.LayerPosition(document.body,this._elLayer,this.option("LayerPosition"));},getLayer:function(){return this._elLayer;},getLayerPosition:function(){return this._oLayerPosition;},setLayerTemplate:function(sTemplate){this._sTemplate=sTemplate;this._template=jindo.$Template(this._sTemplate);},getLayerTemplate:function(){return this._sTemplate;},show:function(htTemplateProcess,htEventHandler){if(!this.isShown()){this.attach(htEventHandler);document.body.appendChild(this._elLayer);this._welLayer.html(this._template.process(htTemplateProcess));var htCustomEvent={"elLayer":this._elLayer};if(this.fireEvent("beforeShow",htCustomEvent)){this._welLayer.show();this._attachEvents();this.getLayerPosition().setPosition();this._bIsShown=true;this.fireEvent("show",htCustomEvent);}}},hide:function(){if(this.isShown()){var htCustomEvent={"elLayer":this._elLayer};if(this.fireEvent("beforeHide",htCustomEvent)){this.detachAll("close").detachAll("confirm").detachAll("cancel");this._detachEvents();this._welLayer.hide();this._welLayer.leave();this._bIsShown=false;this.fireEvent("hide",htCustomEvent);}}},isShown:function(){return this._bIsShown;},_isEventAttached:function(){return this._bIsEventAttached;},_attachEvents:function(){if(!this._isEventAttached()){this._wfClick.attach(this._elLayer,"click");this._bIsEventAttached=true;}
return this;},_detachEvents:function(){if(this._isEventAttached()){this._wfClick.detach(this._elLayer,"click");this._bIsEventAttached=false;}
return this;},_onClick:function(we){var sClassPrefix=this.option("sClassPrefix");var elClosestClose,elClosestConfirm,elClosestCancel;if((elClosestClose=this._getClosest(("."+sClassPrefix+"close"),we.element))){if(this.fireEvent("close")){this.hide();}}else if((elClosestConfirm=this._getClosest(("."+sClassPrefix+"confirm"),we.element))){if(this.fireEvent("confirm")){this.hide();}}else if((elClosestCancel=this._getClosest(("."+sClassPrefix+"cancel"),we.element))){if(this.fireEvent("cancel")){this.hide();}}},_getClosest:function(sSelector,elBaseElement){if(jindo.$$.test(elBaseElement,sSelector)){return elBaseElement;}
return jindo.$$.getSingle("! "+sSelector,elBaseElement);}}).extend(jindo.Component);jindo.Rolling=jindo.$Class({_oTransition:null,$init:function(el,htOption){this._el=jindo.$(el);this._elList=jindo.$$.test(this._el,'ul, ol')?this._el:jindo.$$.getSingle('> ul, > ol',el);this.option({nFPS:50,nDuration:800,sDirection:"horizontal",fEffect:jindo.Effect.linear});this.option(htOption||{});this._oKeys=this.option('sDirection')=='horizontal'?{offsetWidth:'offsetWidth',marginLeft:'marginLeft',marginRight:'marginRight',clientWidth:'clientWidth',scrollLeft:'scrollLeft'}:{offsetWidth:'offsetHeight',marginLeft:'marginTop',marginRight:'marginBottom',clientWidth:'clientHeight',scrollLeft:'scrollTop'};this._initTransition();},_initTransition:function(){var self=this;this._oTransition=new jindo.Transition().fps(this.option("nFPS")).attach({end:function(oCustomEvent){self.fireEvent("afterMove",{nIndex:self.getIndex()});}});},getTransition:function(){return this._oTransition;},getList:function(){return this._elList;},getItems:function(){return jindo.$$('> li',this._elList);},_offsetSize:function(el){var eEl=jindo.$Element(el),oKeys=this._oKeys,nMarginLeft=parseInt(eEl.css(oKeys.marginLeft),10)||0,nMarginRight=parseInt(eEl.css(oKeys.marginRight),10)||0;return el[oKeys.offsetWidth]+nMarginLeft+nMarginRight;},getIndex:function(){if(this.isMoving()){return this._nMoveTo;}
var el=this._el,oKeys=this._oKeys,nScroll=el[oKeys.scrollLeft],aItems=this.getItems(),nSize=0,n=0,nMinDistance=99999999;for(var i=0;i<aItems.length;i++){var nDistance=Math.abs(nScroll-nSize);if(nDistance<nMinDistance){nMinDistance=nDistance;n=i;}
nSize+=this._offsetSize(aItems[i]);}
return n;},_getPosition:function(n){var el=this._el,oKeys=this._oKeys,aItems=this.getItems(),nPos=0,nSize=this._getSize();for(var i=0;i<n;i++){nPos+=this._offsetSize(aItems[i]);}
if(nPos+el[oKeys.clientWidth]>nSize){nPos=nSize-el[oKeys.clientWidth];}
return nPos;},_getSize:function(){var aItems=this.getItems(),nSize=0;for(var i=0;i<aItems.length;i++){nSize+=this._offsetSize(aItems[i]);}
return(this._nSize=nSize);},_move:function(n){var el=this._el,oKeys=this._oKeys,aItems=this.getItems(),nPos=this._getPosition(n),nSize=this._getSize();var htParam={element:el,nIndex:n,nScroll:nPos};if(this.fireEvent('beforeMove',htParam)&&el[oKeys.scrollLeft]!=htParam.nScroll){var htDest={};htDest[oKeys.scrollLeft]=this.option('fEffect')(htParam.nScroll);this._nMoveTo=n;this.getTransition().abort().start(this.option('nDuration'),htParam.element,htDest);return true;}
return false;},moveTo:function(n){n=Math.min(n,this.getItems().length-1);n=Math.max(n,0);return this._move(n);},moveLastTo:function(n){return this.moveTo(this.getItems().length-1-n);},moveBy:function(n){return this.moveTo(this.getIndex()+n);},isMoving:function(){return this._oTransition.isPlaying();},isOverflowed:function(){return this._getSize()>this._el[this._oKeys.clientWidth];},getDisplayedItemCount:function(){var nDisplayed=0,aItems=this.getItems(),nPos=0;for(var i=0;i<aItems.length;i++){nPos+=this._offsetSize(aItems[i]);if(nPos<=this._el[this._oKeys.clientWidth]){nDisplayed++;}else{break;}}
return nDisplayed;}}).extend(jindo.Component);jindo.Formatter=jindo.$Class({_aMarks:['\u0000','\uFFFF'],_sPrevValue:null,_oTextRange:null,_bFakeFocus:false,$init:function(el,htOption){this._el=jindo.$(el);this.option({bPaintOnload:true,bActivateOnload:true,WatchInput:{nInterval:100,bPermanent:true,bActivateOnload:false}});this.option(htOption||{});this.isOpera=jindo.$Agent().navigator.opera;var self=this;this._wfRealBlur=jindo.$Fn(this._realBlur,this);this._wfRealFocus=jindo.$Fn(this._realFocus,this);this._oTextRange=new jindo.TextRange(el);this._oWatchInput=new jindo.WatchInput(el,this.option("WatchInput")).attach({change:function(oCustomEvent){setTimeout(function(){self.paint();},1);}});if(this.option("bPaintOnload")){setTimeout(function(){self.paint();},1);}
if(this.option("bActivateOnload")){this.activate();}},getWatchInput:function(){return this._oWatchInput;},_splice:function(sStr,nIndex,nHowMany,sInsert){return sStr.slice(0,nIndex)+sInsert+sStr.slice(nIndex+nHowMany);},setValue:function(s){this._el.value=s;this.paint();return this;},paint:function(){var el=this._el,oTextRange=this._oTextRange,aMark=this._aMarks,sText=el.value.toString(),bFocus=oTextRange.hasFocus(),aSel,htParam;if(bFocus){aSel=[-1,-1];try{aSel=oTextRange.getSelection();}catch(e){}
sText=this._splice(this._splice(sText,aSel[1],0,aMark[1]),aSel[0],0,aMark[0]);}
htParam={elInput:el,sText:sText,sStartMark:aMark[0],sEndMark:aMark[1]};if(this.fireEvent('beforeChange',htParam)){var sOutput=htParam.sText;if(bFocus){var nPos=sOutput.indexOf(aMark[0]);if(nPos>-1){sOutput=this._splice(sOutput,nPos,1,'');}
aSel=[nPos];aSel[1]=sOutput.indexOf(aMark[1]);if(aSel[1]>-1){sOutput=this._splice(sOutput,aSel[1],1,'');}
var self=this;setTimeout(function(){self._bFakeFocus=true;(!this.isOpera)||el.blur();},1);setTimeout(function(){self._oWatchInput.setInputValue(sOutput);el.focus();try{oTextRange.setSelection(aSel[0],aSel[1]);}catch(e){}
self.fireEvent('change',{elInput:el});},2);setTimeout(function(){self._bFakeFocus=false;},20);}else{this._oWatchInput.setInputValue(sOutput);this.fireEvent('change',{elInput:el});}}
return this;},_realBlur:function(){if(!this._bFakeFocus){this.getWatchInput().stop();this.fireEvent("blur",{elInput:this._el});}},_realFocus:function(){if(!this._bFakeFocus){this.getWatchInput().start(true);this.fireEvent("focus",{elInput:this._el});}},_onActivate:function(){this._wfRealBlur.attach(this._el,"blur");this._wfRealFocus.attach(this._el,"focus");},_onDeactivate:function(){this._wfRealBlur.detach(this._el,"blur");this._wfRealFocus.detach(this._el,"focus");}}).extend(jindo.UIComponent);jindo.ScrollBar=new jindo.$Class({_bMouseEnter:false,_bIsEventAttachedForCommon:false,_bIsEventAttachedForVertical:false,_bIsEventAttachedForHorizontal:false,$init:function(el,oOption){this.option({sClassPrefix:"scrollbar-",nDelta:16,sClassNameForRollover:"rollover",bActivateOnload:true});this.option(oOption||{});this._el=jindo.$(el);this._oTimer=new jindo.Timer();this._oTransition=new jindo.Transition().fps(30);this._wfOnMouseEnter=jindo.$Fn(this._onMouseEnter,this);this._wfOnMouseLeave=jindo.$Fn(this._onMouseLeave,this);this._wfOnWheel=jindo.$Fn(this._onWheel,this);this._wfOnMouseUp=jindo.$Fn(this._onMouseUp,this);this._assignHTMLElements();this._initialize4Tablet();if(this.option("bActivateOnload")){this.activate();}},_assignHTMLElements:function(){var el=this._el,sClassPrefix=this.option("sClassPrefix");this._elBox=jindo.$$.getSingle("."+sClassPrefix+"box",el);this._elContent=jindo.$$.getSingle("."+sClassPrefix+"content",el);var welBox=jindo.$Element(this._elBox),welContent=jindo.$Element(this._elContent);this._oBoxSize={nWidth:welBox.width(),nHeight:welBox.height()};this._oContentSize={nWidth:welContent.width(),nHeight:welContent.height()};this._oHorizontal={elScrollBar:jindo.$$.getSingle("."+sClassPrefix+"h",el)};var oH=this._oHorizontal;if(oH.elScrollBar){oH.elTrack=jindo.$$.getSingle("."+sClassPrefix+"track",oH.elScrollBar);oH.elThumb=jindo.$$.getSingle("."+sClassPrefix+"thumb",oH.elTrack);oH.elThumbHead=jindo.$$.getSingle("."+sClassPrefix+"thumb-head",oH.elThumb);oH.elThumbBody=jindo.$$.getSingle("."+sClassPrefix+"thumb-body",oH.elThumb);oH.elThumbFoot=jindo.$$.getSingle("."+sClassPrefix+"thumb-foot",oH.elThumb);oH.elButtonLeft=jindo.$$.getSingle("."+sClassPrefix+"button-left",oH.elScrollBar);oH.elButtonRight=jindo.$$.getSingle("."+sClassPrefix+"button-right",oH.elScrollBar);}
this._oVertical={elScrollBar:jindo.$$.getSingle("."+sClassPrefix+"v",el)};var oV=this._oVertical;if(oV.elScrollBar){oV.elTrack=jindo.$$.getSingle("."+sClassPrefix+"track",oV.elScrollBar);oV.elThumb=jindo.$$.getSingle("."+sClassPrefix+"thumb",oV.elTrack);oV.elThumbHead=jindo.$$.getSingle("."+sClassPrefix+"thumb-head",oV.elThumb);oV.elThumbBody=jindo.$$.getSingle("."+sClassPrefix+"thumb-body",oV.elThumb);oV.elThumbFoot=jindo.$$.getSingle("."+sClassPrefix+"thumb-foot",oV.elThumb);oV.elButtonUp=jindo.$$.getSingle("."+sClassPrefix+"button-up",oV.elScrollBar);oV.elButtonDown=jindo.$$.getSingle("."+sClassPrefix+"button-down",oV.elScrollBar);}},getBox:function(){return this._elBox;},getContent:function(){return this._elContent;},getDefaultBoxSize:function(){return this._oBoxSize;},getDefaultContentSize:function(){return this._oContentSize;},getScrollBarHorizontal:function(){return this._oHorizontal;},getScrollBarVertical:function(){return this._oVertical;},getSliderHorizontal:function(){return this._oSliderHorizontal||null;},getSliderVertical:function(){return this._oSliderVertical||null;},getRolloverArea:function(){return this._oRolloverArea;},_attachEvent:function(sDirection){var sClassPrefix=this.option("sClassPrefix"),self=this,oH=this.getScrollBarHorizontal(),oV=this.getScrollBarVertical();function attach(o){if(o.elScrollBar){var sClassNameForRollover=self.option("sClassNameForRollover");jindo.$Element(o.elTrack).addClass(sClassNameForRollover);jindo.$Element(o.elThumb).addClass(sClassNameForRollover);if(o.elButtonLeft){jindo.$Element(o.elButtonLeft).addClass(sClassNameForRollover);}
if(o.elButtonRight){jindo.$Element(o.elButtonRight).addClass(sClassNameForRollover);}
if(o.elButtonUp){jindo.$Element(o.elButtonUp).addClass(sClassNameForRollover);}
if(o.elButtonDown){jindo.$Element(o.elButtonDown).addClass(sClassNameForRollover);}}}
function attachH(){if(!self._bIsEventAttachedForHorizontal){attach(oH);}
self._bIsEventAttachedForHorizontal=true;}
function attachV(){if(!self._bIsEventAttachedForVertical){attach(oV);}
self._bIsEventAttachedForVertical=true;}
if(!this._bIsEventAttachedForCommon){this._initSliders();this._initRolloverArea();this._wfOnMouseEnter.attach(this._el,"mouseenter");this._wfOnMouseLeave.attach(this._el,"mouseleave");this._wfOnWheel.attach(document,"mousewheel");this._wfOnMouseUp.attach(document,"mouseup");this._bIsEventAttachedForCommon=true;jindo.$Element(this._el).removeClass(sClassPrefix+"noscript");}
if(!sDirection){attachH();attachV();}
if(sDirection=="horizontal"){attachH();}
if(sDirection=="vertical"){attachV();}},_detachEvent:function(sDirection){var sClassPrefix=this.option("sClassPrefix"),self=this,oH=this.getScrollBarHorizontal(),oV=this.getScrollBarVertical();function detach(o){if(o.elScrollBar){var sClassNameForRollover=self.option("sClassNameForRollover");jindo.$Element(o.elTrack).removeClass(sClassNameForRollover);jindo.$Element(o.elThumb).removeClass(sClassNameForRollover);if(o.elButtonLeft){jindo.$Element(o.elButtonLeft).removeClass(sClassNameForRollover);}
if(o.elButtonRight){jindo.$Element(o.elButtonRight).removeClass(sClassNameForRollover);}
if(o.elButtonUp){jindo.$Element(o.elButtonUp).removeClass(sClassNameForRollover);}
if(o.elButtonDown){jindo.$Element(o.elButtonDown).removeClass(sClassNameForRollover);}}}
function detachH(){if(self._bIsEventAttachedForHorizontal){detach(oH);}
self._bIsEventAttachedForHorizontal=false;}
function detachV(){if(self._bIsEventAttachedForVertical){detach(oV);}
self._bIsEventAttachedForVertical=false;}
if(!sDirection){detachH();detachV();}
else if(sDirection=="horizontal"){detachH();}
else if(sDirection=="vertical"){detachV();}
if(this._bIsEventAttachedForCommon&&!this._bIsEventAttachedForHorizontal&&!this._bIsEventAttachedForVertical){this._wfOnMouseEnter.detach(this._el,"mouseenter");this._wfOnMouseLeave.detach(this._el,"mouseleave");this._wfOnWheel.detach(document,"mousewheel");this._wfOnMouseUp.detach(document,"mouseup");this._bMouseEnter=false;this._bIsEventAttachedForCommon=false;this.getRolloverArea().deactivate();jindo.$Element(this._el).addClass(sClassPrefix+"noscript");}},_activateH:function(){var oSliderH=this.getSliderHorizontal();if(oSliderH){oSliderH.activate();this.getBox().scrollLeft=0;this.setScrollLeft(0);}},_activateV:function(){var oSliderV=this.getSliderVertical();if(oSliderV){oSliderV.activate();this.getBox().scrollTop=0;this.setScrollTop(0);}},_onActivate:function(sDirection){this._attachEvent(sDirection||null);this._activate4Tablet();if(!sDirection){this._activateH();this._activateV();jindo.$Element(this._el).removeClass(this.option("sClassPrefix")+"noscript");return;}
if(sDirection=="horizontal"){this._activateH();return;}
if(sDirection=="vertical"){this._activateV();return;}},_deactivateH:function(){var oSliderH=this.getSliderHorizontal();if(oSliderH){oSliderH.deactivate();this.getContent().style.left="0px";this.getBox().scrollLeft=0;}},_deactivateV:function(){var oSliderV=this.getSliderVertical();if(oSliderV){oSliderV.deactivate();this.getContent().style.top="0px";this.getBox().scrollTop=0;}},_onDeactivate:function(sDirection){this._detachEvent(sDirection||null);this._deactivate4Tablet();if(!sDirection){this._deactivateH();this._deactivateV();jindo.$Element(this._el).addClass(this.option("sClassPrefix")+"noscript");return;}
if(sDirection=="horizontal"){this._deactivateH();return;}
if(sDirection=="vertical"){this._deactivateV();return;}},_initSliders:function(){var self=this,sClassPrefix=this.option("sClassPrefix"),oH=this.getScrollBarHorizontal(),oV=this.getScrollBarVertical();if(oH.elScrollBar){this._nScrollWidth=jindo.$Element(this._elContent).width()-jindo.$Element(this._elBox).width();this._oSliderHorizontal=new jindo.Slider(oH.elTrack,{sClassPrefix:sClassPrefix,bVertical:false,nMinValue:0,nMaxValue:this._nScrollWidth});this._oSliderHorizontal._oTransition=new jindo.Transition().fps(30);this._oSliderHorizontal.attach({beforeChange:function(oCustomEvent){var nTrackWidth=jindo.$Element(this.getTrack()).width(),nThumbWidth=jindo.$Element(this.getThumb(oCustomEvent.nIndex)).width(),nAvailWidth=nTrackWidth-nThumbWidth;oCustomEvent.nPos=Math.min(oCustomEvent.nPos,nAvailWidth);oCustomEvent.nPos=Math.max(oCustomEvent.nPos,0);if(oCustomEvent.bJump){oCustomEvent.stop();this._oTransition.abort().start(200,this.getThumb(oCustomEvent.nIndex),{"@left":jindo.Effect.easeOut(oCustomEvent.nPos+'px')}).attach({playing:function(oCustomEvent2){self.setScrollLeft(self._oSliderHorizontal._getValue(0,parseInt(oCustomEvent2.sValue,10)));}});}else{self.setScrollLeft(this._getValue(0,oCustomEvent.nPos));}}});}
if(oV.elScrollBar){this._nScrollHeight=jindo.$Element(this._elContent).height()-jindo.$Element(this._elBox).height();this._oSliderVertical=new jindo.Slider(oV.elTrack,{sClassPrefix:sClassPrefix,bVertical:true,nMinValue:0,nMaxValue:this._nScrollHeight});this._oSliderVertical._oTransition=new jindo.Transition().fps(30);this._oSliderVertical.attach({beforeChange:function(oCustomEvent){var nTrackHeight=jindo.$Element(this.getTrack()).height(),nThumbHeight=jindo.$Element(this.getThumb(oCustomEvent.nIndex)).height(),nAvailHeight=nTrackHeight-nThumbHeight;oCustomEvent.nPos=Math.min(oCustomEvent.nPos,nAvailHeight);oCustomEvent.nPos=Math.max(oCustomEvent.nPos,0);if(oCustomEvent.bJump){oCustomEvent.stop();this._oTransition.abort().start(200,this.getThumb(oCustomEvent.nIndex),{"@top":jindo.Effect.easeOut(oCustomEvent.nPos+'px')}).attach({playing:function(oCustomEvent2){self.setScrollTop(self._oSliderVertical.values(0));}});}else{self.setScrollTop(this._getValue(0,oCustomEvent.nPos));}}});}},_initRolloverArea:function(){var self=this,sClassPrefix=this.option("sClassPrefix"),sClassNameForRollover=this.option("sClassNameForRollover");this._oRolloverArea=new jindo.RolloverArea(this._el,{sClassName:sClassNameForRollover,sClassPrefix:sClassPrefix}).attach({over:function(oCustomEvent){oCustomEvent.stop();self._onRollover("over",oCustomEvent.element);},down:function(oCustomEvent){oCustomEvent.stop();self._onMouseDown(oCustomEvent.element);self._onRollover("down",oCustomEvent.element);},up:function(oCustomEvent){oCustomEvent.stop();self._onMouseUp(oCustomEvent.element);self._onRollover("up",oCustomEvent.element);},out:function(oCustomEvent){oCustomEvent.stop();self._onRollover("out",oCustomEvent.element);}});},reset:function(){var oSliderH=this.getSliderHorizontal(),oSliderV=this.getSliderVertical();if(oSliderH){this._nScrollWidth=jindo.$Element(this._elContent).width()-jindo.$Element(this._elBox).width();oSliderH.option("nMaxValue",this._nScrollWidth);this.setScrollLeft(0);}
if(oSliderV){this._nScrollHeight=jindo.$Element(this._elContent).height()-jindo.$Element(this._elBox).height();oSliderV.option("nMaxValue",this._nScrollHeight);this.setScrollTop(0);}
this._elBox.scrollLeft=0;this._elBox.scrollTop=0;},hasScrollBarHorizontal:function(){var sClassPrefix=this.option("sClassPrefix"),o=this.getScrollBarHorizontal();if(o.elScrollBar){var welScrollBar=jindo.$Element(o.elScrollBar);return welScrollBar.visible()||welScrollBar.hasClass(sClassPrefix+"show");}
return false;},hasScrollBarVertical:function(){var sClassPrefix=this.option("sClassPrefix"),o=this.getScrollBarVertical();if(o.elScrollBar){var welScrollBar=jindo.$Element(o.elScrollBar);return welScrollBar.visible()||welScrollBar.hasClass(sClassPrefix+"show");}
return false;},setScrollTop:function(n){n=Math.min(n,this._nScrollHeight);n=Math.max(n,0);n=Math.round(n);var htParam={sDirection:"top",nPosition:n};jindo.$Element(this._elContent).css("top",(htParam.nPosition*-1)+"px");var oSliderV=this.getSliderVertical();if(oSliderV){oSliderV.values(0,htParam.nPosition,false);}
this._fireScrollEvent(htParam);},setScrollLeft:function(n){n=Math.min(n,this._nScrollWidth);n=Math.max(n,0);n=Math.round(n);var htParam={sDirection:"left",nPosition:n};jindo.$Element(this._elContent).css("left",(htParam.nPosition*-1)+"px");var oSliderH=this.getSliderHorizontal();if(oSliderH){oSliderH.values(0,htParam.nPosition,false);}
this._fireScrollEvent(htParam);},setScrollTopBy:function(n){this.setScrollTop(this.getScrollTop()+n);},setScrollLeftBy:function(n){this.setScrollLeft(this.getScrollLeft()+n);},getScrollTop:function(n){return parseInt(jindo.$Element(this._elContent).css("top"),10)*-1;},getScrollLeft:function(n){return parseInt(jindo.$Element(this._elContent).css("left"),10)*-1;},_getElementType:function(wel){var sClassPrefix=this.option("sClassPrefix");if(wel.hasClass(sClassPrefix+"track")){return"track";}
else if(wel.hasClass(sClassPrefix+"thumb")){return"thumb";}
else if(wel.hasClass(sClassPrefix+"button-up")){return"button-up";}
else if(wel.hasClass(sClassPrefix+"button-up")){return"button-up";}
else if(wel.hasClass(sClassPrefix+"button-down")){return"button-down";}
else if(wel.hasClass(sClassPrefix+"button-left")){return"button-left";}
else if(wel.hasClass(sClassPrefix+"button-right")){return"button-right";}
else{return false;}},_fireScrollEvent:function(htParam){this.fireEvent("scroll",htParam);},_onWheel:function(we){if(!this._bMouseEnter){return;}
we.stop(jindo.$Event.CANCEL_DEFAULT);var nDelta=we.mouse().delta,nDirection=nDelta/Math.abs(nDelta)*-1,n=Math.ceil(Math.abs(nDelta))*nDirection*this.option("nDelta"),bH=this.hasScrollBarHorizontal(),bV=this.hasScrollBarVertical();if(!bH&&!bV){return;}
if(this.hasScrollBarVertical()&&this._bIsEventAttachedForVertical){this.setScrollTop(this.getScrollTop()+n);return;}
this.setScrollLeft(this.getScrollLeft()+n);},_onMouseDown:function(el){var wel=jindo.$Element(el),self=this,setScrollBy,sElementType=this._getElementType(wel);switch(sElementType){case"button-up":setScrollBy=function(n){self.setScrollTopBy(~~(n*-1));};break;case"button-down":setScrollBy=function(n){self.setScrollTopBy(n);};break;case"button-left":setScrollBy=function(n){self.setScrollLeftBy(~~(n*-1));};break;case"button-right":setScrollBy=function(n){self.setScrollLeftBy(n);};break;default:return;}
this._oTimer.start(function(){setScrollBy(16);return true;},100);},_onMouseUp:function(el){this._oTimer.abort();},_onMouseEnter:function(we){this._bMouseEnter=true;},_onMouseLeave:function(we){this._bMouseEnter=false;},_onRollover:function(sType,el){var wel=jindo.$Element(el),sClassPrefix=this.option("sClassPrefix"),sElementType=this._getElementType(wel);switch(sType){case"over":wel.addClass(sClassPrefix+sElementType+"-over");break;case"down":wel.addClass(sClassPrefix+sElementType+"-hold");break;case"up":wel.removeClass(sClassPrefix+sElementType+"-hold");break;case"out":wel.removeClass(sClassPrefix+sElementType+"-over");break;}},_initialize4Tablet:function(){this._fpOnTouchDragStart=jindo.$Fn(function(oEvent){this._oPos4Tablet=oEvent.pos();},this);this._fpOnTouchDragMove=jindo.$Fn(function(oEvent){if(!this._oPos4Tablet){return;}
var oOldPos=this._oPos4Tablet;var oNewPos=oEvent.pos();this.setScrollLeftBy(oOldPos.pageX-oNewPos.pageX);this.setScrollTopBy(oOldPos.pageY-oNewPos.pageY);this._oPos4Tablet=oNewPos;oEvent.stopDefault();},this);this._fpOnTouchDragEnd=jindo.$Fn(function(oEvent){this._oPos4Tablet=null;},this);},_activate4Tablet:function(){var elEl=this._elContent;jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(true);this._fpOnTouchDragStart.attach(elEl,'touchstart');this._fpOnTouchDragMove.attach(elEl,'touchmove');this._fpOnTouchDragEnd.attach(elEl,'touchend');},_deactivate4Tablet:function(){var elEl=this._elContent;jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(false);this._fpOnTouchDragStart.detach(elEl,'touchstart');this._fpOnTouchDragMove.detach(elEl,'touchmove');this._fpOnTouchDragEnd.detach(elEl,'touchend');}}).extend(jindo.UIComponent);jindo.Tree=jindo.$Class({_bIsActivating:false,_sTemplate:null,_htNodeData:null,_el:null,_elSelectedNode:null,$init:function(el,htOption){this.option({sClassPrefix:'tree-',sEventSelect:"click",sEventExpand:"dblclick",bExpandOnSelect:true,bActivateOnload:true});this.option(htOption||{});var sPrefix=this.option('sClassPrefix');this.htClassName={sNode:sPrefix+"node",sLastNode:sPrefix+"last-node",sHasChild:sPrefix+"has-child",sButton:sPrefix+"button",sLabel:sPrefix+"label",sSelected:sPrefix+"selected",sCollapsed:sPrefix+"collapsed"};this.setNodeTemplate('<li class="{=sNodeClass}{if bLastNode} {=sLastNodeClass}{/if}"><div{if bHasChild} class="{=sHasChildClass}"{/if}><button class="{=sButtonClass}">+</button><span class="{=sLabelClass}" unselectable="on">{=sText}</span></div></li>');this._htNodeData={};el=jindo.$(el);this._setRootList(el);this._wfSelectHandler=jindo.$Fn(this._onSelectEvent,this);this._wfExpandHandler=jindo.$Fn(this._onExpandEvent,this);this._makeNodeDataKeyFromHTML();this.paintAllNodes();var elDefaultSelectedNode=jindo.$$.getSingle('.'+this.htClassName.sNode+' > .'+this.htClassName.sSelected,this.getRootList());if(elDefaultSelectedNode){this._setSelectedNode(this.getNode(elDefaultSelectedNode));}
if(this.option("bActivateOnload")){this.activate();}},_onActivate:function(){var el=this.getRootList();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(el).preventTapHighlight(true);this._wfSelectHandler.attach(el,this.option("sEventSelect"));this._wfExpandHandler.attach(el,this.option("sEventExpand"));},_onDeactivate:function(){var el=this.getRootList();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(el).preventTapHighlight(false);this._wfSelectHandler.detach(el,this.option("sEventSelect"));this._wfExpandHandler.detach(el,this.option("sEventExpand"));},_onSelectEvent:function(we){var el=we.element;var elNode=this.getNode(el);if(!elNode){return;}
var elButton=jindo.$$.test(el,'.'+this.htClassName.sButton)?el:jindo.$$.getSingle('! .'+this.htClassName.sButton,el);if(elButton){if(this.isCollapsed(elNode)){this.expandNode(elNode);}else{this.collapseNode(elNode);}
return;}
var elLabel=jindo.$$.test(el,'.'+this.htClassName.sLabel)?el:jindo.$$.getSingle('! .'+this.htClassName.sLabel,el);if(elLabel){var htPart=this.getPartsOfNode(elNode);if(htPart.elItem){if(this.fireEvent(we.type,{element:elNode,weEvent:we})){this.selectNode(elNode);}}}},_onExpandEvent:function(we){var el=we.element;var elNode=this.getNode(el);if(!elNode||!this.hasChild(elNode)){return;}
var elLabel=jindo.$$.test(el,'.'+this.htClassName.sLabel)?el:jindo.$$.getSingle('! .'+this.htClassName.sLabel,el);if(elLabel){var htParam={element:elNode,weEvent:we};var htPart=this.getPartsOfNode(elNode);if(htPart.elItem&&jindo.$Element(htPart.elItem).visible()){if(this.isCollapsed(elNode)){if(this.fireEvent(we.type,htParam)){this.expandNode(elNode);}}else{if(!this._bExpandOnSelect){if(this.fireEvent(we.type,htParam)){this.collapseNode(elNode);}}}}}},paintNode:function(elNode,bPaintChild){if(typeof bPaintChild=="undefined"){bPaintChild=true;}
this._paintNode(elNode);if(bPaintChild){var aNodes=this.getChildNodes(elNode);for(var i=0;i<aNodes.length;i++){this.paintNode(aNodes[i]);}}
return this;},paintAllNodes:function(elNode){this.paintNode(elNode||this.getRootNode());return this;},_paintNode:function(elNode){if(!elNode){return;}
var htPart=this.getPartsOfNode(elNode);var aChildNodes=this.getChildNodes(elNode);var htNodeData=this.getNodeData(elNode);var welNode=jindo.$Element(elNode);var welItem=jindo.$Element(htPart.elItem);delete htNodeData["_aChildren"];if(this.hasChild(elNode)){welItem.addClass(this.htClassName.sHasChild);htNodeData["bHasChild"]=true;htNodeData["_aChildren"]=[];var self=this;jindo.$A(aChildNodes).forEach(function(elNode,i){htNodeData["_aChildren"].push(self.getNodeData(elNode));});}else{htNodeData["bHasChild"]=false;welItem.removeClass(this.htClassName.sHasChild);if(htPart.elChild){htPart.elChild.parentNode.removeChild(htPart.elChild);}}
htNodeData["bLastNode"]=jindo.$$.getSingle('~ .'+this.htClassName.sNode,elNode)?false:true;if(htNodeData["bLastNode"]){welNode.addClass(this.htClassName.sLastNode);}else{welNode.removeClass(this.htClassName.sLastNode);}
elNode.parentNode.style.zoom=1;},getNodeTemplate:function(){return this._sTemplate;},setNodeTemplate:function(s){this._sTemplate=s;return this;},getChildListOfNode:function(elNode){return jindo.$$.getSingle("ul",elNode);},getRootList:function(){return this._el;},_setRootList:function(el){this._el=el;},getNode:function(el){var elNode=jindo.$$.test(el,'.'+this.htClassName.sNode)?el:jindo.$$.getSingle('! .'+this.htClassName.sNode,el);return elNode&&jindo.$Element(elNode).isChildOf(this.getRootList())?elNode:null;},getPartsOfNode:function(elNode){var aParts=jindo.$$('> *',elNode);return{elItem:aParts[0],elChild:aParts[1]};},getNodeType:function(elNode){if(elNode===this.getRootNode()){return"root";}else if(this.getChildNodes(elNode).length>0){return"internal";}else{return"leaf";}},getRootNode:function(){if(this._elRootNode){return this._elRootNode;}
this._elRootNode=jindo.$$.getSingle('.'+this.htClassName.sNode,this.getRootList());return this._elRootNode;},getAllNodes:function(){return jindo.$$('.'+this.htClassName.sNode,this.getRootList());},getChildNodes:function(elNode){var elChildList=this.getChildListOfNode(elNode);return elChildList?jindo.$$('> .'+this.htClassName.sNode,elChildList):[];},hasChild:function(elNode){var htPart=this.getPartsOfNode(elNode);return htPart.elChild&&htPart.elChild.getElementsByTagName('li')[0]?true:false;},getParentNode:function(elNode){var elRootNode=this.getRootNode();if(elNode===elRootNode){return null;}
return this.getNode(elNode.parentNode);},getPreviousNode:function(elNode){var elReturn=jindo.$$.getSingle('!~ .'+this.htClassName.sNode,elNode);return elReturn?this.getNode(elReturn):null;},getNextNode:function(elNode){var elReturn=jindo.$$.getSingle('~ .'+this.htClassName.sNode,elNode);return elReturn?this.getNode(elReturn):null;},getSelectedNode:function(){return this._elSelectedNode;},_setSelectedNode:function(el){this._elSelectedNode=el;},isCollapsed:function(elNode){return jindo.$Element(elNode).hasClass(this.htClassName.sCollapsed);},getNodeDepth:function(elNode){var nDepth=-1;for(;elNode;elNode=elNode.parentNode){if(elNode==this.getRootList()){break;}
if(jindo.$$.test(elNode,'.'+this.htClassName.sNode)){nDepth++;}}
return nDepth;},setNodeData:function(elNode,htNodeData){var sKey=this._getNodeDataKey(elNode);delete htNodeData["_aChildren"];delete htNodeData["sLabel"];for(var vProp in htNodeData){this._htNodeData[sKey][vProp]=htNodeData[vProp];}
return this;},getNodeLabelElement:function(elNode){return jindo.$$.getSingle("."+this.htClassName.sLabel,elNode);},getNodeLabel:function(elNode){return jindo.$Element(this.getNodeLabelElement(elNode)).html();},setNodeLabel:function(elNode,sLabel){var sKey=this._getNodeDataKey(elNode);this._htNodeData[sKey]["sLabel"]=sLabel;jindo.$Element(this.getNodeLabelElement(elNode)).html(sLabel);return this;},_makeNodeDataKeyFromHTML:function(){var aNodes=this.getAllNodes();for(var i=0;i<aNodes.length;i++){var elNode=aNodes[i];this._makeNodeDataKey(elNode);this._makeNodeData(elNode);}},_makeNodeDataKey:function(elNode){var welNode=jindo.$Element(elNode);var sNodeDataKey=this._getNodeDataKey(elNode);if(sNodeDataKey){return false;}
var sPrefix=this.option('sClassPrefix');var sUnique=('data-'+new Date().getTime()+parseInt(Math.random()*10000000,10)).toString();var sUniqueClass=sPrefix+sUnique;welNode.addClass(sUniqueClass);var sKey=this._getNodeDataKey(elNode);this._htNodeData[sKey]={};return sKey;},_makeNodeData:function(elNode){var htNodeData=this.getNodeData(elNode);htNodeData["element"]=elNode;htNodeData["sLabel"]=jindo.$Element(this.getNodeLabelElement(elNode)).text();htNodeData["bLastNode"]=jindo.$$.getSingle('~ .'+this.htClassName.sNode,elNode)?false:true;},_getNodeDataKey:function(elNode){var sClassName=elNode.className;var sPrefix=this.option('sClassPrefix');var rKey=new RegExp('('+sPrefix+'data-[0-9]+)');if(rKey.test(sClassName)){return RegExp.$1;}
return null;},getNodeData:function(elNode){return(elNode)?this._htNodeData[this._getNodeDataKey(elNode)]:this._htNodeData;},_clearNodeData:function(elNode){var elParentNode=this.getParentNode(elNode);var htNodeData=this.getNodeData(elNode);var sKey=this._getNodeDataKey(elNode);if(elParentNode){var htParentNodeData=this.getNodeData(elParentNode);if(htParentNodeData){var nIndex=jindo.$A(htParentNodeData["_aChildren"]).indexOf(htNodeData);htParentNodeData["_aChildren"].splice(nIndex,1);}}
var self=this;if(this.hasChild(elNode)){jindo.$A(this.getChildNodes(elNode)).forEach(function(elNode){self._clearNodeData(elNode);});}
delete this._htNodeData[sKey];},expandNode:function(elNode,bChildAll){if(!this.fireEvent('beforeExpand',{element:elNode})){return;}
var htPart=this.getPartsOfNode(elNode);var aChildren=[];if(jindo.$$.test(htPart.elItem,'.'+this.htClassName.sHasChild)){aChildren.push(elNode);}
if(bChildAll){aChildren=aChildren.concat(jindo.$$('.'+this.htClassName.sHasChild,elNode));}
for(var i=0,elChild;(elChild=aChildren[i]);i++){var elChildNode=this.getNode(elChild);jindo.$Element(elChildNode).removeClass(this.htClassName.sCollapsed);this.fireEvent('expand',{element:elChildNode});}
return this;},collapseNode:function(elNode,bChildAll){if(!this.fireEvent('beforeCollapse',{element:elNode})){return;}
var htPart=this.getPartsOfNode(elNode);var aChildren=[];if(jindo.$$.test(htPart.elItem,'.'+this.htClassName.sHasChild)){aChildren.push(elNode);}
if(bChildAll){aChildren=aChildren.concat(jindo.$$('.'+this.htClassName.sHasChild,elNode));}
for(var i=0,elChild;(elChild=aChildren[i]);i++){var elChildNode=this.getNode(elChild);jindo.$Element(elChildNode).addClass(this.htClassName.sCollapsed);this.fireEvent('collapse',{element:elChildNode});}
return this;},selectNode:function(elNode){var htPart=this.getPartsOfNode(elNode);var elSelectedNode=this.getSelectedNode();var elItem=htPart.elItem;if(!this.fireEvent('beforeSelect',{element:elNode})){return false;}
if(elSelectedNode!=elNode){this.deselectNode();jindo.$Element(elItem).addClass(this.htClassName.sSelected);this._setSelectedNode(elNode);}
this.fireEvent('select',{element:elNode});if(this.option("bExpandOnSelect")&&elSelectedNode!=elNode&&this.isCollapsed(elNode)){var self=this;this._bExpandOnSelect=true;setTimeout(function(){self._bExpandOnSelect=false;},500);this.expandNode(elNode);}
return true;},deselectNode:function(){var elSelectedNode=this.getSelectedNode();if(elSelectedNode){jindo.$Element(this.getPartsOfNode(elSelectedNode).elItem).removeClass(this.htClassName.sSelected);}
this._setSelectedNode(null);return this;},_createChild:function(elNode){var elChild=this.getChildListOfNode(elNode);if(!elChild){elChild=jindo.$('<ul>');elNode.appendChild(elChild);}
try{return elChild;}finally{elChild=null;}},removeNode:function(elNode){if(!elNode||elNode===this.getRootNode()){this.clearNode(elNode);return this;}
var htNodeData=this.getNodeData(elNode);var elPreviousNode=htNodeData.bLastNode?this.getPreviousNode(elNode):null;var bLastNode=elNode.parentNode.childNodes.length==1;var elParentNode=this.getParentNode(elNode);this._clearNodeData(elNode);elNode.parentNode.removeChild(elNode);this.selectNode(elParentNode);this._paintNode(elPreviousNode);if(bLastNode){var htParentNodeData=this.getNodeData(elParentNode);htParentNodeData.bHasChild=false;}
this._paintNode(elParentNode);return this;},clearNode:function(elNode){var elChild=this.getChildListOfNode(elNode);if(elChild){var aChildLi=elChild.getElementsByTagName('li');for(var i=0,elChildLi;(elChildLi=aChildLi[i]);i++){this._clearNodeData(elChildLi);}
elChild.parentNode.removeChild(elChild);var htNodeData=this.getNodeData(elNode);htNodeData.bHasChild=false;this._paintNode(elNode);return true;}
return false;},clearTree:function(){this.clearNode(this.getRootNode());return this;},_moveNodes:function(elTargetNode,aNodes,fCallback){for(var i=0,elNode;(elNode=aNodes[i]);i++){fCallback(elNode);}},appendNode:function(elTargetNode,aNodes){if(!(aNodes instanceof Array)){return arguments.callee.call(this,elTargetNode,[aNodes]);}
var self=this;var elChild=this._createChild(elTargetNode);this._moveNodes(elTargetNode,aNodes,function(elNode){var elParentNode=null;elParentNode=self.getParentNode(elNode);elChild.appendChild(elNode);if(elParentNode){self.paintNode(elParentNode,false);jindo.$A(self.getChildNodes(elParentNode)).forEach(function(elChildNode){self.paintNode(elChildNode,false);});}});this.paintNode(elTargetNode,false);jindo.$A(this.getChildNodes(elTargetNode)).forEach(function(elChildNode){self.paintNode(elChildNode,false);});return this;},insertNodeBefore:function(elTargetNode,aNodes){if(elTargetNode==this.getRootNode()){return;}
if(!(aNodes instanceof Array)){return arguments.callee.call(this,elTargetNode,[aNodes]);}
var self=this;var elChildList=elTargetNode.parentNode;this._moveNodes(elTargetNode,aNodes,function(elNode){var elParentNode=null;elParentNode=self.getNode(elChildList);elChildList.insertBefore(elNode,elTargetNode);if(elParentNode){jindo.$A(self.getChildNodes(elParentNode)).forEach(function(elChildNode){self.paintNode(elChildNode,false);});}});return this;},insertNodeAfter:function(elTargetNode,aNodes){if(elTargetNode==this.getRootNode()){return;}
if(!(aNodes instanceof Array)){return arguments.callee.call(this,elTargetNode,[aNodes]);}
var self=this;var elChildList=elTargetNode.parentNode;var elNextNode=elTargetNode;this._moveNodes(elTargetNode,aNodes,function(elNode){var elParentNode=null;elParentNode=self.getNode(elChildList);elChildList.insertBefore(elNode,elNextNode.nextSibling);elNextNode=elNode;if(elParentNode){jindo.$A(self.getChildNodes(elParentNode)).forEach(function(elChildNode){self.paintNode(elChildNode,false);});}});return this;},_getCode:function(aData){if(aData instanceof Array){var aCodes=[];var sTemplate=this.getNodeTemplate();for(var i=0;i<aData.length;i++){var htData=aData[i];var htParam={sTemplate:sTemplate,htData:htData};this.fireEvent('beforeProcessData',htParam);var htProcess={sNodeClass:this.htClassName.sNode,bLastNode:(i==aData.length-1)?true:false,sLastNodeClass:this.htClassName.sLastNode,bHasChild:(typeof htData._aChildren!="undefined"&&htData._aChildren.length>0)?true:false,sHasChildClass:this.htClassName.sHasChild,sCollapsedClass:this.htClassName.sCollapsed,sButtonClass:this.htClassName.sButton,sLabelClass:this.htClassName.sLabel,sText:htData.sLabel,htData:htData};var sCode=jindo.$Template(htParam.sTemplate).process(htProcess);sCode=this._getChildCode(htData._aChildren,sCode);aCodes.push(sCode);}
return aCodes.join('\n');}},_getChildCode:function(elChild,sCode){var sChild=elChild?this._getCode(elChild):'';if(sChild){var bChanged=false;sCode=sCode.replace(/(<ul(\s[^>]*)*>)(<\/ul>)/i,function(_,sBegin,__,sClose){bChanged=true;return sBegin+sChild+sClose;});if(!bChanged){sCode=sCode.replace(/<\/li>/i,function(_){return'\n<ul>'+sChild+'</ul>\n'+_;});}}
return sCode;},_setData:function(elChildListOfParentNode,aDatas){var aNodes=jindo.$$("> ."+this.htClassName.sNode,elChildListOfParentNode);for(var i=0,nLen=aNodes.length;i<nLen;i++){var elNode=aNodes[i];var htNodeData=aDatas[i];var sKey=this._makeNodeDataKey(elNode);htNodeData.bLastNode=(i===nLen-1);this._htNodeData[sKey]=htNodeData;var bHasChild=(typeof htNodeData._aChildren!="undefined"&&htNodeData._aChildren.length)?true:false;if(htNodeData.bHasChild=bHasChild){this._setData(this.getChildListOfNode(elNode),htNodeData._aChildren);}}},createNode:function(aDatas){var elDummy=jindo.$('<ul>');elDummy.innerHTML=this._getCode(aDatas);var aNodes=jindo.$$("> ."+this.htClassName.sNode,elDummy);this._setData(elDummy,aDatas);return aNodes;},getNodeRawData:function(elNode){return this.getNodeData(elNode);},getSelectCount:function(){return this;}}).extend(jindo.UIComponent);jindo.LayerPosition=jindo.$Class({$init:function(el,elLayer,htOption){this.option({sPosition:"outside-bottom",sAlign:"left",sValign:"",nTop:0,nLeft:0,bAuto:false});this.option(htOption||{});this.setElement(el);if(elLayer){this.setLayer(elLayer);}
if(el&&elLayer){this.setPosition();}
this._wfSetPosition=jindo.$Fn(function(){var el=this._elLayer;if(el&&this._welLayer.visible()){if(this.fireEvent("beforeAdjust",{elLayer:el,htCurrentPosition:this.getCurrentPosition(),htAdjustedPosition:this._adjustPosition(this.getCurrentPosition())})){this.setPosition();this.fireEvent("adjust",{elLayer:el,htCurrentPosition:this.getCurrentPosition()});}}},this);if(this.option("bAuto")){this._wfSetPosition.attach(window,"scroll").attach(window,"resize");}},getElement:function(){return this._el;},setElement:function(el){this._wel=this._el=jindo.$(el);if(this._el){this._wel=jindo.$Element(el);}
return this;},getLayer:function(){return this._elLayer;},setLayer:function(elLayer){this._elLayer=jindo.$(elLayer);this._welLayer=jindo.$Element(elLayer);if(this._elLayer.parentNode!=document.body){document.body.appendChild(this._elLayer);}
return this;},_isPosition:function(htOption,sWord){if(htOption.sPosition.indexOf(sWord)>-1){return true;}
return false;},_setLeftRight:function(htOption,htPosition){var el=this.getElement(),elLayer=this.getLayer(),nWidth=el.offsetWidth,nLayerWidth=elLayer.offsetWidth;if(el==document.body){nWidth=jindo.$Document().clientSize().width;}
var bLeft=this._isPosition(htOption,"left"),bRight=this._isPosition(htOption,"right"),bInside=this._isPosition(htOption,"inside");if(bLeft){if(bInside){htPosition.nLeft+=htOption.nLeft;}else{htPosition.nLeft-=nLayerWidth;htPosition.nLeft-=htOption.nLeft;}}else if(bRight){htPosition.nLeft+=nWidth;if(bInside){htPosition.nLeft-=nLayerWidth;htPosition.nLeft-=htOption.nLeft;}else{htPosition.nLeft+=htOption.nLeft;}}else{if(htOption.sAlign=="left"){htPosition.nLeft+=htOption.nLeft;}
if(htOption.sAlign=="center"){htPosition.nLeft+=(nWidth-nLayerWidth)/2;}
if(htOption.sAlign=="right"){htPosition.nLeft+=nWidth-nLayerWidth;htPosition.nLeft-=htOption.nLeft;}}
return htPosition;},_setVerticalAlign:function(htOption,htPosition){var el=this.getElement(),elLayer=this.getLayer(),nHeight=el.offsetHeight,nLayerHeight=elLayer.offsetHeight;if(el==document.body){nHeight=jindo.$Document().clientSize().height;}
switch(htOption.sValign){case"top":htPosition.nTop+=htOption.nTop;break;case"middle":htPosition.nTop+=(nHeight-nLayerHeight)/2;break;case"bottom":htPosition.nTop+=nHeight-nLayerHeight-htOption.nTop;break;}
return htPosition;},_adjustScrollPosition:function(htPosition){if(this.getElement()==document.body){var htScrollPosition=jindo.$Document().scrollPosition();htPosition.nTop+=htScrollPosition.top;htPosition.nLeft+=htScrollPosition.left;}
return htPosition;},getPosition:function(htOption){if(typeof htOption!="object"){htOption=this.option();}
if(typeof htOption.nTop=="undefined"){htOption.nTop=0;}
if(typeof htOption.nLeft=="undefined"){htOption.nLeft=0;}
var sArea,bCenter=this._isPosition(htOption,"center"),bInside=this._isPosition(htOption,"inside"),bTop=this._isPosition(htOption,"top"),bBottom=this._isPosition(htOption,"bottom"),bLeft=this._isPosition(htOption,"left"),bRight=this._isPosition(htOption,"right");if(bLeft){sArea="left";}
if(bRight){sArea="right";}
if(bTop){sArea="top";}
if(bBottom){sArea="bottom";}
if(bCenter){sArea="center";}
var el=this.getElement(),wel=jindo.$Element(el),elLayer=this.getLayer(),welLayer=jindo.$Element(elLayer),htElementPosition=wel.offset(),nWidth=el.offsetWidth,nHeight=el.offsetHeight,oClientSize,nLayerWidth=elLayer.offsetWidth,nLayerHeight=elLayer.offsetHeight,htPosition={nTop:htElementPosition.top,nLeft:htElementPosition.left};if(el==document.body){oClientSize=jindo.$Document().clientSize();nWidth=oClientSize.width;nHeight=oClientSize.height;}
nLayerWidth+=parseInt(welLayer.css('marginLeft'),10)+parseInt(welLayer.css('marginRight'),10)||0;nLayerHeight+=parseInt(welLayer.css('marginTop'),10)+parseInt(welLayer.css('marginBottom'),10)||0;switch(sArea){case"center":htPosition.nTop+=(nHeight-nLayerHeight)/2;htPosition.nTop+=htOption.nTop;htPosition.nLeft+=(nWidth-nLayerWidth)/2;htPosition.nLeft+=htOption.nLeft;break;case"top":if(bInside){htPosition.nTop+=htOption.nTop;}else{htPosition.nTop-=htOption.nTop+nLayerHeight;}
htPosition=this._setLeftRight(htOption,htPosition);break;case"bottom":htPosition.nTop+=nHeight;if(bInside){htPosition.nTop-=htOption.nTop+nLayerHeight;}else{htPosition.nTop+=htOption.nTop;}
htPosition=this._setLeftRight(htOption,htPosition);break;case"left":if(bInside){htPosition.nLeft+=htOption.nLeft;}else{htPosition.nLeft-=htOption.nLeft+nLayerWidth;}
htPosition=this._setVerticalAlign(htOption,htPosition);break;case"right":htPosition.nLeft+=nWidth;if(bInside){htPosition.nLeft-=htOption.nLeft+nLayerWidth;}else{htPosition.nLeft+=htOption.nLeft;}
htPosition=this._setVerticalAlign(htOption,htPosition);break;}
htPosition=this._adjustScrollPosition(htPosition);if(jindo.$Agent().navigator().ie&&jindo.$Agent().navigator().version<8&&window.external){try{var bHasFrameBorder=(window!=top)&&(window.frameElement)&&!window.frameElement.frameBorder;if(bHasFrameBorder){htPosition.nLeft-=2;htPosition.nTop-=2;}}catch(e){}}
return htPosition;},setPosition:function(htPosition){var welLayer=jindo.$Element(this.getLayer()),bVisible=welLayer.visible();if(!bVisible){welLayer.show();}
welLayer.css("left","-9999px").css("top","0px");if(typeof htPosition=="undefined"){htPosition=this.getPosition();}
if(this.option("bAuto")){htPosition=this._adjustPosition(htPosition);}
welLayer.css("left",htPosition.nLeft+"px").css("top",htPosition.nTop+"px");if(!bVisible){welLayer.hide();}
return this;},getCurrentPosition:function(){var welLayer=jindo.$Element(this.getLayer());return{nTop:parseInt(welLayer.css("top"),10),nLeft:parseInt(welLayer.css("left"),10)};},_isFullyVisible:function(htPosition){var elLayer=this.getLayer(),welLayer=jindo.$Element(elLayer),oScrollPosition=jindo.$Document().scrollPosition(),nScrollTop=oScrollPosition.top,nScrollLeft=oScrollPosition.left,oClientSize=jindo.$Document().clientSize(),nLayerWidth=elLayer.offsetWidth+(parseInt(welLayer.css('marginLeft'),10)+parseInt(welLayer.css('marginRight'),10)||0),nLayerHeight=elLayer.offsetHeight+(parseInt(welLayer.css('marginTop'),10)+parseInt(welLayer.css('marginBottom'),10)||0);if(htPosition.nLeft>=0&&htPosition.nTop>=0&&oClientSize.width>=htPosition.nLeft-nScrollLeft+nLayerWidth&&oClientSize.height>=htPosition.nTop-nScrollTop+nLayerHeight){return true;}
return false;},_mirrorHorizontal:function(htOption){if(htOption.sAlign=="center"||htOption.sPosition=="inside-center"){return htOption;}
var htConvertedOption={};for(var i in htOption){htConvertedOption[i]=htOption[i];}
if(this._isPosition(htConvertedOption,"right")){htConvertedOption.sPosition=htConvertedOption.sPosition.replace(/right/,"left");}else if(this._isPosition(htConvertedOption,"left")){htConvertedOption.sPosition=htConvertedOption.sPosition.replace(/left/,"right");}else if(htConvertedOption.sAlign=="right"){htConvertedOption.sAlign="left";}else if(htConvertedOption.sAlign=="left"){htConvertedOption.sAlign="right";}
return htConvertedOption;},_mirrorVertical:function(htOption){if(htOption.sValign=="middle"||htOption.sPosition=="inside-center"){return htOption;}
var htConvertedOption={};for(var i in htOption){htConvertedOption[i]=htOption[i];}
if(this._isPosition(htConvertedOption,"top")){htConvertedOption.sPosition=htConvertedOption.sPosition.replace(/top/,"bottom");}else if(this._isPosition(htConvertedOption,"bottom")){htConvertedOption.sPosition=htConvertedOption.sPosition.replace(/bottom/,"top");}else if(htConvertedOption.sValign=="top"){htConvertedOption.sValign="bottom";}else if(htConvertedOption.sValign=="bottom"){htConvertedOption.sValign="top";}
return htConvertedOption;},_adjustPosition:function(htPosition){var htOption=this.option(),aCandidatePosition=[];aCandidatePosition.push(htPosition);aCandidatePosition.push(this.getPosition(this._mirrorHorizontal(htOption)));aCandidatePosition.push(this.getPosition(this._mirrorVertical(htOption)));aCandidatePosition.push(this.getPosition(this._mirrorVertical(this._mirrorHorizontal(htOption))));for(var i=0,htCandidatePosition;(htCandidatePosition=aCandidatePosition[i]);i++){if(this._isFullyVisible(htCandidatePosition)){htPosition=htCandidatePosition;break;}}
return htPosition;}}).extend(jindo.Component);jindo.Foggy=jindo.$Class({_elFog:null,_bFogAppended:false,_oExcept:null,_bFogVisible:false,_bFogShowing:false,_oTransition:null,$init:function(htOption){this.option({sClassName:"fog",nShowDuration:200,nShowOpacity:0.5,nHideDuration:200,nHideOpacity:0,fShowEffect:jindo.Effect.linear,fHideEffect:jindo.Effect.linear,nFPS:15,nZIndex:32000});this.option(htOption||{});this._elFog=jindo.$('<div class="'+this.option("sClassName")+'">');this._welFog=jindo.$Element(this._elFog);document.body.insertBefore(this._elFog,document.body.firstChild);this._welFog.opacity(this.option('nHideOpacity'));this._welFog.hide();this._oExcept={};this._oTransition=new jindo.Transition().fps(this.option("nFPS"));this._fOnResize=jindo.$Fn(this._fitFogToDocument,this);this._fOnScroll=jindo.$Fn(this._fitFogToDocumentScrollSize,this);},_getScroll:function(wDocument){return{top:window.pageYOffset||document[wDocument._docKey].scrollTop,left:window.pageXOffset||document[wDocument._docKey].scrollLeft};},_fitFogToDocument:function(){var wDocument=jindo.$Document();this._elFog.style.left=this._getScroll(wDocument).left+'px';this._elFog.style.width="100%";var self=this;clearTimeout(this._nTimer);this._nTimer=null;this._nTimer=setTimeout(function(){var oSize=wDocument.clientSize();self._elFog.style.top=self._getScroll(wDocument).top+'px';self._elFog.style.height=oSize.height+'px';self._elFog.style.left=self._getScroll(wDocument).left+'px';},100);},_fitFogToDocumentScrollSize:function(){var oSize=jindo.$Document().scrollSize();this._elFog.style.left="0";this._elFog.style.top="0";this._elFog.style.width=oSize.width+'px';this._elFog.style.height=oSize.height+'px';},getFog:function(){return this._elFog;},isShown:function(){return this._bFogVisible;},isShowing:function(){return this._bFogShowing;},show:function(elExcept){if(!this._bFogVisible){if(this.fireEvent('beforeShow')){if(elExcept){this._oExcept.element=elExcept;var sPosition=jindo.$Element(elExcept).css('position');if(sPosition=='static'){elExcept.style.position='relative';}
this._oExcept.position=elExcept.style.position;this._oExcept.zIndex=elExcept.style.zIndex;elExcept.style.zIndex=this.option('nZIndex')+1;}
this._elFog.style.zIndex=this.option('nZIndex');this._elFog.style.display='none';this._fitFogToDocument();this._fOnResize.attach(window,"resize");this._fOnScroll.attach(window,"scroll");this._elFog.style.display='block';var self=this;this._bFogShowing=true;this._oTransition.abort().start(this.option('nShowDuration'),this._elFog,{'@opacity':this.option("fShowEffect")(this.option('nShowOpacity'))}).start(function(){self._bFogVisible=true;self._bFogShowing=false;self.fireEvent('show');});}}},hide:function(){if(this._bFogVisible||this._bFogShowing){if(this.fireEvent('beforeHide')){var self=this;this._oTransition.abort().start(this.option('nHideDuration'),this._elFog,{'@opacity':this.option("fHideEffect")(this.option('nHideOpacity'))}).start(function(){self._elFog.style.display='none';var elExcept=self._oExcept.element;if(elExcept){elExcept.style.position=self._oExcept.position;elExcept.style.zIndex=self._oExcept.zIndex;}
self._oExcept={};self._fOnResize.detach(window,"resize");self._fOnScroll.detach(window,"scroll");self._bFogVisible=false;self.fireEvent('hide');});}}}}).extend(jindo.Component);jindo.Effect=function(fEffect){if(this instanceof arguments.callee){throw new Error("You can't create a instance of this");}
var rxNumber=/^(\-?[0-9\.]+)(%|px|pt|em)?$/,rxRGB=/^rgb\(([0-9]+)\s?,\s?([0-9]+)\s?,\s?([0-9]+)\)$/i,rxHex=/^#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,rx3to6=/^#([0-9A-F])([0-9A-F])([0-9A-F])$/i;var getUnitAndValue=function(v){var nValue=v,sUnit;if(rxNumber.test(v)){nValue=parseFloat(v);sUnit=RegExp.$2||"";}else if(rxRGB.test(v)){nValue=[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)];sUnit='color';}else if(rxHex.test(v=v.replace(rx3to6,'#$1$1$2$2$3$3'))){nValue=[parseInt(RegExp.$1,16),parseInt(RegExp.$2,16),parseInt(RegExp.$3,16)];sUnit='color';}
return{nValue:nValue,sUnit:sUnit};};return function(nStart,nEnd){var sUnit;if(arguments.length>1){nStart=getUnitAndValue(nStart);nEnd=getUnitAndValue(nEnd);sUnit=nEnd.sUnit;}else{nEnd=getUnitAndValue(nStart);nStart=null;sUnit=nEnd.sUnit;}
if(nStart&&nEnd&&nStart.sUnit!=nEnd.sUnit){throw new Error('unit error');}
nStart=nStart&&nStart.nValue;nEnd=nEnd&&nEnd.nValue;var fReturn=function(p){var nValue=fEffect(p),getResult=function(s,d){return(d-s)*nValue+s+sUnit;};if(sUnit=='color'){var r=Math.max(0,Math.min(255,parseInt(getResult(nStart[0],nEnd[0]),10)))<<16;r|=Math.max(0,Math.min(255,parseInt(getResult(nStart[1],nEnd[1]),10)))<<8;r|=Math.max(0,Math.min(255,parseInt(getResult(nStart[2],nEnd[2]),10)));r=r.toString(16).toUpperCase();for(var i=0;6-r.length;i++){r='0'+r;}
return'#'+r;}
return getResult(nStart,nEnd);};if(nStart===null){fReturn.setStart=function(s){s=getUnitAndValue(s);if(s.sUnit!=sUnit){throw new Error('unit eror');}
nStart=s.nValue;};}
return fReturn;};};jindo.Effect.linear=jindo.Effect(function(s){return s;});jindo.Effect.easeInSine=jindo.Effect(function(s){return(s==1)?1:-Math.cos(s*(Math.PI/2))+1;});jindo.Effect.easeOutSine=jindo.Effect(function(s){return Math.sin(s*(Math.PI/2));});jindo.Effect.easeInOutSine=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInSine(0,1)(2*s)*0.5:jindo.Effect.easeOutSine(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeOutInSine=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeOutSine(0,1)(2*s)*0.5:jindo.Effect.easeInSine(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInQuad=jindo.Effect(function(s){return s*s;});jindo.Effect.easeOutQuad=jindo.Effect(function(s){return-(s*(s-2));});jindo.Effect.easeInOutQuad=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInQuad(0,1)(2*s)*0.5:jindo.Effect.easeOutQuad(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeOutInQuad=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeOutQuad(0,1)(2*s)*0.5:jindo.Effect.easeInQuad(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInCubic=jindo.Effect(function(s){return Math.pow(s,3);});jindo.Effect.easeOutCubic=jindo.Effect(function(s){return Math.pow((s-1),3)+1;});jindo.Effect.easeInOutCubic=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeIn(0,1)(2*s)*0.5:jindo.Effect.easeOut(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeOutInCubic=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeOut(0,1)(2*s)*0.5:jindo.Effect.easeIn(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInQuart=jindo.Effect(function(s){return Math.pow(s,4);});jindo.Effect.easeOutQuart=jindo.Effect(function(s){return-(Math.pow(s-1,4)-1);});jindo.Effect.easeInOutQuart=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInQuart(0,1)(2*s)*0.5:jindo.Effect.easeOutQuart(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeOutInQuart=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeOutQuart(0,1)(2*s)*0.5:jindo.Effect.easeInQuart(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInQuint=jindo.Effect(function(s){return Math.pow(s,5);});jindo.Effect.easeOutQuint=jindo.Effect(function(s){return Math.pow(s-1,5)+1;});jindo.Effect.easeInOutQuint=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInQuint(0,1)(2*s)*0.5:jindo.Effect.easeOutQuint(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeOutInQuint=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeOutQuint(0,1)(2*s)*0.5:jindo.Effect.easeInQuint(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInCircle=jindo.Effect(function(s){return-(Math.sqrt(1-(s*s))-1);});jindo.Effect.easeOutCircle=jindo.Effect(function(s){return Math.sqrt(1-(s-1)*(s-1));});jindo.Effect.easeInOutCircle=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInCircle(0,1)(2*s)*0.5:jindo.Effect.easeOutCircle(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeOutInCircle=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeOutCircle(0,1)(2*s)*0.5:jindo.Effect.easeInCircle(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInBack=jindo.Effect(function(s){var n=1.70158;return(s==1)?1:(s/1)*(s/1)*((1+n)*s-n);});jindo.Effect.easeOutBack=jindo.Effect(function(s){var n=1.70158;return(s===0)?0:(s=s/1-1)*s*((n+1)*s+n)+1;});jindo.Effect.easeInOutBack=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInBack(0,1)(2*s)*0.5:jindo.Effect.easeOutBack(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInElastic=jindo.Effect(function(s){var p=0,a=0,n;if(s===0){return 0;}
if((s/=1)==1){return 1;}
if(!p){p=0.3;}
if(!a||a<1){a=1;n=p/4;}else{n=p/(2*Math.PI)*Math.asin(1/a);}
return-(a*Math.pow(2,10*(s-=1))*Math.sin((s-1)*(2*Math.PI)/p));});jindo.Effect.easeOutElastic=jindo.Effect(function(s){var p=0,a=0,n;if(s===0){return 0;}
if((s/=1)==1){return 1;}
if(!p){p=0.3;}
if(!a||a<1){a=1;n=p/4;}else{n=p/(2*Math.PI)*Math.asin(1/a);}
return(a*Math.pow(2,-10*s)*Math.sin((s-n)*(2*Math.PI)/p)+1);});jindo.Effect.easeInOutElastic=jindo.Effect(function(s){var p=0,a=0,n;if(s===0){return 0;}
if((s/=1/2)==2){return 1;}
if(!p){p=(0.3*1.5);}
if(!a||a<1){a=1;n=p/4;}else{n=p/(2*Math.PI)*Math.asin(1/a);}
if(s<1){return-0.5*(a*Math.pow(2,10*(s-=1))*Math.sin((s-n)*(2*Math.PI)/p));}
return a*Math.pow(2,-10*(s-=1))*Math.sin((s-n)*(2*Math.PI)/p)*0.5+1;});jindo.Effect.easeOutBounce=jindo.Effect(function(s){if(s<(1/2.75)){return(7.5625*s*s);}else if(s<(2/2.75)){return(7.5625*(s-=(1.5/2.75))*s+0.75);}else if(s<(2.5/2.75)){return(7.5625*(s-=(2.25/2.75))*s+0.9375);}else{return(7.5625*(s-=(2.625/2.75))*s+0.984375);}});jindo.Effect.easeInBounce=jindo.Effect(function(s){return 1-jindo.Effect.easeOutBounce(0,1)(1-s);});jindo.Effect.easeInOutBounce=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInBounce(0,1)(2*s)*0.5:jindo.Effect.easeOutBounce(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeInExpo=jindo.Effect(function(s){return(s===0)?0:Math.pow(2,10*(s-1));});jindo.Effect.easeOutExpo=jindo.Effect(function(s){return(s==1)?1:-Math.pow(2,-10*s/1)+1;});jindo.Effect.easeInOutExpo=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeInExpo(0,1)(2*s)*0.5:jindo.Effect.easeOutExpo(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect.easeOutInExpo=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.easeOutExpo(0,1)(2*s)*0.5:jindo.Effect.easeInExpo(0,1)((2*s)-1)*0.5+0.5;});jindo.Effect._cubicBezier=function(x1,y1,x2,y2){return function(t){var cx=3.0*x1,bx=3.0*(x2-x1)-cx,ax=1.0-cx-bx,cy=3.0*y1,by=3.0*(y2-y1)-cy,ay=1.0-cy-by;function sampleCurveX(t){return((ax*t+bx)*t+cx)*t;}
function sampleCurveY(t){return((ay*t+by)*t+cy)*t;}
function sampleCurveDerivativeX(t){return(3.0*ax*t+2.0*bx)*t+cx;}
function solveCurveX(x,epsilon){var t0,t1,t2,x2,d2,i;for(t2=x,i=0;i<8;i++){x2=sampleCurveX(t2)-x;if(Math.abs(x2)<epsilon){return t2;}
d2=sampleCurveDerivativeX(t2);if(Math.abs(d2)<1e-6){break;}
t2=t2-x2/d2;}
t0=0.0;t1=1.0;t2=x;if(t2<t0){return t0;}
if(t2>t1){return t1;}
while(t0<t1){x2=sampleCurveX(t2);if(Math.abs(x2-x)<epsilon){return t2;}
if(x>x2){t0=t2;}else{t1=t2;}
t2=(t1-t0)*0.5+t0;}
return t2;}
return sampleCurveY(solveCurveX(t,1/200));};};jindo.Effect.cubicBezier=function(x1,y1,x2,y2){return jindo.Effect(jindo.Effect._cubicBezier(x1,y1,x2,y2));};jindo.Effect.cubicEase=jindo.Effect.cubicBezier(0.25,0.1,0.25,1);jindo.Effect.cubicEaseIn=jindo.Effect.cubicBezier(0.42,0,1,1);jindo.Effect.cubicEaseOut=jindo.Effect.cubicBezier(0,0,0.58,1);jindo.Effect.cubicEaseInOut=jindo.Effect.cubicBezier(0.42,0,0.58,1);jindo.Effect.cubicEaseOutIn=jindo.Effect.cubicBezier(0,0.42,1,0.58);jindo.Effect.overphase=jindo.Effect(function(s){s/=0.652785;return(Math.sqrt((2-s)*s)+(0.1*s)).toFixed(5);});jindo.Effect.sinusoidal=jindo.Effect(function(s){return(-Math.cos(s*Math.PI)/2)+0.5;});jindo.Effect.mirror=jindo.Effect(function(s){return(s<0.5)?jindo.Effect.sinusoidal(0,1)(s*2):jindo.Effect.sinusoidal(0,1)(1-(s-0.5)*2);});jindo.Effect.pulse=function(nPulse){return jindo.Effect(function(s){return(-Math.cos((s*(nPulse-0.5)*2)*Math.PI)/2)+0.5;});};jindo.Effect.wave=function(nPeriod,nHeight){return jindo.Effect(function(s){return(nHeight||1)*(Math.sin(nPeriod*(s*360)*Math.PI/180)).toFixed(5);});};jindo.Effect.easeIn=jindo.Effect.easeInCubic;jindo.Effect.easeOut=jindo.Effect.easeOutCubic;jindo.Effect.easeInOut=jindo.Effect.easeInOutCubic;jindo.Effect.easeOutIn=jindo.Effect.easeOutInCubic;jindo.Effect.bounce=jindo.Effect.easeOutBounce;jindo.Effect.elastic=jindo.Effect.easeInElastic;jindo.Transition=jindo.$Class({_nFPS:30,_aTaskQueue:null,_oTimer:null,_bIsWaiting:true,_bIsPlaying:false,$init:function(htOption){this._aTaskQueue=[];this._oTimer=new jindo.Timer();this._oSleepTimer=new jindo.Timer();this.option({fEffect:jindo.Effect.linear,bCorrection:false});this.option(htOption||{});},fps:function(nFPS){if(arguments.length>0){this._nFPS=nFPS;return this;}
return this._nFPS;},isPlaying:function(){return this._bIsPlaying;},abort:function(){this._aTaskQueue=[];this._oTimer.abort();this._oSleepTimer.abort();if(this._bIsPlaying){this.fireEvent("abort");}
this._bIsWaiting=true;this._bIsPlaying=false;this._htTaskToDo=null;return this;},start:function(nDuration,elTarget,htInfo){if(arguments.length>0){this.queue.apply(this,arguments);}
this._prepareNextTask();return this;},queue:function(nDuration,aCommand){var htTask;if(typeof arguments[0]=='function'){htTask={sType:"function",fTask:arguments[0]};}else{var a=[];if(arguments[1]instanceof Array){a=arguments[1];}else{var aInner=[];jindo.$A(arguments).forEach(function(v,i){if(i>0){aInner.push(v);if(i%2===0){a.push(aInner.concat());aInner=[];}}});}
htTask={sType:"task",nDuration:nDuration,aList:[]};for(var i=0,nLen=a.length;i<nLen;i++){var aValue=[],htArg=a[i][1],sEnd;for(var sKey in htArg){sEnd=htArg[sKey];if(/^(@|style\.)(\w+)/i.test(sKey)){aValue.push(["style",RegExp.$2,sEnd]);}else{aValue.push(["attr",sKey,sEnd]);}}
htTask.aList.push({elTarget:a[i][0],aValue:aValue});}}
this._queueTask(htTask);return this;},pause:function(){if(this._oTimer.abort()){this.fireEvent("pause");}
return this;},resume:function(){if(this._htTaskToDo){if(this._bIsWaiting===false&&this._bIsPlaying===true){this.fireEvent("resume");}
this._doTask();this._bIsWaiting=false;this._bIsPlaying=true;var self=this;this._oTimer.start(function(){var bEnd=!self._doTask();if(bEnd){self._bIsWaiting=true;setTimeout(function(){self._prepareNextTask();},0);}
return!bEnd;},this._htTaskToDo.nInterval);}
return this;},precede:function(nDuration,elTarget,htInfo){this.start.apply(this,arguments);return this;},sleep:function(nDuration,fCallback){if(typeof fCallback=="undefined"){fCallback=function(){};}
this._queueTask({sType:"sleep",nDuration:nDuration,fCallback:fCallback});this._prepareNextTask();return this;},_queueTask:function(v){this._aTaskQueue.push(v);},_dequeueTask:function(){var htTask=this._aTaskQueue.shift();if(htTask){if(htTask.sType=="task"){var aList=htTask.aList;for(var i=0,nLength=aList.length;i<nLength;i++){var elTarget=aList[i].elTarget,welTarget=null;for(var j=0,aValue=aList[i].aValue,nJLen=aValue.length;j<nJLen;j++){var sType=aValue[j][0],sKey=aValue[j][1],fFunc=aValue[j][2];if(typeof fFunc!="function"){var fEffect=this.option("fEffect");if(fFunc instanceof Array){fFunc=fEffect(fFunc[0],fFunc[1]);}else{fFunc=fEffect(fFunc);}
aValue[j][2]=fFunc;}
if(fFunc.setStart){if(this._isHTMLElement(elTarget)){welTarget=welTarget||jindo.$Element(elTarget);switch(sType){case"style":fFunc.setStart(welTarget.css(sKey));break;case"attr":fFunc.setStart(welTarget.$value()[sKey]);break;}}else{fFunc.setStart(elTarget.getter(sKey));}}}}}
return htTask;}else{return null;}},_prepareNextTask:function(){if(this._bIsWaiting){var htTask=this._dequeueTask();if(htTask){switch(htTask.sType){case"task":if(!this._bIsPlaying){this.fireEvent("start");}
var nInterval=1000/this._nFPS,nGap=nInterval/htTask.nDuration;this._htTaskToDo={aList:htTask.aList,nRatio:0,nInterval:nInterval,nGap:nGap,nStep:0,nTotalStep:Math.ceil(htTask.nDuration/nInterval)};this.resume();break;case"function":if(!this._bIsPlaying){this.fireEvent("start");}
htTask.fTask();this._prepareNextTask();break;case"sleep":if(this._bIsPlaying){this.fireEvent("sleep",{nDuration:htTask.nDuration});htTask.fCallback();}
var self=this;this._oSleepTimer.start(function(){self.fireEvent("awake");self._prepareNextTask();},htTask.nDuration);break;}}else{if(this._bIsPlaying){this._bIsPlaying=false;this.abort();this.fireEvent("end");}}}},_isHTMLElement:function(el){return("tagName"in el);},_doTask:function(){var htTaskToDo=this._htTaskToDo,nRatio=parseFloat(htTaskToDo.nRatio.toFixed(5),1),nStep=htTaskToDo.nStep,nTotalStep=htTaskToDo.nTotalStep,aList=htTaskToDo.aList,htCorrection={},bCorrection=this.option("bCorrection");for(var i=0,nLength=aList.length;i<nLength;i++){var elTarget=aList[i].elTarget,welTarget=null;for(var j=0,aValue=aList[i].aValue,nJLen=aValue.length;j<nJLen;j++){var sType=aValue[j][0],sKey=aValue[j][1],sValue=aValue[j][2](nRatio);if(this._isHTMLElement(elTarget)){if(bCorrection){var sUnit=/^\-?[0-9\.]+(%|px|pt|em)?$/.test(sValue)&&RegExp.$1||"";if(sUnit){var nValue=parseFloat(sValue);nValue+=htCorrection[sKey]||0;nValue=parseFloat(nValue.toFixed(5));if(i==nLength-1){sValue=Math.round(nValue)+sUnit;}else{htCorrection[sKey]=nValue-Math.floor(nValue);sValue=parseInt(nValue,10)+sUnit;}}}
welTarget=welTarget||jindo.$Element(elTarget);switch(sType){case"style":welTarget.css(sKey,sValue);break;case"attr":welTarget.$value()[sKey]=sValue;break;}}else{elTarget.setter(sKey,sValue);}
if(this._bIsPlaying){this.fireEvent("playing",{element:elTarget,sKey:sKey,sValue:sValue,nStep:nStep,nTotalStep:nTotalStep});}}}
htTaskToDo.nRatio=Math.min(htTaskToDo.nRatio+htTaskToDo.nGap,1);htTaskToDo.nStep+=1;return nRatio!=1;}}).extend(jindo.Component);(function(){var b=jindo.$Element.prototype.css;jindo.$Element.prototype.css=function(k,v){if(k=="opacity"){return typeof v!="undefined"?this.opacity(parseFloat(v)):this.opacity();}else{return typeof v!="undefined"?b.call(this,k,v):b.call(this,k);}};})();jindo.Timer=jindo.$Class({$init:function(){this._nTimer=null;this._nLatest=null;this._nRemained=0;this._nDelay=null;this._fRun=null;this._bIsRunning=false;},start:function(fRun,nDelay){this.abort();this._nRemained=0;this._nDelay=nDelay;this._fRun=fRun;this._bIsRunning=true;this._nLatest=this._getTime();this.fireEvent('wait');this._excute(this._nDelay,false);return true;},isRunning:function(){return this._bIsRunning;},_getTime:function(){return new Date().getTime();},_clearTimer:function(){var bFlag=false;if(this._nTimer){clearInterval(this._nTimer);this._bIsRunning=false;bFlag=true;}
this._nTimer=null;return bFlag;},abort:function(){var bReturn=this._clearTimer();if(bReturn){this.fireEvent('abort');this._fRun=null;}
return bReturn;},pause:function(){var nPassed=this._getTime()-this._nLatest;this._nRemained=Math.max(this._nDelay-nPassed,0);return this._clearTimer();},_excute:function(nDelay,bResetDelay){var self=this;this._clearTimer();this._bIsRunning=true;var launcher=function(bDontUseTimer){if(self._nTimer||bDontUseTimer){self.fireEvent('run');var r=self._fRun();self._nLatest=self._getTime();if(!r){if(!bDontUseTimer){clearInterval(self._nTimer);}
self._nTimer=null;self._bIsRunning=false;self.fireEvent('end');return;}
self.fireEvent('wait');if(bResetDelay||bDontUseTimer){self._excute(self._nDelay,false);}}};if(nDelay>-1){this._nTimer=setInterval(launcher,nDelay);}else{launcher(true);}},resume:function(){if(!this._fRun||this.isRunning()){return false;}
this._bIsRunning=true;this.fireEvent('wait');this._excute(this._nRemained,true);this._nRemained=0;return true;}}).extend(jindo.Component);jindo.DragArea=jindo.$Class({$init:function(el,htOption){this.option({sClassName:'draggable',bFlowOut:true,bSetCapture:true,nThreshold:0});this.option(htOption||{});this._el=el;this._bIE=jindo.$Agent().navigator().ie;this._htDragInfo={"bIsDragging":false,"bPrepared":false,"bHandleDown":false,"bForceDrag":false};this._wfOnMouseDown=jindo.$Fn(this._onMouseDown,this);this._wfOnMouseMove=jindo.$Fn(this._onMouseMove,this);this._wfOnMouseUp=jindo.$Fn(this._onMouseUp,this);this._wfOnDragStart=jindo.$Fn(this._onDragStart,this);this._wfOnSelectStart=jindo.$Fn(this._onSelectStart,this);this.activate();},_findDraggableElement:function(el){if(el.nodeType===1&&jindo.$$.test(el,"input[type=text], textarea, select")){return null;}
var self=this;var sClass='.'+this.option('sClassName');var isChildOfDragArea=function(el){if(el===null){return false;}
if(self._el===document||self._el===el){return true;}
return jindo.$Element(self._el).isParentOf(el);};var elReturn=jindo.$$.test(el,sClass)?el:jindo.$$.getSingle('! '+sClass,el);if(!isChildOfDragArea(elReturn)){elReturn=null;}
return elReturn;},isDragging:function(){var htDragInfo=this._htDragInfo;return htDragInfo.bIsDragging&&!htDragInfo.bPrepared;},stopDragging:function(){this._stopDragging(true);return this;},_stopDragging:function(bInterupted){this._wfOnMouseMove.detach(document,'mousemove');this._wfOnMouseUp.detach(document,'mouseup');if(this.isDragging()){var htDragInfo=this._htDragInfo,welDrag=jindo.$Element(htDragInfo.elDrag);htDragInfo.bIsDragging=false;htDragInfo.bForceDrag=false;htDragInfo.bPrepared=false;if(this._bIE&&this._elSetCapture){this._elSetCapture.releaseCapture();this._elSetCapture=null;}
this.fireEvent('dragEnd',{"elArea":this._el,"elHandle":htDragInfo.elHandle,"elDrag":htDragInfo.elDrag,"nX":parseInt(welDrag.css("left"),10)||0,"nY":parseInt(welDrag.css("top"),10)||0,"bInterupted":bInterupted});}},_onActivate:function(){this._wfOnMouseDown.attach(this._el,'mousedown');this._wfOnDragStart.attach(this._el,'dragstart');this._wfOnSelectStart.attach(this._el,'selectstart');},_onDeactivate:function(){this._wfOnMouseDown.detach(this._el,'mousedown');this._wfOnDragStart.detach(this._el,'dragstart');this._wfOnSelectStart.detach(this._el,'selectstart');},attachEvent:function(){this.activate();},detachEvent:function(){this.deactivate();},isEventAttached:function(){return this.isActivating();},startDragging:function(el){var elDrag=this._findDraggableElement(el);if(elDrag){this._htDragInfo.bForceDrag=true;this._htDragInfo.bPrepared=true;this._htDragInfo.elHandle=elDrag;this._htDragInfo.elDrag=elDrag;this._wfOnMouseMove.attach(document,'mousemove');this._wfOnMouseUp.attach(document,'mouseup');return true;}
return false;},_onMouseDown:function(we){var mouse=we.mouse(true);if(!mouse.left||mouse.right||mouse.scrollbar){this._stopDragging(true);return;}
var el=this._findDraggableElement(we.element);if(el){var oPos=we.pos(),htDragInfo=this._htDragInfo;htDragInfo.bHandleDown=true;htDragInfo.bPrepared=true;htDragInfo.nButton=we._event.button;htDragInfo.elHandle=el;htDragInfo.elDrag=el;htDragInfo.nPageX=oPos.pageX;htDragInfo.nPageY=oPos.pageY;if(this.fireEvent('handleDown',{elHandle:el,elDrag:el,weEvent:we})){this._wfOnMouseMove.attach(document,'mousemove');}
this._wfOnMouseUp.attach(document,'mouseup');we.stop(jindo.$Event.CANCEL_DEFAULT);}},_onMouseMove:function(we){var htDragInfo=this._htDragInfo,htParam,htRect,oPos=we.pos(),htGap={"nX":oPos.pageX-htDragInfo.nPageX,"nY":oPos.pageY-htDragInfo.nPageY};if(htDragInfo.bPrepared){var nThreshold=this.option('nThreshold'),htDiff={};if(!htDragInfo.bForceDrag&&nThreshold){htDiff.nPageX=oPos.pageX-htDragInfo.nPageX;htDiff.nPageY=oPos.pageY-htDragInfo.nPageY;var nDistance=Math.sqrt(htDiff.nPageX*htDiff.nPageX+htDiff.nPageY*htDiff.nPageY);if(nThreshold>nDistance){return;}}
if(this._bIE&&this.option("bSetCapture")){this._elSetCapture=(this._el===document)?document.body:this._findDraggableElement(we.element);if(this._elSetCapture){this._elSetCapture.setCapture(false);}}
htParam={elArea:this._el,elHandle:htDragInfo.elHandle,elDrag:htDragInfo.elDrag,htDiff:htDiff,weEvent:we};htDragInfo.bIsDragging=true;htDragInfo.bPrepared=false;if(this.fireEvent('dragStart',htParam)){var welDrag=jindo.$Element(htParam.elDrag),htOffset=welDrag.offset();htDragInfo.elHandle=htParam.elHandle;htDragInfo.elDrag=htParam.elDrag;htDragInfo.nX=parseInt(welDrag.css('left'),10)||0;htDragInfo.nY=parseInt(welDrag.css('top'),10)||0;htDragInfo.nClientX=htOffset.left+welDrag.width()/2;htDragInfo.nClientY=htOffset.top+welDrag.height()/2;}else{htDragInfo.bPrepared=true;return;}}
if(htDragInfo.bForceDrag){htGap.nX=oPos.clientX-htDragInfo.nClientX;htGap.nY=oPos.clientY-htDragInfo.nClientY;}
htParam={"elArea":this._el,"elFlowOut":htDragInfo.elDrag.parentNode,"elHandle":htDragInfo.elHandle,"elDrag":htDragInfo.elDrag,"weEvent":we,"nX":htDragInfo.nX+htGap.nX,"nY":htDragInfo.nY+htGap.nY,"nGapX":htGap.nX,"nGapY":htGap.nY};if(this.fireEvent('beforeDrag',htParam)){var elDrag=htDragInfo.elDrag;if(this.option('bFlowOut')===false){var elParent=htParam.elFlowOut,aSize=[elDrag.offsetWidth,elDrag.offsetHeight],nScrollLeft=0,nScrollTop=0;if(elParent==document.body){nScrollLeft=document.body.scrollLeft||document.documentElement.scrollLeft;nScrollTop=document.body.scrollTop||document.documentElement.scrollTop;elParent=null;}
if(elParent&&aSize[0]<=elParent.scrollWidth&&aSize[1]<=elParent.scrollHeight){htRect={nWidth:elParent.clientWidth,nHeight:elParent.clientHeight};nScrollLeft=elParent.scrollLeft;nScrollTop=elParent.scrollTop;}else{var htClientSize=jindo.$Document().clientSize();htRect={nWidth:htClientSize.width,nHeight:htClientSize.height};}
if(htParam.nX!==null){htParam.nX=Math.max(htParam.nX,nScrollLeft);htParam.nX=Math.min(htParam.nX,htRect.nWidth-aSize[0]+nScrollLeft);}
if(htParam.nY!==null){htParam.nY=Math.max(htParam.nY,nScrollTop);htParam.nY=Math.min(htParam.nY,htRect.nHeight-aSize[1]+nScrollTop);}}
if(htParam.nX!==null){elDrag.style.left=htParam.nX+'px';}
if(htParam.nY!==null){elDrag.style.top=htParam.nY+'px';}
this.fireEvent('drag',htParam);}else{htDragInfo.bIsDragging=false;}},_onMouseUp:function(we){this._stopDragging(false);var htDragInfo=this._htDragInfo;htDragInfo.bHandleDown=false;this.fireEvent("handleUp",{weEvent:we,elHandle:htDragInfo.elHandle,elDrag:htDragInfo.elDrag});},_onDragStart:function(we){if(this._findDraggableElement(we.element)){we.stop(jindo.$Event.CANCEL_DEFAULT);}},_onSelectStart:function(we){if(this.isDragging()||this._findDraggableElement(we.element)){we.stop(jindo.$Event.CANCEL_DEFAULT);}}}).extend(jindo.UIComponent);jindo.Calendar=jindo.$Class({$init:function(sLayerId,htOption){var htToday=this.constructor.getToday();this.setToday(htToday.nYear,htToday.nMonth,htToday.nDate);this._elLayer=jindo.$(sLayerId);this._htDefaultOption={sClassPrefix:"calendar-",nYear:this._htToday.nYear,nMonth:this._htToday.nMonth,nDate:this._htToday.nDate,sTitleFormat:"yyyy-mm",sYearTitleFormat:"yyyy",sMonthTitleFormat:"m",aMonthTitle:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],bDrawOnload:true};this.option(this._htDefaultOption);this.option(htOption||{});this._assignHTMLElements();this.activate();this.setDate(this.option("nYear"),this.option("nMonth"),this.option("nDate"));if(this.option("bDrawOnload")){this.draw();}},getBaseElement:function(){return this._elLayer;},getDate:function(){return this._htDate;},getDateOfElement:function(el){var nDateIndex=jindo.$A(this._aDateContainerElement).indexOf(el);if(nDateIndex>-1){return this._aMetaData[nDateIndex];}
return null;},setToday:function(nYear,nMonth,nDate){if(!this._htToday){this._htToday={};}
this._htToday.nYear=nYear;this._htToday.nMonth=nMonth;this._htToday.nDate=nDate;return this;},getToday:function(){return{nYear:this._htToday.nYear,nMonth:this._htToday.nMonth,nDate:this._htToday.nDate};},setDate:function(nYear,nMonth,nDate){this._htDate={nYear:nYear,nMonth:(nMonth*1),nDate:(nDate*1)};},getShownDate:function(){return this._getShownDate();},_getShownDate:function(){return this.htShownDate||this.getDate();},_setShownDate:function(nYear,nMonth){this.htShownDate={nYear:nYear,nMonth:(nMonth*1),nDate:1};},_assignHTMLElements:function(){var sClassPrefix=this.option("sClassPrefix"),elLayer=this.getBaseElement();if((this.elBtnPrevYear=jindo.$$.getSingle(("."+sClassPrefix+"btn-prev-year"),elLayer))){this.wfPrevYear=jindo.$Fn(function(oEvent){oEvent.stop(jindo.$Event.CANCEL_DEFAULT);this.draw(-1,0,true);},this);}
if((this.elBtnPrevMonth=jindo.$$.getSingle(("."+sClassPrefix+"btn-prev-mon"),elLayer))){this.wfPrevMonth=jindo.$Fn(function(oEvent){oEvent.stop(jindo.$Event.CANCEL_DEFAULT);this.draw(0,-1,true);},this);}
if((this.elBtnNextMonth=jindo.$$.getSingle(("."+sClassPrefix+"btn-next-mon"),elLayer))){this.wfNextMonth=jindo.$Fn(function(oEvent){oEvent.stop(jindo.$Event.CANCEL_DEFAULT);this.draw(0,1,true);},this);}
if((this.elBtnNextYear=jindo.$$.getSingle(("."+sClassPrefix+"btn-next-year"),elLayer))){this.wfNextYear=jindo.$Fn(function(oEvent){oEvent.stop(jindo.$Event.CANCEL_DEFAULT);this.draw(1,0,true);},this);}
this.elTitle=jindo.$$.getSingle(("."+sClassPrefix+"title"),elLayer);this.elTitleYear=jindo.$$.getSingle(("."+sClassPrefix+"title-year"),elLayer);this.elTitleMonth=jindo.$$.getSingle(("."+sClassPrefix+"title-month"),elLayer);var elWeekTemplate=jindo.$$.getSingle("."+sClassPrefix+"week",elLayer);this.elWeekTemplate=elWeekTemplate.cloneNode(true);this.elWeekAppendTarget=elWeekTemplate.parentNode;},_setCalendarTitle:function(nYear,nMonth,sType){if(nMonth<10){nMonth=("0"+(nMonth*1)).toString();}
var elTitle=this.elTitle,sTitleFormat=this.option("sTitleFormat"),sTitle;if(typeof sType!="undefined"){switch(sType){case"year":elTitle=this.elTitleYear;sTitleFormat=this.option("sYearTitleFormat");sTitle=sTitleFormat.replace(/yyyy/g,nYear).replace(/y/g,(nYear).toString().substr(2,2));break;case"month":elTitle=this.elTitleMonth;sTitleFormat=this.option("sMonthTitleFormat");sTitle=sTitleFormat.replace(/mm/g,nMonth).replace(/m/g,(nMonth*1)).replace(/M/g,this.option("aMonthTitle")[nMonth-1]);break;}}else{sTitle=sTitleFormat.replace(/yyyy/g,nYear).replace(/y/g,(nYear).toString().substr(2,2)).replace(/mm/g,nMonth).replace(/m/g,(nMonth*1)).replace(/M/g,this.option("aMonthTitle")[nMonth-1]);}
jindo.$Element(elTitle).text(sTitle);},draw:function(nYear,nMonth,bRelative){var sClassPrefix=this.option("sClassPrefix"),htDate=this.getDate(),oShownDate=this._getShownDate();if(oShownDate&&typeof bRelative!="undefined"&&bRelative){var htRelativeDate=this.constructor.getRelativeDate(nYear,nMonth,0,oShownDate);nYear=htRelativeDate.nYear;nMonth=htRelativeDate.nMonth;}else if(typeof nYear=="undefined"&&typeof nMonth=="undefined"&&typeof bRelative=="undefined"){nYear=htDate.nYear;nMonth=htDate.nMonth;}else{nYear=nYear||oShownDate.nYear;nMonth=nMonth||oShownDate.nMonth;}
if(this.fireEvent("beforeDraw",{nYear:nYear,nMonth:nMonth})){if(this.elTitle){this._setCalendarTitle(nYear,nMonth);}
if(this.elTitleYear){this._setCalendarTitle(nYear,nMonth,"year");}
if(this.elTitleMonth){this._setCalendarTitle(nYear,nMonth,"month");}
this._clear(jindo.Calendar.getWeeks(nYear,nMonth));this._setShownDate(nYear,nMonth);var htToday=this.getToday(),nFirstDay=this.constructor.getFirstDay(nYear,nMonth),nLastDay=this.constructor.getLastDay(nYear,nMonth),nLastDate=this.constructor.getLastDate(nYear,nMonth),nDay=0,htDatePrevMonth=this.constructor.getRelativeDate(0,-1,0,{nYear:nYear,nMonth:nMonth,nDate:1}),htDateNextMonth=this.constructor.getRelativeDate(0,1,0,{nYear:nYear,nMonth:nMonth,nDate:1}),nPrevMonthLastDate=this.constructor.getLastDate(htDatePrevMonth.nYear,htDatePrevMonth.nMonth),aDate=[],bPrevMonth,bNextMonth,welDateContainer,nTempYear,nTempMonth,oParam,nIndexOfLastDate,elWeek,i;var nWeeks=this.constructor.getWeeks(nYear,nMonth);for(i=0;i<nWeeks;i++){elWeek=this.elWeekTemplate.cloneNode(true);jindo.$Element(elWeek).appendTo(this.elWeekAppendTarget);this._aWeekElement.push(elWeek);}
this._aDateElement=jindo.$$("."+sClassPrefix+"date",this.elWeekAppendTarget);this._aDateContainerElement=jindo.$$("."+sClassPrefix+"week > *",this.elWeekAppendTarget);if(nFirstDay>0){for(i=nPrevMonthLastDate-nFirstDay;i<nPrevMonthLastDate;i++){aDate.push(i+1);}}
for(i=1;i<nLastDate+1;i++){aDate.push(i);}
nIndexOfLastDate=aDate.length-1;for(i=1;i<7-nLastDay;i++){aDate.push(i);}
for(i=0;i<aDate.length;i++){bPrevMonth=false;bNextMonth=false;welDateContainer=jindo.$Element(this._aDateContainerElement[i]);nTempYear=nYear;nTempMonth=nMonth;if(i<nFirstDay){bPrevMonth=true;welDateContainer.addClass(sClassPrefix+"prev-mon");nTempYear=htDatePrevMonth.nYear;nTempMonth=htDatePrevMonth.nMonth;}else if(i>nIndexOfLastDate){bNextMonth=true;welDateContainer.addClass(sClassPrefix+"next-mon");nTempYear=htDateNextMonth.nYear;nTempMonth=htDateNextMonth.nMonth;}else{nTempYear=nYear;nTempMonth=nMonth;}
if(nDay===0){welDateContainer.addClass(sClassPrefix+"sun");}
if(nDay==6){welDateContainer.addClass(sClassPrefix+"sat");}
if(nTempYear==htToday.nYear&&(nTempMonth*1)==htToday.nMonth&&aDate[i]==htToday.nDate){welDateContainer.addClass(sClassPrefix+"today");}
oParam={elDate:this._aDateElement[i],elDateContainer:welDateContainer.$value(),nYear:nTempYear,nMonth:nTempMonth,nDate:aDate[i],bPrevMonth:bPrevMonth,bNextMonth:bNextMonth,sHTML:aDate[i]};jindo.$Element(oParam.elDate).html(oParam.sHTML.toString());this._aMetaData.push({nYear:nTempYear,nMonth:nTempMonth,nDate:aDate[i]});nDay=(nDay+1)%7;this.fireEvent("draw",oParam);}
this.fireEvent("afterDraw",{nYear:nYear,nMonth:nMonth});}},_clear:function(nWeek){this._aMetaData=[];this._aWeekElement=[];jindo.$Element(this.elWeekAppendTarget).empty();},attachEvent:function(){this.activate();},detachEvent:function(){this.deactivate();},_onActivate:function(){if(this.elBtnPrevYear){this.wfPrevYear.attach(this.elBtnPrevYear,"click");}
if(this.elBtnPrevMonth){this.wfPrevMonth.attach(this.elBtnPrevMonth,"click");}
if(this.elBtnNextMonth){this.wfNextMonth.attach(this.elBtnNextMonth,"click");}
if(this.elBtnNextYear){this.wfNextYear.attach(this.elBtnNextYear,"click");}},_onDeactivate:function(){if(this.elBtnPrevYear){this.wfPrevYear.detach(this.elBtnPrevYear,"click");}
if(this.elBtnPrevMonth){this.wfPrevMonth.detach(this.elBtnPrevMonth,"click");}
if(this.elBtnNextMonth){this.wfNextMonth.detach(this.elBtnNextMonth,"click");}
if(this.elBtnNextYear){this.wfNextYear.detach(this.elBtnNextYear,"click");}}}).extend(jindo.UIComponent);jindo.Calendar.setToday=function(nYear,nMonth,nDate){if(!this._htToday){this._htToday={};}
this._htToday.nYear=nYear;this._htToday.nMonth=nMonth;this._htToday.nDate=nDate;return this;};jindo.Calendar.getToday=function(){var htToday=this._htToday||this.getDateHashTable(new Date());return{nYear:htToday.nYear,nMonth:htToday.nMonth,nDate:htToday.nDate};};jindo.Calendar.getDateObject=function(htDate){if(arguments.length==3){return new Date(arguments[0],arguments[1]-1,arguments[2]);}
return new Date(htDate.nYear,htDate.nMonth-1,htDate.nDate);};jindo.Calendar.getDateHashTable=function(oDate){if(arguments.length==3){return{nYear:arguments[0],nMonth:arguments[1],nDate:arguments[2]};}
if(arguments.length<=1){oDate=oDate||new Date();}
return{nYear:oDate.getFullYear(),nMonth:oDate.getMonth()+1,nDate:oDate.getDate()};};jindo.Calendar.getTime=function(htDate){return this.getDateObject(htDate).getTime();};jindo.Calendar.getFirstDay=function(nYear,nMonth){return new Date(nYear,nMonth-1,1).getDay();};jindo.Calendar.getLastDay=function(nYear,nMonth){return new Date(nYear,nMonth,0).getDay();};jindo.Calendar.getLastDate=function(nYear,nMonth){return new Date(nYear,nMonth,0).getDate();};jindo.Calendar.getWeeks=function(nYear,nMonth){var nFirstDay=this.getFirstDay(nYear,nMonth),nLastDate=this.getLastDate(nYear,nMonth);return Math.ceil((nFirstDay+nLastDate)/7);};jindo.Calendar.getRelativeDate=function(nYear,nMonth,nDate,htDate){var beforeDate=jindo.$Date(new Date(htDate.nYear,htDate.nMonth,htDate.nDate));var day={"1":31,"2":28,"3":31,"4":30,"5":31,"6":30,"7":31,"8":31,"9":30,"10":31,"11":30,"12":31};if(beforeDate.isLeapYear()){day={"1":31,"2":29,"3":31,"4":30,"5":31,"6":30,"7":31,"8":31,"9":30,"10":31,"11":30,"12":31};}
if(day[htDate.nMonth]==htDate.nDate){htDate.nDate=day[htDate.nMonth+nMonth];}
var changeDate=this.getDateHashTable(new Date(htDate.nYear+nYear,htDate.nMonth+nMonth-1,htDate.nDate+nDate));return this.getDateHashTable(new Date(htDate.nYear+nYear,htDate.nMonth+nMonth-1,htDate.nDate+nDate));};jindo.Calendar.isValidDate=function(nYear,nMonth,nDate){if(nMonth<=12&&nDate<=this.getLastDate(nYear,nMonth)){return true;}else{return false;}};jindo.Calendar.isPast=function(htDate,htComparisonDate){if(this.getTime(htDate)<this.getTime(htComparisonDate)){return true;}
return false;};jindo.Calendar.isFuture=function(htDate,htComparisonDate){if(this.getTime(htDate)>this.getTime(htComparisonDate)){return true;}
return false;};jindo.Calendar.isSameDate=function(htDate,htComparisonDate){if(this.getTime(htDate)==this.getTime(htComparisonDate)){return true;}
return false;};jindo.Calendar.isBetween=function(htDate,htFrom,htTo){if(this.isFuture(htDate,htTo)||this.isPast(htDate,htFrom)){return false;}else{return true;}};jindo.LayerManager=jindo.$Class({_bIsActivating:false,_bIsHiding:false,_bIsShowing:false,_aLink:null,$init:function(el,htOption){this.option({sCheckEvent:"click",nCheckDelay:100,nShowDelay:0,nHideDelay:100});this.option(htOption||{});this.setLayer(el);this._aLink=[];this._oShowTimer=new jindo.Timer();this._oHideTimer=new jindo.Timer();this._oEventTimer=new jindo.Timer();this._wfOnEvent=jindo.$Fn(this._onEvent,this);this.getVisible();this.activate();},_onActivate:function(){this._wfOnEvent.attach(document,this.option("sCheckEvent"));},_onDeactivate:function(){this._wfOnEvent.detach(document,this.option("sCheckEvent"));},getVisible:function(){return this._wel.visible();},_check:function(el){var wel=jindo.$Element(el);for(var i=0,elLink,welLink;(elLink=this._aLink[i]);i++){welLink=jindo.$Element(elLink);if(welLink){elLink=welLink.$value();if(elLink&&(el==elLink||wel.isChildOf(elLink))){return true;}}}
return false;},_find:function(el){for(var i=0,elLink;(elLink=this._aLink[i]);i++){if(elLink==el){return i;}}
return-1;},getLayer:function(){return this._el;},setLayer:function(el){this._el=jindo.$(el);this._wel=jindo.$Element(el);return this;},getLinks:function(){return this._aLink;},setLinks:function(a){this._aLink=jindo.$A(a).unique().$value();return this;},link:function(vElement){if(arguments.length>1){for(var i=0,len=arguments.length;i<len;i++){this.link(arguments[i]);}
return this;}
if(this._find(vElement)!=-1){return this;}
this._aLink.push(vElement);return this;},unlink:function(vElement){if(arguments.length>1){for(var i=0,len=arguments.length;i<len;i++){this.unlink(arguments[i]);}
return this;}
var nIndex=this._find(vElement);if(nIndex>-1){this._aLink.splice(nIndex,1);}
return this;},_fireEventBeforeShow:function(){return this.fireEvent("beforeShow",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()});},_fireEventShow:function(){this._bIsShowing=false;this.fireEvent("show",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()});},_fireEventBeforeHide:function(){var bRet=this.fireEvent("beforeHide",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()});if(!bRet){this._bIsHiding=false;}
return bRet;},_fireEventHide:function(){this._bIsHiding=false;this.fireEvent("hide",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()});},_show:function(fShow,nDelay){var self=this;this._oEventTimer.abort();this._bIsShowing=true;this._bIsHiding=false;if(nDelay<=0){self._oHideTimer.abort();}
this._oShowTimer.start(function(){fShow();},nDelay);},_hide:function(fHide,nDelay){var self=this;this._bIsShowing=false;this._bIsHiding=true;if(nDelay<=0){self._oShowTimer.abort();}
this._oHideTimer.start(function(){fHide();},nDelay);},show:function(nDelay){if(typeof nDelay=="undefined"){nDelay=this.option("nShowDelay");}
var self=this;this._show(function(){if(!self.getVisible()){if(self._fireEventBeforeShow()){self._wel.show();self._fireEventShow();}}},nDelay);return this;},hide:function(nDelay){if(typeof nDelay=="undefined"){nDelay=this.option("nHideDelay");}
var self=this;this._hide(function(){if(self.getVisible()){if(self._fireEventBeforeHide()){self._wel.hide();self._fireEventHide();}}},nDelay);return this;},toggle:function(nDelay){if(!this.getVisible()||this._bIsHiding){this.show(nDelay||this.option("nShowDelay"));}else{this.hide(nDelay||this.option("nHideDelay"));}
return this;},_onEvent:function(we){var el=we.element,self=this;this._oEventTimer.start(function(){if(!self._bIsHiding&&self.getVisible()){if(self._check(el)){if(!self._bIsShowing){self.fireEvent("ignore",{sCheckEvent:self.option("sCheckEvent")});self._oHideTimer.abort();self._bIsHiding=false;}}else{if(typeof el.tagName!="undefined"){self.hide();}}}},this.option("nCheckDelay"));}}).extend(jindo.UIComponent);jindo.TextRange=jindo.$Class({$init:function(el,htOption){this.option({bActivateOnload:true});this.option(htOption||{});this._el=jindo.$(el);this._bFocused=false;this._wfFocus=jindo.$Fn(function(){this._bFocused=true;},this);this._wfBlur=jindo.$Fn(function(){this._bFocused=false;},this);if(this.option("bActivateOnload")){this.activate();}},_onActivate:function(){this._wfFocus.attach(this._el,'focus').attach(this._el,'keydown');this._wfBlur.attach(this._el,'blur');},_onDeactivate:function(){this._wfFocus.detach(this._el,'focus').detach(this._el,'keydown');this._wfBlur.detach(this._el,'blur');},hasFocus:function(){return this._bFocused;},getSelection:function(){var el=this._el;if(!this._bFocused){this._el.focus();}
var aSelection=[-1,-1];if(isNaN(this._el.selectionStart)){var oRange=document.selection.createRange().duplicate(),nLength=el.value.length,nRangeLength=oRange.text.length;for(var i=0;i<nLength;i++){if(oRange.parentElement()!==el){break;}
oRange.moveStart('character',-1);}
aSelection[1]=oRange.text.length;aSelection[0]=aSelection[1]-nRangeLength;}else{aSelection[0]=el.selectionStart;aSelection[1]=el.selectionEnd;}
this.setSelection(aSelection[0],aSelection[1]);return aSelection;},setSelection:function(nStart,nEnd){var el=this._el;if(typeof nEnd=='undefined'){nEnd=nStart;}
if(el.setSelectionRange){el.setSelectionRange(nStart,nEnd);}else if(el.createTextRange){var oRange=el.createTextRange();oRange.collapse(true);oRange.moveStart("character",nStart);oRange.moveEnd("character",nEnd-nStart);oRange.select();}},copy:function(){if(!this._bFocused){this._el.focus();}
var aSelection=this.getSelection();return this._el.value.substring(aSelection[0],aSelection[1]);},paste:function(sStr){if(!this._bFocused){this._el.focus();}
var el=this._el,aSelection=this.getSelection(),sValue=el.value,sPre=sValue.substr(0,aSelection[0]),sPost=sValue.substr(aSelection[1]);sValue=sPre+sStr+sPost;el.value=sValue;this.setSelection(aSelection[0]+sStr.length);},cut:function(){var s=this.copy();this.paste("");return s;}}).extend(jindo.UIComponent);jindo.WatchInput=jindo.$Class({_bTimerRunning:false,_bFocused:false,_sPrevValue:"",$init:function(sInputId,htOption){var htDefaultOption={nInterval:100,bUseTimerOnIE:false,sKeyEvent:"keyup",bPermanent:false,bActivateOnload:true};this.option(htDefaultOption);this.option(htOption||{});this._elInput=jindo.$(sInputId);this._oTimer=new jindo.Timer();this._bIE=jindo.$Agent().navigator().ie;this._wfFocus=jindo.$Fn(this._onFocus,this);this._wfBlur=jindo.$Fn(this._onBlur,this);this._wfKeyEvent=jindo.$Fn(this._onKeyEvent,this);this._wfStartTimer=jindo.$Fn(this._startTimer,this);this._wfStopTimer=jindo.$Fn(this._stopTimer,this);if(this.option("bActivateOnload")){this.activate(true);}},getInput:function(){return this._elInput;},setInputValue:function(s){this.getInput().value=s;this.setCompareValue(s);return this;},getCompareValue:function(){return this._sPrevValue;},setCompareValue:function(s){this._sPrevValue=s;return this;},fireChangeEvent:function(){var elInput=this.getInput(),sValue=elInput.value;this.setCompareValue(sValue);this.fireEvent("change",{elInput:elInput,sText:sValue});return this;},start:function(bCompareOnce){return this.activate(bCompareOnce||false);},stop:function(){return this.deactivate();},_onActivate:function(bCompareOnce){this.setCompareValue("");var elInput=this.getInput();this._wfFocus.attach(elInput,"focus");if(this._bIE&&!this.option("bUseTimerOnIE")){this.fireEvent("start");this._wfKeyEvent.attach(elInput,this.option("sKeyEvent"));}else{if(this._isTimerRunning()){return;}
this.fireEvent("start");if(this.option("bPermanent")){this._startTimer();}else{this._wfStartTimer.attach(elInput,"focus");this._wfStopTimer.attach(elInput,"blur");}}
this._wfBlur.attach(elInput,"blur");if(bCompareOnce||false){this.compare();}},_onDeactivate:function(){var elInput=this.getInput();this._wfFocus.detach(elInput,"focus");this._wfKeyEvent.detach(elInput,this.option("sKeyEvent"));this._stopTimer();this._wfStartTimer.detach(elInput,"focus");this._wfStopTimer.detach(elInput,"blur");this._wfBlur.detach(elInput,"blur");this.fireEvent("stop");},getInterval:function(){return this.option("nInterval");},setInterval:function(n){this.option("nInterval",n);return this;},_isTimerRunning:function(){return this._bTimerRunning;},_startTimer:function(){if(this._isTimerRunning()){return;}
this._bTimerRunning=true;this.fireEvent("timerStart");this.compare();var self=this;this._oTimer.start(function(){self.compare();return true;},this.getInterval());},_stopTimer:function(){if(this._isTimerRunning()){this._oTimer.abort();this._bTimerRunning=false;this.compare();this.fireEvent("timerStop");}},_onKeyEvent:function(){this.compare();},_onFocus:function(){this._bFocused=true;this.fireEvent("focus");},_onBlur:function(){this._bFocused=false;this.fireEvent("blur");},compare:function(){if(this.getInput().value!=this.getCompareValue()){this.fireChangeEvent();}
return this;}}).extend(jindo.UIComponent);jindo.RolloverArea=jindo.$Class({$init:function(el,htOption){this.option({sClassName:"rollover",sClassPrefix:"rollover-",bCheckMouseDown:true,bActivateOnload:true,htStatus:{sOver:"over",sDown:"down"}});this.option(htOption||{});this._elArea=jindo.$(el);this._aOveredElements=[];this._aDownedElements=[];this._wfMouseOver=jindo.$Fn(this._onMouseOver,this);this._wfMouseOut=jindo.$Fn(this._onMouseOut,this);this._wfMouseDown=jindo.$Fn(this._onMouseDown,this);this._wfMouseUp=jindo.$Fn(this._onMouseUp,this);if(this.option("bActivateOnload")){this.activate();}},_addOvered:function(el){this._aOveredElements.push(el);},_removeOvered:function(el){this._aOveredElements.splice(jindo.$A(this._aOveredElements).indexOf(el),1);},_addStatus:function(el,sStatus){jindo.$Element(el).addClass(this.option('sClassPrefix')+sStatus);},_removeStatus:function(el,sStatus){jindo.$Element(el).removeClass(this.option('sClassPrefix')+sStatus);},_isInnerElement:function(elParent,elChild){return elParent===elChild?true:jindo.$Element(elParent).isParentOf(elChild);},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elArea).preventTapHighlight(true);this._wfMouseOver.attach(this._elArea,'mouseover');this._wfMouseOut.attach(this._elArea,'mouseout');if(this.option("bCheckMouseDown")){this._wfMouseDown.attach(this._elArea,'mousedown');this._wfMouseUp.attach(document,'mouseup');}},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elArea).preventTapHighlight(false);this._wfMouseOver.detach(this._elArea,'mouseover');this._wfMouseOut.detach(this._elArea,'mouseout');this._wfMouseDown.detach(this._elArea,'mousedown');this._wfMouseUp.detach(document,'mouseup');this._aOveredElements.length=0;this._aDownedElements.length=0;},_findRollover:function(el){var sClassName=this.option('sClassName');return jindo.$$.test(el,'.'+sClassName)?el:jindo.$$.getSingle('! .'+sClassName,el);},_onMouseOver:function(we){var el=we.element,elRelated=we.relatedElement,htParam;for(;(el=this._findRollover(el));el=el.parentNode){if(elRelated&&this._isInnerElement(el,elRelated)){continue;}
this._addOvered(el);htParam={element:el,htStatus:this.option("htStatus"),weEvent:we};if(this.fireEvent('over',htParam)){this._addStatus(htParam.element,htParam.htStatus.sOver);}}},_onMouseOut:function(we){var el=we.element,elRelated=we.relatedElement,htParam;for(;(el=this._findRollover(el));el=el.parentNode){if(elRelated&&this._isInnerElement(el,elRelated)){continue;}
this._removeOvered(el);htParam={element:el,htStatus:this.option("htStatus"),weEvent:we};if(this.fireEvent('out',htParam)){this._removeStatus(htParam.element,htParam.htStatus.sOver);}}},_onMouseDown:function(we){var el=we.element,htParam;while((el=this._findRollover(el))){htParam={element:el,htStatus:this.option("htStatus"),weEvent:we};this._aDownedElements.push(el);if(this.fireEvent('down',htParam)){this._addStatus(htParam.element,htParam.htStatus.sDown);}
el=el.parentNode;}},_onMouseUp:function(we){var el=we.element,aTargetElementDatas=[],aDownedElements=this._aDownedElements,htParam,elMouseDown,i;for(i=0;(elMouseDown=aDownedElements[i]);i++){aTargetElementDatas.push({element:elMouseDown,htStatus:this.option("htStatus"),weEvent:we});}
for(;(el=this._findRollover(el));el=el.parentNode){if(jindo.$A(aDownedElements).indexOf(el)>-1){continue;}
aTargetElementDatas.push({element:el,htStatus:this.option("htStatus"),weEvent:we});}
for(i=0;(htParam=aTargetElementDatas[i]);i++){if(this.fireEvent('up',htParam)){this._removeStatus(htParam.element,htParam.htStatus.sDown);}}
this._aDownedElements=[];}}).extend(jindo.UIComponent);jindo.Slider=jindo.$Class({_elTrack:null,_aThumbs:null,_aPoses:null,_htSwap:null,$init:function(el,oOptions){this.option({sClassPrefix:'slider-',bVertical:false,bJump:true,bDragOnTrack:true,fAdjustValue:null,nMinValue:0,nMaxValue:1,bActivateOnload:true});this.option(oOptions||{});if(!this.option('bVertical')){this._htSwap={y:'nY',x:'nX',clientX:'clientX',pageX:'pageX',offsetWidth:'offsetWidth',left:'left'};}else{this._htSwap={y:'nX',x:'nY',clientX:'clientY',pageX:'pageY',offsetWidth:'offsetHeight',left:'top'};}
this._elTrack=jindo.$(el);this._aThumbs=jindo.$$('.'+this.option('sClassPrefix')+'thumb',this._elTrack);this._sRand='S'+parseInt(Math.random()*100000000,10);jindo.$ElementList(this._aThumbs).addClass(this._sRand);this._aPoses=this.positions();this._onTrackMouseDownFn=jindo.$Fn(this._onTrackMouseDown,this);this._initDragArea();if(this.option("bActivateOnload")){this.activate();}},getTrack:function(){return this._elTrack;},getThumb:function(nIndex){return this._aThumbs[nIndex];},_initDragArea:function(){var self=this;var htSwap=this._htSwap;this._oDragArea=new jindo.DragArea(this._elTrack,{sClassName:this._sRand,bFlowOut:false}).attach({beforeDrag:function(oCustomEvent){var nIndex=self._getThumbIndex(oCustomEvent.elHandle);var htParam={nIndex:nIndex,nPos:oCustomEvent[htSwap.x],bJump:false};if(!self.fireEvent('beforeChange',htParam)){oCustomEvent.stop();return false;}
oCustomEvent[htSwap.x]=self._getAdjustedPos(nIndex,htParam.nPos);oCustomEvent[htSwap.y]=null;},drag:function(oCustomEvent){var nIndex=self._getThumbIndex(oCustomEvent.elHandle);var nPos=oCustomEvent[htSwap.x];if(nPos!=self._aPoses[nIndex]){self._aPoses[nIndex]=nPos;self._fireChangeEvent(nIndex);}}});},getDragArea:function(){return this._oDragArea;},_fireChangeEvent:function(nIndex){var nPos=this._getPosition(nIndex);this.fireEvent('change',{nIndex:nIndex,nPos:nPos,nValue:this._getValue(nIndex,nPos)});},_onActivate:function(){this.getDragArea().activate();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elTrack).preventTapHighlight(true);this._onTrackMouseDownFn.attach(this._elTrack,'mousedown');},_onDeactivate:function(){this.getDragArea().deactivate();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elTrack).preventTapHighlight(false);this._onTrackMouseDownFn.detach(this._elTrack,'mousedown');},_onTrackMouseDown:function(we){if(!this.option('bJump')){return;}
we.stop(jindo.$Event.CANCEL_DEFAULT);var nIndex=0;var htSwap=this._htSwap;var el=we.element;var sClass='.'+this.option('sClassPrefix')+'thumb';var bThumb=jindo.$$.test(el,sClass)||jindo.$$.getSingle('! '+sClass,el);if(bThumb){return;}
var nPos=we.pos()[htSwap.pageX];nPos-=jindo.$Element(this._elTrack).offset()[htSwap.left];var nMaxDistance=9999999;for(var i=0,oThumb;(oThumb=this._aThumbs[i]);i++){var nThumbPos=parseInt(jindo.$Element(oThumb).css(htSwap.left),10)||0;nThumbPos+=parseInt(oThumb[htSwap.offsetWidth]/2,10);var nDistance=Math.abs(nPos-nThumbPos);if(nDistance<nMaxDistance){nMaxDistance=nDistance;nIndex=i;}}
nPos-=parseInt(this._aThumbs[nIndex][htSwap.offsetWidth]/2,10);this.positions(nIndex,nPos);if(this.option("bDragOnTrack")){this.getDragArea().startDragging(this._aThumbs[nIndex]);}},_getTrackInfo:function(nIndex){var htSwap=this._htSwap;var oThumb=this._aThumbs[nIndex];var nThumbSize=oThumb[htSwap.offsetWidth];var nTrackSize=this._elTrack[htSwap.offsetWidth];var nMaxPos=nTrackSize-nThumbSize;var nMax=this.option('nMaxValue');var nMin=this.option('nMinValue');return{maxPos:nMaxPos,max:nMax,min:nMin};},_getValue:function(nIndex,nPos){if(typeof nPos=='undefined'){nPos=this._getPosition(nIndex);}
var oInfo=this._getTrackInfo(nIndex);var nValue=Math.min(Math.max(nPos*(oInfo.max-oInfo.min)/oInfo.maxPos+oInfo.min,oInfo.min),oInfo.max);var fAdjust=this.option('fAdjustValue');if(fAdjust){nValue=fAdjust.call(this,nValue);}
return nValue;},_getAdjustedPos:function(nIndex,nPos){var nAdjustedPos=nPos;var oInfo=this._getTrackInfo(nIndex);var fAdjust=this.option('fAdjustValue');if(fAdjust){var nValue=Math.min(Math.max(nAdjustedPos*(oInfo.max-oInfo.min)/oInfo.maxPos+oInfo.min,oInfo.min),oInfo.max);var nAfterValue=fAdjust.call(this,nValue);if(nValue!=nAfterValue){nAdjustedPos=oInfo.maxPos*(nAfterValue-oInfo.min)/(oInfo.max-oInfo.min);}}
nAdjustedPos=Math.max(nAdjustedPos,0);nAdjustedPos=Math.min(nAdjustedPos,oInfo.maxPos);return nAdjustedPos;},_getThumbIndex:function(oThumb){for(var i=0,len=this._aThumbs.length;i<len;i++){if(this._aThumbs[i]==oThumb){return i;}}
return-1;},_getPosition:function(nIndex){var sPos=jindo.$Element(this._aThumbs[nIndex]).css(this._htSwap.left);return(sPos=="auto")?0:parseInt(sPos,10);},_setPosition:function(nIndex,nPos){this._aPoses[nIndex]=nPos;jindo.$Element(this._aThumbs[nIndex]).css(this._htSwap.left,nPos+'px');},positions:function(nIndex,nPos,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
switch(arguments.length){case 0:var aPoses=[];jindo.$A(this._aThumbs).forEach(function(el,i){aPoses[i]=this._getPosition(i);},this);return aPoses;case 1:return this._getPosition(nIndex);default:if(bFireEvent){var htParam={nIndex:nIndex,nPos:nPos,bJump:true};if(this.fireEvent('beforeChange',htParam)){var nAfterPos=this._getAdjustedPos(nIndex,htParam.nPos);var bChanged=(nAfterPos!=this._aPoses[nIndex]);this._setPosition(nIndex,nAfterPos);if(bChanged){this._fireChangeEvent(nIndex);}}
return this;}
this._setPosition(nIndex,this._getAdjustedPos(nIndex,nPos));return this;}},values:function(nIndex,nValue,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
switch(arguments.length){case 0:var aValues=[];for(var i=0,len=this._aThumbs.length;i<len;i++){aValues[i]=this._getValue(i);}
return aValues;case 1:return this._getValue(nIndex,this.positions(nIndex));default:var oInfo=this._getTrackInfo(nIndex);this.positions(nIndex,((nValue-oInfo.min)*oInfo.maxPos/(oInfo.max-oInfo.min))||0,bFireEvent);return this;}}}).extend(jindo.UIComponent);jindo.RolloverClick=jindo.$Class({$init:function(el,htOption){this.option({bActivateOnload:true,sCheckEvent:"click",bCheckDblClick:false,RolloverArea:{sClassName:"rollover",sClassPrefix:"rollover-",bCheckMouseDown:false,bActivateOnload:false,htStatus:{sOver:"over",sDown:"down"}}});this.option(htOption||{});var self=this;this._oRolloverArea=new jindo.RolloverArea(el,this.option("RolloverArea")).attach({over:function(oCustomEvent){if(!self.fireEvent("over",oCustomEvent)){oCustomEvent.stop();}},out:function(oCustomEvent){if(!self.fireEvent("out",oCustomEvent)){oCustomEvent.stop();}}});this._wfClick=jindo.$Fn(this._onClick,this);this._wfDblClick=jindo.$Fn(this._onClick,this);if(this.option("bActivateOnload")){this.activate();}},_onClick:function(we){var elRollover=we.element,sType="click";if(we.type=="dblclick"){sType=we.type;}
while((elRollover=this._oRolloverArea._findRollover(elRollover))){this.fireEvent(sType,{element:elRollover,htStatus:this._oRolloverArea.option("htStatus"),weEvent:we});elRollover=elRollover.parentNode;}},_onActivate:function(){this._wfClick.attach(this._oRolloverArea._elArea,this.option("sCheckEvent"));if(this.option("bCheckDblClick")){this._wfDblClick.attach(this._oRolloverArea._elArea,'dblclick');}
this._oRolloverArea.activate();},_onDeactivate:function(){this._wfClick.detach(this._oRolloverArea._elArea,this.option("sCheckEvent"));this._wfDblClick.detach(this._oRolloverArea._elArea,'dblclick');this._oRolloverArea.deactivate();}}).extend(jindo.UIComponent);jindo.AjaxHistory=jindo.$Class({_htEventHandler:{},_htHistoryData:{},_oAgent:null,_welIFrame:null,_nIntervalId:0,_sCheckType:"",_sComponentId:"",$static:{checkIFrameChange:function(oLocation){var htQueryString=jindo.$S(oLocation.search.substring(1)).parseString();this.getInstance()[0]._checkLocationChange(encodeURIComponent(htQueryString.hash));}},$init:function(htOption){this._oAgent=jindo.$Agent().navigator();this._sComponentId="AjaxHistory"+(new Date()).getTime();this.option({sIFrameUrl:"history.html",nCheckInterval:100});this.option(htOption||{});},initialize:function(){var sHash=this._getLocationHash();if((this._oAgent.ie&&(document.documentMode||this._oAgent.version)>=8&&jindo.$Document().renderingMode()=="Standards")||(this._oAgent.firefox&&this._oAgent.version>=3.6)||(this._oAgent.chrome&&this._oAgent.version>3)||(this._oAgent.safari&&this._oAgent.version>=5)||(this._oAgent.opera&&this._oAgent.version>=10.6)){this._htEventHandler["hashchange"]=jindo.$Fn(this._checkLocationChange,this).attach(window,"hashchange");this._sCheckType="hashchangeevent";}else if(this._oAgent.ie){this._welIFrame=jindo.$Element("<IFRAME>");this._welIFrame.hide();this._welIFrame.appendTo(document.body);this._sCheckType="iframe";}else{this._nIntervalId=setInterval(jindo.$Fn(this._checkLocationChange,this).bind(),this.option("nCheckInterval"));this._sCheckType="setinterval";}
if(sHash&&sHash!="%7B%7D"){if(this._sCheckType=="iframe"){this._welIFrame.$value().src=this.option("sIFrameUrl")+"?hash="+sHash;}else{this._htHistoryData=this._getDecodedData(sHash);this.fireEvent("change",{htHistoryData:this._htHistoryData});}}else{var that=this;if(this._oAgent.ie&&(document.documentMode||this._oAgent.version)<8){var ifr=this._welIFrame.$value();ifr.onreadystatechange=function(){if(ifr.readyState=="complete"){that.fireEvent("load");ifr.onreadystatechange=function(){};}};ifr.src=this.option("sIFrameUrl");}else{setTimeout(function(){that.fireEvent("load");},0);}}
return this;},getComponentId:function(){return this._sComponentId;},_getLocationHash:function(){return this._oAgent.firefox?encodeURIComponent(location.hash.substring(1)):(location.hash.substring(1)||"%7B%7D");},_setLocationHash:function(sHash){location.hash=sHash=="%7B%7D"?"":sHash;},addHistory:function(htHistoryData){;if(htHistoryData&&typeof(htHistoryData)=="object"&&jindo.$H(htHistoryData).length()>0){this._htHistoryData=jindo.$Json(jindo.$Json(htHistoryData).toString()).toObject();var sHash=this._getEncodedData(htHistoryData);if(this._getLocationHash()!=sHash){this._setLocationHash(sHash);if(this._sCheckType=="iframe"){this._welIFrame.$value().src=this.option("sIFrameUrl")+"?hash="+sHash;}
return true;}else{return false;}}else{return false;}},_checkLocationChange:function(sHash){sHash=sHash=="undefined"?"%7B%7D":sHash;sHash=(sHash&&typeof(sHash)=="string")?sHash:this._getLocationHash();var htCurrentHistoryData=this._getDecodedData(sHash);if(!this._compareData(this._htHistoryData,htCurrentHistoryData)){this._htHistoryData=htCurrentHistoryData;if(this._sCheckType=="iframe"){this._setLocationHash(sHash);}
this.fireEvent("change",{htHistoryData:this._htHistoryData});}},_getEncodedData:function(htHistoryData){if(htHistoryData){if(typeof(JSON)=="object"&&typeof(JSON.stringify)=="function"){return encodeURIComponent(JSON.stringify(htHistoryData));}else{return encodeURIComponent(jindo.$Json(htHistoryData).toString());}}else{return"";}},_getDecodedData:function(sEncodedHash){try{if(sEncodedHash){var sHashString=decodeURIComponent(sEncodedHash);if(typeof(JSON)=="object"&&typeof(JSON.parse)=="function"){return JSON.parse(sHashString);}else{return jindo.$Json(sHashString).toObject();}}}catch(e){}
return{};},_compareData:function(htBase,htComparison){if(!htBase||!htComparison){return false;}
var wBase=htBase instanceof Array?jindo.$A(htBase):jindo.$H(htBase);var wComparison=htComparison instanceof Array?jindo.$A(htComparison):jindo.$H(htComparison);if(wBase.length()!=wComparison.length()){return false;}
var bRet=true;var fpCallee=arguments.callee;wBase.forEach(function(v,k){if(typeof(v)=="object"){if(!fpCallee(v,htComparison[k])){bRet=false;return;}}else{if(v!=htComparison[k]){bRet=false;return;}}});return bRet;},destroy:function(){if(this._sCheckType=="hashchangeevent"){this._htEventHandler["hashchange"].detach(window,"hashchange");}else if(this._sCheckType=="iframe"){this._welIFrame.leave();}else{clearInterval(this._nIntervalId);}
this._htEventHandler=null;this._htHistoryData=null;this._oAgent=null;this._welIFrame=null;this._nIntervalId=null;this._sCheckType=null;this._sComponentId=null;}}).extend(jindo.Component);jindo.BrowseButton=jindo.$Class({$init:function(el,htOption){this.option({sClassPrefix:'browse-'});this.option(htOption||{});this._el=jindo.$(el);this._assignHTMLElement();this._attachEvents();},_assignHTMLElement:function(){var sClassPrefix=this.option('sClassPrefix');this._elBox=jindo.$$.getSingle("."+sClassPrefix+"box",this._el);this._elFileSelect=jindo.$$.getSingle("."+sClassPrefix+"file-input",this._el);this._elBrowseButton=jindo.$$.getSingle("."+sClassPrefix+"button",this._el);this._elFileSelect.style.cssText="top:-.5em !important; height:500px !important;";jindo.$Element(this._elBrowseButton).addClass(sClassPrefix+'applied');},_adjustFileSelectPos:function(nX){this.getFileSelect().style.right=jindo.$Element(this.getBox()).offset().left+jindo.$Element(this.getBox()).width()-nX-20+'px';},_attachEvents:function(){var elBrowseButton=this.getBrowseButton(),welBrowseButton=jindo.$Element(elBrowseButton),elBox=this.getBox(),elFileSelect=this.getFileSelect(),wfHoverOnBrowseButton=jindo.$Fn(function(we){welBrowseButton.addClass(this.option('sClassPrefix')+'over');this.fireEvent('over');this._adjustFileSelectPos(we.pos().pageX);},this),wfRestore=jindo.$Fn(function(we){welBrowseButton.removeClass(this.option('sClassPrefix')+'over');elFileSelect.style.right="0px";this.fireEvent('out');},this),wfMouseMoveOnFloat=jindo.$Fn(function(we){this._adjustFileSelectPos(we.pos().pageX);},this);jindo.$Fn(function(we){this.fireEvent('sourceChange');},this).attach(this.getFileSelect(),'change');wfHoverOnBrowseButton.attach(elBox,'mouseover');wfMouseMoveOnFloat.attach(elBox,'mousemove');wfRestore.attach(elBox,'mouseout');},getBox:function(){return this._elBox;},getFileSelect:function(){return this._elFileSelect;},getBrowseButton:function(){return this._elBrowseButton;}}).extend(jindo.Component);jindo.Cache=jindo.$Class({$init:function(htOption){this._htCacheData={};this._htExpireTime={};this._waKeyList=jindo.$A();this.option({nCacheLimit:50,nExpireTime:0});this.option(htOption);},add:function(vKey,vValue,nExpireTime){if(vKey&&vValue){this._checkCacheExpire();this._checkCacheLimit();var sKey=this._makeKey(vKey);if(sKey){this._htCacheData[sKey]=vValue;this._htExpireTime[sKey]=this._getExpireTime(nExpireTime);this._waKeyList.push(sKey);return true;}}
return false;},remove:function(vKey){if(vKey){var sKey=this._makeKey(vKey);if(this._htCacheData[sKey]){this._waKeyList=this._waKeyList.refuse(sKey);delete this._htExpireTime[sKey];delete this._htCacheData[sKey];return true;}}
return false;},clear:function(){this._htCacheData={};this._htExpireTime={};this._waKeyList=jindo.$A();},get:function(vKey){if(vKey){var sKey=this._makeKey(vKey);if(this.check(vKey)){return this._htCacheData[sKey];}}
return null;},check:function(vKey){if(vKey){var sKey=this._makeKey(vKey);if(this._htCacheData[sKey]&&this._checkCacheExpire(sKey)){return true;}}
return false;},_checkCacheLimit:function(){if(this._waKeyList.length()==this.option("nCacheLimit")){this.remove(this._waKeyList.get(0));}},_checkCacheExpire:function(sKey){if(sKey){var nTime=this._getTime();if(this._htExpireTime[sKey]===0||nTime<this._htExpireTime[sKey]){return true;}else{this.remove(jindo.$S(sKey).parseString());return false;}}else{for(var i=0,n=this._waKeyList.length();i<n;i++){return this._checkCacheExpire(this._waKeyList.get(i));}}},_getExpireTime:function(nExpireTime){if(nExpireTime){return this._getTime()+(nExpireTime*1000);}else if(this.option("nExpireTime")){return this._getTime()+(this.option("nExpireTime")*1000);}else{return 0;}},_makeKey:function(vKey){if(vKey){if(typeof(vKey)=="string"){return vKey;}else{try{return jindo.$H(vKey).toQueryString();}catch(e){return"";}}}else{return"";}},_getTime:function(){return+new Date();},destroy:function(){this._waKeyList=null;this._htCacheData=null;this._htExpireTime=null;}}).extend(jindo.Component);jindo.Clipboard=jindo.$Class({_aElement:null,_aData:null,_elOvered:null,_bFailed:true,$init:function(sFlashURL){this._sFlashURL=sFlashURL;var oStatic=jindo.Clipboard;var sFlashUID=this._sUnique='S'+new Date().getTime()+parseInt(Math.random()*1000000000,10);if(typeof oStatic._callbacks=="undefined"){oStatic._callbacks={};}
oStatic._callbacks[this._sUnique]={click:jindo.$Fn(this._onFlashClick,this).bind(),mouseover:jindo.$Fn(this._onFlashMouseOver,this).bind(),mouseout:jindo.$Fn(this._onFlashMouseOut,this).bind(),mousedown:jindo.$Fn(this._onFlashMouseDown,this).bind(),mouseup:jindo.$Fn(this._onFlashMouseUp,this).bind(),load:jindo.$Fn(this._onFlashLoad,this).bind()};this._aElement=[];this._aData=[];this._agent=jindo.$Agent();this._initFlash();this._wfHandler=jindo.$Fn(function(we){this._initFlash();var el=we.element;var htPosition=jindo.$Element(el).offset();this._setFlashPosSize(htPosition.left,htPosition.top,el.offsetWidth,el.offsetHeight);this._setClipboard(el,this._getData(el));this._elOvered=el;},this);},_initFlash:function(){if(this._elDummy){return;}
var elDummy=this._elDummy=jindo.$('<div>');var sFlashUID=this._sUnique;elDummy.style.cssText='position:absolute !important; border:0 !important; padding:0 !important; margin:0 !important; overflow:visible !important; z-index:32000 !important;';document.body.insertBefore(elDummy,document.body.firstChild);if(this._agent.flash().version>=11&&this._agent.navigator().ie){this._sFlashURL+="?"+Math.floor(Math.random()*10000);}
var sFlashHtml=nhn.FlashObject.generateTag(this._sFlashURL,'CLIPBOARD'+sFlashUID,1,1,{flashVars:{sUniq:sFlashUID},wmode:'transparent'});sFlashHtml=sFlashHtml.replace(/style="position:relative !important;"/gi,'style="position:absolute !important; left:0 !important; top:0 !important; border:0 !important; padding:0 !important; margin:0 !important; overflow:visible !important;"');elDummy.innerHTML=sFlashHtml;jindo.$Fn(this._checkFailed,this).attach(elDummy,'click');},_getFlash:function(){return nhn.FlashObject.find('CLIPBOARD'+this._sUnique);},_setFlashPosSize:function(nLeft,nTop,nWidth,nHeight){var elDummy=this._elDummy;elDummy.style.left=nLeft+'px';elDummy.style.top=nTop+'px';var oFlash=this._getFlash();oFlash.width=nWidth;oFlash.height=nHeight;oFlash.style.width=nWidth+'px';oFlash.style.height=nHeight+'px';},setData:function(el,sData){el=jindo.$(el);var nIndex=jindo.$A(this._aElement).indexOf(el),bExist=nIndex!=-1;if(bExist&&(!sData||typeof sData=='undefined')){this._wfHandler.detach(el,'mousemove');this._aElement.splice(nIndex,1);this._aData.splice(nIndex,1);this._setFlashPosSize(0,0,1,1);return;}
if(!bExist){this._wfHandler.attach(el,'mousemove');this._aElement.push(el);this._aData.push(sData);}else{this._aData[nIndex]=sData;}
this._setClipboard(el,sData);},_getData:function(el){var nIndex=jindo.$A(this._aElement).indexOf(el);return this._aData[nIndex];},_setClipboard:function(el,sData){var oFlash=this._getFlash();var sCursor=(jindo.$Element(el).css('cursor')||'').toUpperCase();var bHandCursor=sCursor=='POINTER'||sCursor=='HAND';try{oFlash.setClipboardData(sData);oFlash.setClipboardOptions({cursor:bHandCursor?'pointer':'default'});this._sAppliedData=sData;this._bFailed=false;}catch(e){this._bFailed=true;}},_checkFailed:function(){if(this._bFailed){this.fireEvent('failure',{element:this._elOvered,data:this._lastestData});}},_onFlashClick:function(sData){this.fireEvent('copy',{element:this._elOvered,data:sData});},_onFlashMouseOver:function(){this.fireEvent('over',{element:this._elOvered});},_onFlashMouseOut:function(){this.fireEvent('out',{element:this._elOvered});},_onFlashMouseDown:function(){this.fireEvent('down',{element:this._elOvered});},_onFlashMouseUp:function(){this.fireEvent('up',{element:this._elOvered});},_onFlashLoad:function(){this.fireEvent('load');}}).extend(jindo.Component);jindo.ModalDialog=jindo.$Class({$init:function(htOption){var htDefaultOption={Foggy:{nShowDuration:150,nShowOpacity:0.8,nHideDuration:150,nHideOpacity:0,sEffect:"linear",nFPS:30}};this.option(htDefaultOption);this.option(htOption||{});this._initFoggy();},_initFoggy:function(){var self=this;this._oFoggy=new jindo.Foggy(this.option("Foggy")).attach({show:function(e){self.fireEvent("show",{elLayer:self._elLayer});},hide:function(){self.detachAll("close").detachAll("confirm").detachAll("cancel");self._detachEvents();self._welLayer.hide();self._welLayer.leave();self._bIsShown=false;self.fireEvent("hide",{elLayer:self._elLayer});}});this._oFoggy.getFog().className=this.option("sClassPrefix")+'fog';},getFoggy:function(){return this._oFoggy;},show:function(htTemplateProcess,htEventHandler){if(!this.isShown()){this.attach(htEventHandler);document.body.appendChild(this._elLayer);this._welLayer.html(this._template.process(htTemplateProcess));var htCustomEvent={elLayer:this._elLayer};if(this.fireEvent("beforeShow",htCustomEvent)){this._welLayer.show();this._attachEvents();this.getLayerPosition().setPosition();this._bIsShown=true;this._oFoggy.show(this._elLayer);}}},hide:function(){if(this.fireEvent("beforeHide",{elLayer:this._elLayer})){this._oFoggy.hide();}}}).extend(jindo.Dialog);jindo.DataBridge=jindo.$Class({_htEvent:{},$static:{log:function(sFlashId,sMessage){if(sFlashId&&sMessage){this.getComponentInstance(sFlashId)._onLog(sMessage);}else{alert("Parameter is wrong!!");}},onReceive:function(sFlashId,sSenderId,vData){if(sFlashId&&sSenderId&&vData){this.getComponentInstance(sFlashId)._onReceiveData(sSenderId,vData);}else{alert("Parameter is wrong!!");}},getComponentInstance:function(sFlashId){var aInstanceList=this.getInstance();for(var i=0;i<aInstanceList.length;i++){if(sFlashId==aInstanceList[i].getFlashObjectId()){return aInstanceList[i];}}}},$init:function(htOption){this.option({"sSwfPath":"data_bridge.swf","nRetryLimit":3});this.option(htOption);this._attachEvent();this._createFlashObject();},_attachEvent:function(){this._htEvent["beforeunload"]=jindo.$Fn(this.destroy,this).attach(window,"beforeunload");},_createFlashObject:function(){this._sFlashId='data_bridge_'+(new Date()).getMilliseconds()+Math.floor(Math.random()*100000);var welFlashContainer=jindo.$Element('<div style="position:absolute;top:-1000px;left:0px">');var sFlashVars="serviceId="+this.option("sServiceId")+"&logHandler=jindo.DataBridge.log&onReceiveHandler=jindo.DataBridge.onReceive&flashId="+this._sFlashId+"&retryLimit="+this.option("nRetryLimit");welFlashContainer.appendTo(document.body);welFlashContainer.html('<object id="'+this._sFlashId+'" width="1" height="1" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"><param name="flashvars" value="'+sFlashVars+'"><param name="movie" value="'+this.option("sSwfPath")+'"><param name = "allowScriptAccess" value = "always" /><embed name="'+this._sFlashId+'" src="'+this.option("sSwfPath")+'" flashvars="'+sFlashVars+'" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" width="1" height="1" allowScriptAccess="always" swLiveConnect="true"></embed></object>');},_getFlashObject:function(){return document[this._sFlashId]||jindo.$(this._sFlashId);},getFlashObjectId:function(){return this._sFlashId;},getClientId:function(){return this.option("sServiceId")+"_"+this._sFlashId;},send:function(vData){if(vData){try{this._getFlashObject().send(vData);}catch(e){alert("Flash object is not ready!!");}}else{alert("vData parameter is null!!");}
return this;},_onReceiveData:function(sSenderId,vData){this.fireEvent("receive",{"sSenderId":sSenderId,"vData":vData});},_onLog:function(sMessage){this.fireEvent("log",{"sMessage":sMessage});},_close:function(){this._getFlashObject().close();},_detachEvent:function(){this._htEvent["beforeunload"].detach(window,"beforeunload");},getLocalData:function(){},setLocalData:function(){},resetLocalData:function(){},destroy:function(){this._close();this._detachEvent();this._htEvent={};jindo.$Element(this._getFlashObject()).leave();}}).extend(jindo.Component);jindo.DropArea=jindo.$Class({$init:function(el,htOption){this._el=jindo.$(el);this._wel=jindo.$Element(this._el);this.option({sClassName:'droppable',oDragInstance:null});this.option(htOption||{});this._waOveredDroppableElement=jindo.$A([]);this._elHandle=null;this._elDragging=null;this._wfMouseMove=jindo.$Fn(this._onMouseMove,this);this._wfMouseOver=jindo.$Fn(this._onMouseOver,this);this._wfMouseOut=jindo.$Fn(this._onMouseOut,this);var oDrag=this.option('oDragInstance');if(oDrag){var self=this;oDrag.attach({handleDown:function(oCustomEvent){self._elHandle=oCustomEvent.elHandle;self._waOveredDroppableElement.empty();},dragStart:function(oCustomEvent){self._reCalculate();self.fireEvent(oCustomEvent.sType,oCustomEvent);self._wfMouseMove.attach(document,'mousemove');},drag:function(oCustomEvent){self._elDragging=oCustomEvent.elDrag;},dragEnd:function(oCustomEvent){var o={};for(var sKey in oCustomEvent){o[sKey]=oCustomEvent[sKey];}
o.aDrop=self.getOveredLists().concat();self._clearOveredDroppableElement(oCustomEvent.weEvent,oCustomEvent.bInterupted);self.fireEvent(oCustomEvent.sType,o);self._wfMouseMove.detach(document,'mousemove');},handleUp:function(oCustomEvent){self._elDragging=null;self._elHandle=null;}});}},_addOveredDroppableElement:function(elDroppable){if(this._waOveredDroppableElement.indexOf(elDroppable)==-1){this._waOveredDroppableElement.push(elDroppable);this.fireEvent('over',{elHandle:this._elHandle,elDrag:this._elDragging,elDrop:elDroppable});}},_fireMoveEvent:function(elDroppable,oRect,oPos,we){var nRatioX=(oPos.pageX-oRect.nLeft)/(oRect.nRight-oRect.nLeft);var nRatioY=(oPos.pageY-oRect.nTop)/(oRect.nBottom-oRect.nTop);this.fireEvent('move',{weEvent:we,elHandle:this._elHandle,elDrag:this._elDragging,elDrop:elDroppable,nRatioX:nRatioX,nRatioY:nRatioY});},_removeOveredDroppableElement:function(elDroppable){var nIndex=this._waOveredDroppableElement.indexOf(elDroppable);if(nIndex!=-1){this._waOveredDroppableElement.splice(nIndex,1);this.fireEvent('out',{elHandle:this._elHandle,elDrag:this._elDragging,elDrop:elDroppable});}},_clearOveredDroppableElement:function(weEvent,bInterupted){if(bInterupted){this._waOveredDroppableElement.empty();return;}
for(var elDroppable;(elDroppable=this._waOveredDroppableElement.$value()[0]);){this._waOveredDroppableElement.splice(0,1);this.fireEvent('drop',{weEvent:weEvent,elHandle:this._elHandle,elDrag:this._elDragging,elDrop:elDroppable});}},getOveredLists:function(){return this._waOveredDroppableElement?this._waOveredDroppableElement.$value():[];},_isChildOfDropArea:function(el){if(this._el===document||this._el===el){return true;}
return this._wel.isParentOf(el);},_findDroppableElement:function(el){if(!el)return null;var sClass='.'+this.option('sClassName');var elDroppable=jindo.$$.test(el,sClass)?el:jindo.$$.getSingle('! '+sClass,el);if(!this._isChildOfDropArea(el)){elDroppable=null;}
return elDroppable;},_isDragging:function(){var oDrag=this.option('oDragInstance');return(oDrag&&oDrag.isDragging());},_onMouseMove:function(we){if(this._isDragging()){var oPos=we.pos();if(we.element==this._elDragging||jindo.$Element(this._elDragging).isParentOf(we.element)){var aItem=this._aItem;var aItemRect=this._aItemRect;for(var i=0,htRect,el;((htRect=aItemRect[i])&&(el=aItem[i]));i++){if(htRect.nLeft<=oPos.pageX&&oPos.pageX<=htRect.nRight&&htRect.nTop<=oPos.pageY&&oPos.pageY<=htRect.nBottom){this._addOveredDroppableElement(el);this._fireMoveEvent(el,htRect,oPos,we);}else{this._removeOveredDroppableElement(el);}}}else{var elDroppable=this._findDroppableElement(we.element);if(this.elPrevMove&&this.elPrevMove!=elDroppable){this._removeOveredDroppableElement(this.elPrevMove);this.elPrevMove=null;}
if(elDroppable==we.element||(!elDroppable&&document.elementFromPoint)){elDroppable=this._findDroppableElement(document.elementFromPoint(oPos.pageX,oPos.pageY));}
if(!elDroppable){return;}
this.elPrevMove=elDroppable;this._addOveredDroppableElement(elDroppable);var htOffset=jindo.$Element(elDroppable).offset();var htArea={"nLeft":htOffset.left,"nTop":htOffset.top,"nRight":htOffset.left+elDroppable.offsetWidth,"nBottom":htOffset.top+elDroppable.offsetHeight};if(htArea.nLeft<=oPos.pageX&&oPos.pageX<=htArea.nRight&&htArea.nTop<=oPos.pageY&&oPos.pageY<=htArea.nBottom){this._fireMoveEvent(elDroppable,htArea,oPos,we);}}}},_onMouseOver:function(we){if(this._isDragging()){var elDroppable=this._findDroppableElement(we.element);if(elDroppable){this._addOveredDroppableElement(elDroppable);}}},_onMouseOut:function(we){if(this._isDragging()){var elDroppable=this._findDroppableElement(we.element);if(elDroppable&&we.relatedElement&&!jindo.$Element(we.relatedElement).isChildOf(we.element)){this._removeOveredDroppableElement(elDroppable);}}},_getRectInfo:function(el){var htOffset=jindo.$Element(el).offset();return{nLeft:htOffset.left,nTop:htOffset.top,nRight:htOffset.left+el.offsetWidth,nBottom:htOffset.top+el.offsetHeight};},_reCalculate:function(){var aItem=jindo.$$('.'+this.option('sClassName'),this._el);if(this._el.tagName&&jindo.$$.test(this._el,'.'+this.option('sClassName'))){aItem.push(this._el);}
this._aItem=aItem;this._aItemRect=[];for(var i=0,el;(el=aItem[i]);i++){this._aItemRect.push(this._getRectInfo(el));}}}).extend(jindo.Component);jindo.InlineTextEdit=jindo.$Class({_bIsEditing:false,$init:function(htOption){var htDefaultOption={elInput:jindo.$('<input type="text">'),bHandleBlur:true,bHandleKeyDown:true};this.option(htDefaultOption);this.option(htOption||{});this._wfBlur=jindo.$Fn(this._onBlur,this);this._wfKeyDown=jindo.$Fn(this._onKeyDown,this);},getTextInput:function(){return this._getTextInput().$value();},_getTextInput:function(){if(this._welInput&&this._welInput.$value()){return this._welInput;}else{return(this._welInput=jindo.$Element(this.option("elInput")));}},_resize:function(elFrom,elTo){var wel=jindo.$Element(elFrom);var welTo=jindo.$Element(elTo);welTo.width(wel.width()).height(wel.height());},isEditing:function(){return this._bIsEditing;},edit:function(el,elGetSizeFrom){var wel=jindo.$Element(el),welInput=this._getTextInput(),elInput=welInput.$value();this._welHidden=wel;wel.after(elInput);this._resize(elGetSizeFrom||el,elInput);wel.hide();elInput.value=wel.text();elInput.focus();this._bIsEditing=true;if(this.option("bHandleBlur")){this._wfBlur.attach(elInput,"blur");}
if(this.option("bHandleKeyDown")){this._wfKeyDown.attach(elInput,"keydown");}
return this;},apply:function(){if(this.isEditing()){var welInput=this._getTextInput(),elInput=welInput.$value(),sText=elInput.value,htCustomEvent={sText:sText,elInput:elInput,elText:this._welHidden.$value()};if(this._welHidden.text()!=sText&&this.fireEvent("beforeChange",htCustomEvent)){this._welHidden.text(htCustomEvent.sText).show();this._bIsEditing=false;this.fireEvent("change",htCustomEvent);}else{this._welHidden.show();}
this._wfBlur.detach(elInput,"blur").detach(elInput,"keydown");welInput.leave();}
return this;},cancel:function(){if(this.isEditing()){var welInput=this._getTextInput(),elInput=welInput.$value();this._welHidden.show();this._bIsEditing=false;this._wfBlur.detach(elInput,"blur").detach(elInput,"keydown");welInput.leave();}
return this;},_onBlur:function(we){this.apply();},_onKeyDown:function(we){switch(we.key().keyCode){case 27:this.cancel();break;case 13:if(this.getTextInput().tagName.toLowerCase()=="input"){this.apply();}
break;}}}).extend(jindo.Component);jindo.MultipleAjaxRequest=jindo.$Class({_bIsRequesting:false,$init:function(htOption){var htDefaultOption={sMode:"parallel"};this.option(htDefaultOption);this.option(htOption);},isRequesting:function(){return this._bIsRequesting;},request:function(aAjax,htMetaData){if(this.isRequesting()){return false;}
if(!(aAjax instanceof Array)){aAjax=[aAjax];}
if(typeof htMetaData=="undefined"){htMetaData={};}
this._htMetaData=htMetaData;switch(this.option("sMode")){case"parallel":this._parallelRequest(aAjax);break;case"serial":this._serialRequest(aAjax);break;default:return false;}
return true;},_fireEventStart:function(){this._bIsRequesting=true;if(this.fireEvent("start",{aAjax:this._aAjax,htMetaData:this._htMetaData})){return true;}else{this.abort();return false;}},_fireEventBeforeEachRequest:function(nIndex){if(this.fireEvent("beforeEachRequest",{oAjax:this._aAjax[nIndex],nIndex:nIndex})){return true;}else{this.abort();return false;}},_fireEventAfterEachResponse:function(nIndex){if(this.fireEvent("afterEachResponse",{oAjax:this._aAjax[nIndex],nIndex:nIndex})){return true;}else{this.abort();return false;}},_parallelRequest:function(aAjax){this._aAjaxData=aAjax;this._aAjax=[];this._aStatus=[];this._aStatus.length=aAjax.length;this._aResponse=[];if(this._fireEventStart()){var self=this;jindo.$A(this._aAjaxData).forEach(function(htAjax,i){var fParallelResponseHandler=function(oResponse){oResponse._constructor=self._aAjax[i];var nIndex=self._findAjaxObjectIndexOfResponse(oResponse._constructor);self._aResponse[nIndex]=oResponse;self._aStatus[nIndex]=true;if(self._fireEventAfterEachResponse(nIndex)){if(self._hasCompletedGotResponsesOfParallelResponses()){self._complete();}}};self._aAjax.push(jindo.$Ajax(htAjax.sUrl,htAjax.htOption));htAjax.htOption.onload=fParallelResponseHandler;htAjax.htOption.onerror=fParallelResponseHandler;htAjax.htOption.ontimeout=fParallelResponseHandler;self._aAjax[i].option(htAjax.htOption);if(self._fireEventBeforeEachRequest(i)){self._aAjax[i].request(htAjax.htParameter||{});}else{jindo.$A.Break();}});}},_findAjaxObjectIndexOfResponse:function(oAjax){return jindo.$A(this._aAjax).indexOf(oAjax);},_hasCompletedGotResponsesOfParallelResponses:function(){var bResult=true;jindo.$A(this._aStatus).forEach(function(bStatus){if(!bStatus){bResult=false;jindo.$A.Break();}});return bResult;},_serialRequest:function(aAjax){this._aAjaxData=aAjax;this._aAjax=[];this._aStatus=[];this._aStatus.length=aAjax.length;this._aResponse=[];var self=this;jindo.$A(this._aAjaxData).forEach(function(htAjax,i){var fSerialRequestHandler=function(e){e._constructor=self._aAjax[i];self._aResponse.push(e);self._serialRequestNext();};self._aAjax.push(jindo.$Ajax(htAjax.sUrl,htAjax.htOption));htAjax.htOption.onload=fSerialRequestHandler;htAjax.htOption.onerror=fSerialRequestHandler;htAjax.htOption.ontimeout=fSerialRequestHandler;self._aAjax[i].option(htAjax.htOption);});if(this._fireEventStart()){if(this._fireEventBeforeEachRequest(0)){this._aAjax[0].request(this._aAjaxData[0].htParameter||{});this._aStatus[0]=true;}}},_serialRequestNext:function(){var nIndex=-1;for(var i=0;i<this._aStatus.length;i++){if(!this._aStatus[i]){this._aStatus[i]=true;nIndex=i;break;}}
if(nIndex>0){if(this._fireEventAfterEachResponse(nIndex-1)){if(this._fireEventBeforeEachRequest(nIndex)){this._aAjax[nIndex].request(this._aAjaxData[nIndex].htParameter||{});}}}else if(nIndex==-1){if(this._fireEventAfterEachResponse(this._aStatus.length-1)){this._complete();}}},_reset:function(){this._aAjaxData.length=0;this._aAjax.length=0;this._aStatus.length=0;this._aResponse.length=0;this._htMetaData=null;delete this._aAjaxData;delete this._aAjax;delete this._aStatus;delete this._aResponse;delete this._htMetaData;this._bIsRequesting=false;},abort:function(){jindo.$A(this._aAjax).forEach(function(oAjax){oAjax.abort();});this._reset();},_complete:function(){var aResponse=this._aResponse.concat(),htMetaData={},sProp;for(sProp in this._htMetaData){htMetaData[sProp]=this._htMetaData[sProp];}
this._reset();this.fireEvent("complete",{aResponse:aResponse,htMetaData:htMetaData});}}).extend(jindo.Component);jindo.LayerEffect=jindo.$Class({$init:function(el){this.setLayer(el);var self=this;this._htTransitionGetterSetter={getter:function(sKey){return jindo.$Element(self._el)[sKey]();},setter:function(sKey,nValue){jindo.$Element(self._el)[sKey](parseFloat(nValue));}};},getLayer:function(){return this._el;},setLayer:function(el){this._el=jindo.$(el);this._wel=jindo.$Element(el);var elToMeasure=this._el.cloneNode(true);var welToMeasure=jindo.$Element(elToMeasure);welToMeasure.opacity(0);this._wel.after(welToMeasure);welToMeasure.show();this._sLayerCSSPosition=welToMeasure.css("position");var htOffset=welToMeasure.offset();welToMeasure.css({position:"absolute",top:"0px",left:"0px"});var htNewOffset=welToMeasure.offset();this._sLayerCSSLeft=htOffset.left-htNewOffset.left+"px";this._sLayerCSSTop=htOffset.top-htNewOffset.top+"px";this._sLayerBGColor=welToMeasure.css("backgroundColor");this._nLayerWidth=welToMeasure.width();this._nLayerHeight=welToMeasure.height();welToMeasure.width(this._nLayerWidth);welToMeasure.height(this._nLayerHeight);this._sLayerCSSWidth=welToMeasure.css("width");this._sLayerCSSHeight=welToMeasure.css("height");this._sLayerCSSOverflowX=this._wel.css("overflowX");this._sLayerCSSOverflowY=this._wel.css("overflowY");this._sLayerCSSFontSize=this._wel.css("fontSize");this._sLayerCSSFontSizeUnit=this._sLayerCSSFontSize.match(/^\-?[0-9\.]+(%|px|pt|em)?$/i)[1];welToMeasure.css({"overflow":"hidden","width":0,"height":0});this._nSlideMinWidth=welToMeasure.width()+1;this._nSlideMinHeight=welToMeasure.height()+1;welToMeasure.leave();return this;},_transform:function(){this._wel.css({"overflowX":"hidden","overflowY":"hidden"});},_restore:function(){this._wel.css({"position":this._sLayerCSSPosition,"overflowX":this._sLayerCSSOverflowX,"overflowY":this._sLayerCSSOverflowY});},_fireEventBefore:function(bTransform){if(bTransform){this._transform();}
return this.fireEvent("before",{elLayer:this.getLayer()});},_fireEventAppear:function(){this.fireEvent("appear",{elLayer:this.getLayer()});},_fireEventEnd:function(){this._restore();this.fireEvent("end",{elLayer:this.getLayer()});},_getTransition:function(){return(this._oTransition)?this._oTransition:this._oTransition=new jindo.Transition({bCorrection:true});},_afterHide:function(){this._wel.hide().opacity(1);this._wel.css({"top":this._sLayerCSSTop,"left":this._sLayerCSSLeft,"width":this._sLayerCSSWidth,"height":this._sLayerCSSHeight,"fontSize":this._sLayerCSSFontSize});},_onShowTransitionEnd:function(oCustomEvent){this._getTransition().detach("end",arguments.callee);this._fireEventEnd();},_onHideTransitionEnd:function(oCustomEvent){this._getTransition().detach("end",arguments.callee);this._afterHide();this._fireEventEnd();},_getOption:function(htDefault,ht){for(var s in ht){htDefault[s]=ht[s];}
return htDefault;},fadeIn:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible()&&this._wel.opacity()>0;if(bVisible){htOption.nDuration*=((1-this._wel.opacity())/1);}else{this._wel.opacity(0);this._wel.show();}
if(htOption.nDuration>0){this._fireEventBefore(true);var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({playing:function(oCustomEvent){if(oCustomEvent.nStep===1){this.detach("playing",arguments.callee);if(!bVisible){self._fireEventAppear();}}},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._wel.$value(),{"@opacity":jindo.Effect.linear(1)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}
return this;},fadeOut:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible()&&this._wel.opacity()>0;if(bVisible){this._fireEventBefore();htOption.nDuration*=(this._wel.opacity()/1);var oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._wel.$value(),{"@opacity":jindo.Effect.linear(0)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}
return this;},slideDown:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible();if(Math.ceil(this._wel.height())<this._nLayerHeight){if(this._fireEventBefore(true)){if(!bVisible){this._wel.css("height",0).show().height(this._nSlideMinHeight);}else{htOption.nDuration=Math.ceil(htOption.nDuration*((this._nLayerHeight-this._wel.height())/(this._nLayerHeight-this._nSlideMinHeight)));}
var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({playing:function(oCustomEvent){if(oCustomEvent.nStep===1){this.detach("playing",arguments.callee);if(!bVisible){self._fireEventAppear();}}},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nLayerHeight)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},slideUp:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible();if(bVisible){if(this._fireEventBefore(true)){htOption.nDuration=Math.ceil(htOption.nDuration*(this._wel.height()/this._nLayerHeight));var oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nSlideMinHeight)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},grow:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible();if(Math.ceil(this._wel.height())<this._nLayerHeight){if(this._fireEventBefore(true)){if(!bVisible){this._wel.css({width:0,height:0}).show().width(this._nSlideMinWidth).height(this._nSlideMinHeight);}else{htOption.nDuration=Math.ceil(htOption.nDuration*((this._nLayerHeight-this._wel.height())/(this._nLayerHeight-this._nSlideMinHeight)));}
var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({playing:function(oCustomEvent){if(oCustomEvent.nStep===1){this.detach("playing",arguments.callee);if(!bVisible){self._fireEventAppear();}}},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth),height:jindo.Effect.cubicEaseOut(this._nLayerHeight)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},shrink:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible();if(bVisible){if(this._fireEventBefore(true)){htOption.nDuration=Math.ceil(htOption.nDuration*(this._wel.height()/this._nLayerHeight));var oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nSlideMinWidth),height:jindo.Effect.cubicEaseOut(this._nSlideMinHeight)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},unfold:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,nWidth:this._nSlideMinWidth,nHeight:this._nSlideMinHeight},htOption||{});var bVisible=this._wel.visible(),nWidthDuration,nHeightDuration;if(!bVisible){this._wel.css({width:0,height:0}).show().width(Math.max(htOption.nWidth,this._nSlideMinWidth)).height(Math.max(htOption.nHeight,this._nSlideMinHeight));nWidthDuration=htOption.nDuration/2;nHeightDuration=nWidthDuration;}else{nWidthDuration=(htOption.nDuration/2)*(this._nLayerWidth-this._wel.width())/this._nLayerWidth;nHeightDuration=(htOption.nDuration/2)*(this._nLayerHeight-this._wel.height())/this._nLayerHeight;}
if(nHeightDuration>0){var self=this;if(this._fireEventBefore(true)){var oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({playing:function(oCustomEvent){if(oCustomEvent.nStep===1){this.detach("playing",arguments.callee);if(!bVisible){self._fireEventAppear();}}},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(nWidthDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth)}).queue(nHeightDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nLayerHeight)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},fold:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,nWidth:this._nSlideMinWidth,nHeight:this._nSlideMinHeight},htOption||{});var bVisible=this._wel.visible(),nWidthDuration,nHeightDuration;if(bVisible){nHeightDuration=(htOption.nDuration/2)*this._wel.height()/this._nLayerHeight;nWidthDuration=(htOption.nDuration/2)*this._wel.width()/this._nLayerWidth;if(nWidthDuration>0){if(this._fireEventBefore(true)){var oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(nHeightDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(Math.max(htOption.nHeight,this._nSlideMinHeight))}).queue(nWidthDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(Math.max(htOption.nWidth,this._nSlideMinWidth))});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}}
return this;},pullUp:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible();if(Math.ceil(this._wel.height())<this._nLayerHeight){if(this._fireEventBefore(true)){this._wel.css("position","absolute");if(!bVisible){this._wel.css({"height":0,"top":parseInt(this._sLayerCSSTop,10)+this._nLayerHeight-this._nSlideMinHeight+"px"}).show().height(this._nSlideMinHeight);}else{htOption.nDuration=Math.ceil(htOption.nDuration*((this._nLayerHeight-this._wel.height())/(this._nLayerHeight-this._nSlideMinHeight)));}
var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({playing:function(oCustomEvent){if(oCustomEvent.nStep===1){this.detach("playing",arguments.callee);if(!bVisible){self._fireEventAppear();}}},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).attach({playing:function(oCustomEvent){self._wel.css("top",parseInt(self._sLayerCSSTop,10)+self._nLayerHeight-self._wel.height()+"px");}}).queue(htOption.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nLayerHeight)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},pushDown:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500},htOption||{});var bVisible=this._wel.visible();if(bVisible){if(this._fireEventBefore(true)){this._wel.css("position","absolute");htOption.nDuration=Math.ceil(htOption.nDuration*(this._wel.height()/this._nLayerHeight));var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({playing:function(oCustomEvent){self._wel.css("top",parseInt(self._sLayerCSSTop,10)+self._nLayerHeight-self._wel.height()+"px");},end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nSlideMinHeight)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},condense:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,nScale:2},htOption||{});var bVisible=this._wel.visible()&&this._wel.opacity()>0;if(bVisible){htOption.nDuration*=((1-this._wel.opacity())/1);}else{this._wel.opacity(0);this._wel.show();this._wel.css({"left":(parseInt(this._sLayerCSSLeft,10)-(this._nLayerWidth/2))+"px","top":(parseInt(this._sLayerCSSTop,10)-(this._nLayerHeight/2))+"px","width":(parseInt(this._sLayerCSSWidth,10)*htOption.nScale)+"px","height":(parseInt(this._sLayerCSSHeight,10)*htOption.nScale)+"px","fontSize":(parseInt(this._sLayerCSSFontSize,10)*htOption.nScale)+this._sLayerCSSFontSizeUnit});}
if(htOption.nDuration>0){if(this._fireEventBefore(true)){this._wel.css("position","absolute");var self=this,elLayer=self.getLayer();var oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({playing:function(oCustomEvent){if(oCustomEvent.nStep===1){this.detach("playing",arguments.callee);if(!bVisible){self._fireEventAppear();}}},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth),height:jindo.Effect.cubicEaseOut(this._nLayerHeight)},elLayer,{"@left":jindo.Effect.cubicEaseOut(this._sLayerCSSLeft),"@top":jindo.Effect.cubicEaseOut(this._sLayerCSSTop),"@fontSize":jindo.Effect.cubicEaseOut(this._sLayerCSSFontSize),"@opacity":jindo.Effect.linear(1)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},expand:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,nScale:2},htOption||{});if(this._wel.visible()&&this._wel.opacity()>0){if(this._fireEventBefore(true)){htOption.nDuration*=((this._wel.opacity())/1);this._wel.css("position","absolute");if(this._wel.css("left")=="auto"){this._wel.css("left",this._sLayerCSSLeft);}
if(this._wel.css("top")=="auto"){this._wel.css("top",this._sLayerCSSTop);}
var oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(htOption.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth*htOption.nScale),height:jindo.Effect.cubicEaseOut(this._nLayerHeight*htOption.nScale)},this.getLayer(),{"@left":jindo.Effect.cubicEaseOut((parseInt(this._sLayerCSSLeft,10)-(parseInt(this._sLayerCSSWidth,10))/2+"px")),"@top":jindo.Effect.cubicEaseOut((parseInt(this._sLayerCSSTop,10)-(parseInt(this._sLayerCSSHeight,10))/2+"px")),"@fontSize":jindo.Effect.cubicEaseOut(parseInt(this._sLayerCSSFontSize,10)+this._sLayerCSSFontSizeUnit,parseInt(this._sLayerCSSFontSize,10)*2+this._sLayerCSSFontSizeUnit),"@opacity":jindo.Effect.linear(0)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},shake:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,nWidth:20,nCount:3},htOption||{});if(this._wel.visible()){if(this._fireEventBefore()){this._wel.css("position","absolute");var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){self._wel.css("left",this._sLayerCSSLeft);}}).queue(htOption.nDuration,this.getLayer(),{"@left":jindo.Effect.wave(htOption.nCount)(this._sLayerCSSLeft,htOption.nWidth+"px")});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},blink:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,nOpacity:0,nCount:1},htOption||{});if(this._wel.visible()){if(this._fireEventBefore()){var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){self._wel.opacity(1);}}).queue(htOption.nDuration,this.getLayer(),{"@opacity":jindo.Effect.wave(htOption.nCount)(1,htOption.nOpacity)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},flicker:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,sBackgroundColor:"#ffff00"},htOption||{});var sBackgroundFrom=(this._sLayerBGColor=="transparent"||this._sLayerBGColor=="rgba(0, 0, 0, 0)")?"#ffffff":this._sLayerBGColor;if(this._wel.visible()){if(this._fireEventBefore()){var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){self._wel.css("backgroundColor",self._sLayerBGColor);}}).queue(htOption.nDuration,this.getLayer(),{"@backgroundColor":jindo.Effect.cubicEaseIn(htOption.sBackgroundColor,sBackgroundFrom)}).queue(function(){self._wel.css("backgroundColor",self._sLayerBGColor);});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;},bounce:function(htOption){htOption=this._getOption({nFPS:30,nDuration:500,nHeight:50},htOption||{});if(this._wel.visible()){if(this._fireEventBefore()){this._wel.css("position","absolute");var self=this,oTransition=this._getTransition().fps(htOption.nFPS).abort().detachAll();oTransition.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){self._wel.css("top",self._sLayerCSSTop);}}).queue(htOption.nDuration/5,this.getLayer(),{"@top":jindo.Effect.easeOut(this._sLayerCSSTop,(parseInt(this._sLayerCSSTop,10)-htOption.nHeight)+"px")}).queue(htOption.nDuration/5*4,this.getLayer(),{"@top":jindo.Effect.bounce(this._sLayerCSSTop)});if(htOption.fCallback){oTransition.queue(jindo.$Fn(htOption.fCallback,this).bind(this));}
oTransition.start();}}
return this;}}).extend(jindo.Component);jindo.MouseGesture=jindo.$Class({_elCanvas:null,_oDC:null,_htEventHandler:{},_aPointList:[],_nPointCount:0,_sDrawingType:"",_bMobileSafari:false,$init:function(htOption){this.option({"sLineColor":"#FF0000","nLineThickness":5,"nFilteringDistance":10,"elTargetWindow":window});this.option(htOption);var sUserAgent=window.navigator.userAgent.toLowerCase();this._bMobileSafari=(/mobile/.test(sUserAgent)&&/safari/.test(sUserAgent))||/iphone/.test(sUserAgent);this._htEventHandler["mouse_down"]=jindo.$Fn(this._onMouseDown,this).attach(this.option("elTargetWindow").document,this._bMobileSafari?"touchstart":"mousedown",true);this._createCanvas();},_createCanvas:function(){if(jindo.$Agent().navigator().ie){if(!this.option("elTargetWindow").document.namespaces["vml_nhn"]){this.option("elTargetWindow").document.namespaces.add("vml_nhn","urn:schemas-microsoft-com:vml");}
var elStyle=this.option("elTargetWindow").document.createStyleSheet();elStyle.cssText="vml_nhn\\:shape, vml_nhn\\:stroke {behavior:url(#default#VML); display:inline-block; position:absolute;width:1px;height:1px;};";this._elCanvas=jindo.$("<div>");this._sDrawingType="vml";}else{this._elCanvas=jindo.$("<canvas>");this._oDC=this._elCanvas.getContext("2d");this._sDrawingType="canvas";this._oDC.globalCompositeOperation="destination-over";}
jindo.$Element(this._elCanvas).css({"position":"absolute","top":"0px","left":"0px"}).hide().appendTo(this.option("elTargetWindow").document.body);},_showCanvas:function(){var htDocumentSize=jindo.$Document(this.option("elTargetWindow").document).clientSize();var htScrollPosition=jindo.$Document(this.option("elTargetWindow").document).scrollPosition();if(this._sDrawingType=="canvas"){this._elCanvas.width=htDocumentSize.width;this._elCanvas.height=htDocumentSize.height;}
jindo.$Element(this._elCanvas).css({"top":htScrollPosition.top+"px","width":htDocumentSize.width+"px","height":htDocumentSize.height+"px","zIndex":999999}).show();},_hideCanvas:function(){if(this._elCanvas){if(this._sDrawingType=="vml"){this._elCanvas.innerHTML="";}else if(this._sDrawingType=="canvas"){this._oDC.beginPath();this._oDC.clearRect(0,0,this._elCanvas.offsetWidth,this._elCanvas.offsetHeight);this._oDC.closePath();}
jindo.$Element(this._elCanvas).hide();}},_drawLine:function(htStartPosition,htEndPosition){if(this._sDrawingType=="vml"){var sPath=" m "+(htStartPosition.nX*1-5)+","+(htStartPosition.nY*1-5)+" l "+(htEndPosition.nX*1-5)+","+(htEndPosition.nY*1-5);var sHTML='<vml_nhn:shape coordsize="1 1" strokeweight="'+this.option("nLineThickness")+'pt" strokecolor="'+this.option("sLineColor")+'" path="'+sPath+'"><vml_nhn:stroke endcap="round" /></vml_nhn:shape>';this._elCanvas.insertAdjacentHTML("BeforeEnd",sHTML);}else if(this._sDrawingType=="canvas"){this._oDC.save();this._oDC.beginPath();this._oDC.lineCap="round";this._oDC.lineWidth=this.option("nLineThickness")+2;this._oDC.strokeStyle=this.option("sLineColor");this._oDC.moveTo(htStartPosition.nX,htStartPosition.nY);this._oDC.lineTo(htEndPosition.nX,htEndPosition.nY);this._oDC.stroke();this._oDC.closePath();this._oDC.restore();}},_addPointList:function(weTarget){var htPosition;if(this._bMobileSafari){htPosition={"pageX":weTarget._event.targetTouches[0].clientX,"pageY":weTarget._event.targetTouches[0].clientY};}else{htPosition=weTarget.pos();}
var htResult={"nX":htPosition.clientX,"nY":htPosition.clientY};this._aPointList.push(htResult);this._nPointCount++;return htResult;},_onMouseDown:function(weMouseDown){if(weMouseDown.mouse().right||this._bMobileSafari){weMouseDown.stop();this._addPointList(weMouseDown);this._htEventHandler["mouse_move"]=jindo.$Fn(this._onMouseMove,this).attach(this.option("elTargetWindow").document,this._bMobileSafari?"touchmove":"mousemove");this._htEventHandler["mouse_up"]=jindo.$Fn(this._onMouseUp,this).attach(this.option("elTargetWindow").document,this._bMobileSafari?"touchend":"mouseup");if(this._sDrawingType=="vml"){this.option("elTargetWindow").document.body.setCapture();}}},_onMouseMove:function(weMouseMove){var htPosition=this._addPointList(weMouseMove);if(this._nPointCount===2){this._showCanvas();}
if(this._nPointCount%2){this._drawLine({"nX":this._aPointList[this._nPointCount-3]["nX"],"nY":this._aPointList[this._nPointCount-3]["nY"]},htPosition);}},_recognitionGesture:function(){var nX,nY,nBeforeX,nBeforeY,nGradient,nAbsGradient,nResult,nDistance;var aFilteredList=[],aResult=[];var nBaseGradient1=Math.tan(22.5*Math.PI/180);var nBaseGradient2=Math.tan(67.5*Math.PI/180);for(var i=1;i<this._aPointList.length;i++){nX=this._aPointList[i]["nX"];nY=this._aPointList[i]["nY"];nBeforeX=this._aPointList[i-1]["nX"];nBeforeY=this._aPointList[i-1]["nY"];nDistance=Math.sqrt(Math.pow(nY-nBeforeY,2)+Math.pow(nX-nBeforeX,2));if(nDistance>this.option("nFilteringDistance")){nGradient=-(nY-nBeforeY)/(nX-nBeforeX);nAbsGradient=Math.abs(nGradient);if(nAbsGradient>=nBaseGradient2){if(nY<nBeforeY){nResult=8;}else{nResult=4;}}else if(nAbsGradient<nBaseGradient1){if(nX<nBeforeX){nResult=6;}else{nResult=2;}}else if(nAbsGradient>=nBaseGradient1&&nAbsGradient<nBaseGradient2){if(nGradient>0){nResult=1;}else{nResult=3;}
if(nX<nBeforeX){nResult+=4;}}
aFilteredList.push(nResult);}}
for(i=1;i<aFilteredList.length;i++){if(aResult.length===0){aResult.push(aFilteredList[i]);}else{if(aResult[aResult.length-1]!=aFilteredList[i]){aResult.push(aFilteredList[i]);}}}
return{"aCodeList":aResult,"sCode":aResult.join("")};},_onMouseUp:function(weEvent){if(weEvent.mouse().right||this._bMobileSafari){weEvent.stop();if(this._htEventHandler["mouse_move"]){this._htEventHandler["mouse_move"].detach(this.option("elTargetWindow").document,this._bMobileSafari?"touchmove":"mousemove");}
if(this._htEventHandler["mouse_up"]){this._htEventHandler["mouse_up"].detach(this.option("elTargetWindow").document,this._bMobileSafari?"touchend":"mouseup");}
if(this._aPointList.length&&!this._bMobileSafari){this._htEventHandler["setted_context_menu"]=this.option("elTargetWindow").document.oncontextmenu;this.option("elTargetWindow").document.oncontextmenu=function(){return false;};setTimeout(jindo.$Fn(function(){this.option("elTargetWindow").document.oncontextmenu=this._htEventHandler["setted_context_menu"];},this).bind(),1);}
if(this._sDrawingType=="vml"){this.option("elTargetWindow").document.body.releaseCapture();}
var htResult=this._recognitionGesture();if(htResult.sCode){this.fireEvent("gesture",htResult);}
this._nPointCount=0;this._aPointList=[];this._hideCanvas();}},destroy:function(){jindo.$Element(this._elCanvas).leave();this._elCanvas=null;this._oDC=null;this._htEventHandler=null;this._nPointcount=null;this._aPointList=null;this._sDrawingType=null;this._bMobileSafari=null;}}).extend(jindo.Component);jindo.CircularRolling=jindo.$Class({$init:function(){this.refresh();},refresh:function(){this.getTransition().abort();this._el[this._oKeys.scrollLeft]=0;this._nDuplicateCount=0;this._nItemCount=this.getItems().length;this._nDisplayedCount=this.getDisplayedItemCount();if(this.isOverflowed()){this._nDuplicateCount=(this._nDisplayedCount<=(this._nItemCount/2))?1:2;this._duplicate(this._nDuplicateCount);}
return this;},_duplicate:function(n){var elList=this._elList,elDuplicatedList=jindo.$('<ul>'),sListInnerHTML=elList.innerHTML,aItem;for(var i=0;i<n;i++){elDuplicatedList.innerHTML=sListInnerHTML;aItem=jindo.$$('> li',elDuplicatedList);for(var j=0;j<aItem.length;j++){elList.appendChild(aItem[j]);}}},_setStartPosition:function(n,nTo){var oKeys=this._oKeys;var nNewPosition=n%(this._nItemCount)||0;if(n+nTo<0){var nTimes=this._nDuplicateCount;if(nNewPosition+this._nDisplayedCount>this._nItemCount){nTimes-=1;}
nNewPosition+=this._nItemCount*nTimes;}
this._el[oKeys.scrollLeft]=this._getPosition(nNewPosition);},moveBy:function(n){if(this.isMoving()){return false;}
var bBig=(n>=this._nItemCount);n=n%this._nItemCount;if(bBig){n+=this._nItemCount;}
this._setStartPosition(this.getIndex(),n);var nTarget=this.getIndex()+n;if(!this._move(nTarget)){return false;}
return true;}}).extend(jindo.Rolling);jindo.Accordion=jindo.$Class({$init:function(el,htOption){this._el=jindo.$(el);this._wel=jindo.$Element(this._el);this.option({sClassPrefix:"accordion-",sDirection:"vertical",sExpandEvent:"click",nDefaultIndex:null,bToggle:false,nDuration:300,nFPS:30,fExpandEffect:jindo.Effect.cubicEaseOut,fContractEffect:jindo.Effect.cubicEaseIn,nExpandDelay:0,nContractDelay:0,bActivateOnload:true});this.option(htOption||{});this._nExpanded=null;this._oTimer=new jindo.Timer();this._oTransition=new jindo.Transition({bCorrection:true}).fps(this.option("nFPS"));this._wfOnMouseOver=jindo.$Fn(this._onMouseOver,this);this._wfOnMouseOut=jindo.$Fn(this._onMouseOut,this);this._wfOnExpandEvent=jindo.$Fn(this._onExpandEvent,this);if(this.option("bActivateOnload")){this.activate();}},getBaseElement:function(){return this._el;},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(true);this._wfOnExpandEvent.attach(this._el,this.option("sExpandEvent"));this._wfOnMouseOver.attach(this._el,"mouseover");this._wfOnMouseOut.attach(this._el,"mouseout");var n=this.option("nDefaultIndex");if(typeof n=="number"){this.expand(n);}},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(false);this._wfOnExpandEvent.detach(this._el,this.option("sExpandEvent"));this._wfOnMouseOver.detach(this._el,"mouseover");this._wfOnMouseOut.detach(this._el,"mouseout");},_getBlock:function(el){var sClassPrefix=this.option("sClassPrefix");return(jindo.$Element(el).hasClass(sClassPrefix+"block"))?el:jindo.$$.getSingle("! ."+sClassPrefix+"block",el);},_onMouseOver:function(we){var el=we.element,elBlock=this._getBlock(el),nIndex=(elBlock)?jindo.$A(this.getAllBlocks()).indexOf(elBlock):null;if(typeof nIndex=="number"){var elHandler=this.getHandler(nIndex);if(elHandler===elBlock||el===elHandler||jindo.$Element(el).isChildOf(elHandler)){this.fireEvent(we.type,{nIndex:nIndex,elBlock:elBlock,elHandler:elHandler,weEvent:we});}}},_onExpandEvent:function(we){var el=we.element,elBlock=this._getBlock(el),nIndex=(elBlock)?jindo.$A(this.getAllBlocks()).indexOf(elBlock):null;if(typeof nIndex=="number"){var elHandler=this.getHandler(nIndex);if(elHandler===elBlock||el===elHandler||jindo.$Element(el).isChildOf(elHandler)){if(this.option("bToggle")&&this.getExpanded()===nIndex){this.contractAll();}else{this.expand(nIndex);}}}},_onMouseOut:function(we){var el=we.element,elBlock=this._getBlock(el),nIndex=(elBlock)?jindo.$Element(elBlock).parent().indexOf(elBlock):null;if(elBlock&&typeof nIndex=="number"){this.fireEvent(we.type,{nIndex:nIndex,elBlock:elBlock,elHandler:this.getHandler(nIndex),weEvent:we});}},_getHeadSize:function(n){var el=this.getHead(n);el.style.zoom=1;return{width:jindo.$Element(el).width(),height:jindo.$Element(el).height()};},_getBodySize:function(n){var el=this.getBody(n);el.style.zoom=1;return{width:jindo.$Element(el).width(),height:jindo.$Element(el).height()};},getTransition:function(){return this._oTransition;},expand:function(n){var aBlock=this.getAllBlocks(),self=this;n=Math.max(0,Math.min(aBlock.length,n));if(this.getExpanded()===n){return this;}
var ht={nIndex:n,elBlock:aBlock[n],elHandler:this.getHandler(n)};if(this.fireEvent("beforeExpand",ht)){var fEffect=self.option("fExpandEffect"),aArgs=[this.option("nDuration")];jindo.$A(aBlock).forEach(function(o,i,a){var aHeadSize=self._getHeadSize(i),aBodySize=self._getBodySize(i);switch(self.option("sDirection")){case"vertical":if(i==n){aArgs.push(a[i],{'@height':fEffect(aBodySize.height+aHeadSize.height+"px")});}else{aArgs.push(a[i],{'@height':fEffect(aHeadSize.height+"px")});}
break;case"horizontal":if(i==n){aArgs.push(a[i],{'@width':fEffect(aBodySize.width+aHeadSize.width+"px")});}else{aArgs.push(a[i],{'@width':fEffect(aHeadSize.width+"px")});}
break;}});this._oTimer.abort();this._oTimer.start(function(){self._setExpanded(n);self._oTransition.abort().queue.apply(self._oTransition,aArgs).start(function(){self.fireEvent("expand",ht);});},this.option("nExpandDelay"));}
return this;},expandAll:function(){return this;},contractAll:function(){var self=this,fEffect=self.option("fContractEffect"),aArgs=[this.option("nDuration")];jindo.$A(this.getAllBlocks()).forEach(function(o,i,a){var aHeadSize=self._getHeadSize(i);switch(self.option("sDirection")){case"vertical":aArgs.push(a[i],{'@height':fEffect(aHeadSize.height+"px")});break;case"horizontal":aArgs.push(a[i],{'@width':fEffect(aHeadSize.width+"px")});break;}});if(this.fireEvent("beforeContract")){this._oTimer.start(function(){self._setExpanded(null);self._oTransition.abort().queue.apply(self._oTransition,aArgs).start(function(){self.fireEvent("contract");});},this.option("nContractDelay"));}
return this;},_setExpanded:function(n){this._nExpanded=n;},getExpanded:function(){return this._nExpanded;},getBlock:function(n){return this.getAllBlocks()[n];},getAllBlocks:function(){return jindo.$$("."+this.option("sClassPrefix")+"block",this._el);},getHead:function(n){return jindo.$$.getSingle("dt",this.getBlock(n));},getBody:function(n){return jindo.$$.getSingle("dd",this.getBlock(n));},getHandler:function(n){var elHead=this.getHead(n);return jindo.$$.getSingle("."+this.option("sClassPrefix")+"handler",elHead)||elHead;}}).extend(jindo.UIComponent);jindo.DatePicker=jindo.$Class({_aDatePickerSet:null,_htSelectedDatePickerSet:null,$init:function(elCalendarLayer,htOption){var oDate=new Date();this.option({bUseLayerPosition:true,Calendar:{sClassPrefix:"calendar-",nYear:oDate.getFullYear(),nMonth:oDate.getMonth()+1,nDate:oDate.getDate(),sTitleFormat:"yyyy-mm",aMonthTitle:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]},LayerManager:{sCheckEvent:"click",nShowDelay:0,nHideDelay:0},LayerPosition:{sPosition:"outside-bottom",sAlign:"left",nTop:0,nLeft:0,bAuto:false}});this.option(htOption);this._aDatePickerSet=[];this._elCalendarLayer=jindo.$(elCalendarLayer);this._initCalendar();this._initLayerManager();this._initLayerPosition();this._wfFocusInput=jindo.$Fn(this._onFocusInput,this);this._wfClickLinkedElement=jindo.$Fn(this._onClickLinkedElement,this);this._wfMouseOverDate=jindo.$Fn(this._onMouseOverDate,this);this._wfMouseOutDate=jindo.$Fn(this._onMouseOutDate,this);this._wfClickDate=jindo.$Fn(this._onClickDate,this);this.activate();},addDatePickerSet:function(ht){var htOption=this.option(),htCalendarOption=this.getCalendar().option(),htDefaultOption={nYear:htCalendarOption.nYear,nMonth:htCalendarOption.nMonth,nDate:htCalendarOption.nDate,bDefaultSet:true,bReadOnly:true,sDateFormat:"yyyy-mm-dd",htSelectableDateFrom:{nYear:1900,nMonth:1,nDate:1},htSelectableDateTo:{nYear:2100,nMonth:12,nDate:31}};if(typeof ht.htOption!="undefined"){for(var value in ht.htOption){if(typeof htDefaultOption[value]!="undefined"){htDefaultOption[value]=ht.htOption[value];}}}
ht.htOption=htDefaultOption;this._aDatePickerSet.push(ht);var oLayerManager=this.getLayerManager();if(typeof ht.elInput!="undefined"){oLayerManager.link(ht.elInput);if(ht.htOption.bReadOnly){ht.elInput.readOnly=true;}
this._wfFocusInput.attach(ht.elInput,"focus");this._wfClickLinkedElement.attach(ht.elInput,"click");}
if(typeof ht.elButton!="undefined"){oLayerManager.link(ht.elButton);this._wfClickLinkedElement.attach(ht.elButton,"click");}
if(ht.htOption.bDefaultSet){this._setDate(ht,ht.htOption);}
return this;},removeDatePickerSet:function(ht){var nIndex=-1;for(var i=0,len=this._aDatePickerSet.length;i<len;i++){if(this._aDatePickerSet[i].elInput==ht.elInput||this._aDatePickerSet[i].elButton==ht.elButton){nIndex=i;break;}}
var htDatePickerSet=this._aDatePickerSet[nIndex];var oLayerManager=this.getLayerManager();if(typeof htDatePickerSet.elButton!="undefined"){oLayerManager.unlink(htDatePickerSet.elButton);this._wfClickLinkedElement.detach(htDatePickerSet.elButton,"click");}
if(typeof htDatePickerSet.elInput!="undefined"){this._wfFocusInput.detach(htDatePickerSet.elInput,"focus");this._wfClickLinkedElement.detach(htDatePickerSet.elInput,"click");htDatePickerSet.elInput.readOnly=false;}
if(htDatePickerSet==this._htSelectedDatePickerSet){this._htSelectedDatePickerSet=null;}
this._aDatePickerSet.splice(i,1);return this;},getDatePickerSet:function(el){if(typeof el=="undefined"){return this._aDatePickerSet;}
for(var i=0,len=this._aDatePickerSet.length;i<len;i++){if(this._aDatePickerSet[i].elInput==el||this._aDatePickerSet[i].elButton==el){return this._aDatePickerSet[i];}}
return false;},getCalendarLayer:function(){return this._elCalendarLayer;},_initCalendar:function(){var self=this;this._oCalendar=new jindo.Calendar(this.getCalendarLayer(),this.option("Calendar")).attach({beforeDraw:function(oCustomEvent){if(!self.fireEvent("beforeDraw",oCustomEvent)){oCustomEvent.stop();}},draw:function(oCustomEvent){var sClassPrefix=this.option("sClassPrefix");var oShowDatePickerSet=self._htSelectedDatePickerSet;if(self.isSelectable(oShowDatePickerSet,oCustomEvent)){oCustomEvent.bSelectable=true;if(jindo.Calendar.isSameDate(oCustomEvent,oShowDatePickerSet)){jindo.$Element(oCustomEvent.elDateContainer).addClass(sClassPrefix+"selected");}}else{oCustomEvent.bSelectable=false;jindo.$Element(oCustomEvent.elDateContainer).addClass(this.option("sClassPrefix")+"unselectable");}
if(!self.fireEvent("draw",oCustomEvent)){oCustomEvent.stop();}},afterDraw:function(oCustomEvent){self.fireEvent("afterDraw",oCustomEvent);}});},getCalendar:function(){return this._oCalendar;},_initLayerManager:function(){var self=this;var elCalendarLayer=this.getCalendarLayer();this._oLayerManager=new jindo.LayerManager(elCalendarLayer,this.option("LayerManager")).attach({show:function(){if(self._oTimerDatePickerSet){clearTimeout(self._oTimerDatePickerSet);self._oTimerDatePickerSet=null;}},hide:function(oCustomEvent){self._oTimerDatePickerSet=setTimeout(function(){self._htSelectedDatePickerSet=null;self._oTimerDatePickerSet=null;},0);}}).link(elCalendarLayer);},getLayerManager:function(){return this._oLayerManager;},_initLayerPosition:function(){if(this.option("bUseLayerPosition")){this._oLayerPosition=new jindo.LayerPosition(null,this.getCalendarLayer(),this.option("LayerPosition"));}},getLayerPosition:function(){return this._oLayerPosition;},getInput:function(htDatePickerSet){if(typeof htDatePickerSet!="undefined"){return htDatePickerSet.elInput||null;}
if(this._htSelectedDatePickerSet){return this._htSelectedDatePickerSet.elInput||null;}
return null;},getDate:function(htDatePickerSet){return{nYear:htDatePickerSet.nYear,nMonth:htDatePickerSet.nMonth,nDate:htDatePickerSet.nDate};},_setDate:function(htDatePickerSet,htDate){htDatePickerSet.nYear=htDate.nYear*1;htDatePickerSet.nMonth=htDate.nMonth*1;htDatePickerSet.nDate=htDate.nDate*1;if(typeof htDatePickerSet.elInput!="undefined"){htDatePickerSet.elInput.value=this._getDateFormat(htDatePickerSet,htDate);}},isSelectable:function(htDatePickerSet,htDate){return jindo.Calendar.isBetween(htDate,htDatePickerSet.htOption["htSelectableDateFrom"],htDatePickerSet.htOption["htSelectableDateTo"]);},setDate:function(htDatePickerSet,htDate){if(this.isSelectable(htDatePickerSet,htDate)){var sDateFormat=this._getDateFormat(htDatePickerSet,htDate);var htParam={"sText":sDateFormat,"nYear":htDate.nYear,"nMonth":htDate.nMonth,"nDate":htDate.nDate};if(this.fireEvent("beforeSelect",htParam)){this._setDate(htDatePickerSet,htDate);this.getLayerManager().hide();this.fireEvent("select",htParam);}
return true;}
return false;},_getDateFormat:function(htDatePickerSet,htDate){var nYear=htDate.nYear;var nMonth=htDate.nMonth;var nDate=htDate.nDate;if(nMonth<10){nMonth=("0"+(nMonth*1)).toString();}
if(nDate<10){nDate=("0"+(nDate*1)).toString();}
var sDateFormat=htDatePickerSet.htOption.sDateFormat;sDateFormat=sDateFormat.replace(/yyyy/g,nYear).replace(/y/g,(nYear).toString().substr(2,2)).replace(/mm/g,nMonth).replace(/m/g,(nMonth*1)).replace(/M/g,this.getCalendar().option("aMonthTitle")[nMonth-1]).replace(/dd/g,nDate).replace(/d/g,(nDate*1));return sDateFormat;},_linkOnly:function(htDatePickerSet){var oLayerManager=this.getLayerManager();oLayerManager.setLinks([this.getCalendarLayer()]);if(typeof htDatePickerSet.elInput!="undefined"){oLayerManager.link(htDatePickerSet.elInput);}
if(typeof htDatePickerSet.elButton!="undefined"){oLayerManager.link(htDatePickerSet.elButton);}},_onActivate:function(){var elCalendarLayer=this.getCalendarLayer();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(elCalendarLayer).preventTapHighlight(true);this._wfMouseOverDate.attach(elCalendarLayer,"mouseover");this._wfMouseOutDate.attach(elCalendarLayer,"mouseout");this._wfClickDate.attach(elCalendarLayer,"click");this.getLayerManager().activate();this.getCalendar().activate();},_onDeactivate:function(){var elCalendarLayer=this.getCalendarLayer();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(elCalendarLayer).preventTapHighlight(false);this._wfMouseOverDate.detach(elCalendarLayer,"mouseover");this._wfMouseOutDate.detach(elCalendarLayer,"mouseout");this._wfClickDate.detach(elCalendarLayer,"click").detach(elCalendarLayer,"mouseover").detach(elCalendarLayer,"mouseout");this.getLayerManager().deactivate();this.getCalendar().deactivate();},_onFocusInput:function(we){this.fireEvent("focus",{element:we.element});},_onClickLinkedElement:function(we){we.stop(jindo.$Event.CANCEL_DEFAULT);if(this.fireEvent("click",{element:we.element})){var htDatePickerSet=this.getDatePickerSet(we.currentElement);if(htDatePickerSet){this._htSelectedDatePickerSet=htDatePickerSet;this._linkOnly(htDatePickerSet);if(!htDatePickerSet.nYear){htDatePickerSet.nYear=htDatePickerSet.htOption.nYear;}
if(!htDatePickerSet.nMonth){htDatePickerSet.nMonth=htDatePickerSet.htOption.nMonth;}
if(!htDatePickerSet.nDate){htDatePickerSet.nDate=htDatePickerSet.htOption.nDate;}
var nYear=htDatePickerSet.nYear;var nMonth=htDatePickerSet.nMonth;this.getCalendar().draw(nYear,nMonth);this.getLayerManager().show();if(this.option("bUseLayerPosition")){if(typeof htDatePickerSet.elLayerPosition!="undefined"){this.getLayerPosition().setElement(htDatePickerSet.elLayerPosition).setPosition();}else{this.getLayerPosition().setElement(htDatePickerSet.elInput).setPosition();}}}}},_getTargetDateElement:function(el){var sClassPrefix=this.getCalendar().option("sClassPrefix");var elDate=(jindo.$Element(el).hasClass(sClassPrefix+"date"))?el:jindo.$$.getSingle("."+sClassPrefix+"date",el);if(elDate&&(elDate==el||elDate.length==1)){return elDate;}
return null;},_getTargetDateContainerElement:function(el){var sClassPrefix=this.getCalendar().option("sClassPrefix");var elWeek=jindo.$$.getSingle("! ."+sClassPrefix+"week",el);if(elWeek){var elReturn=el;while(!jindo.$Element(elReturn.parentNode).hasClass(sClassPrefix+"week")){elReturn=elReturn.parentNode;}
if(jindo.$Element(elReturn).hasClass(sClassPrefix+"unselectable")){return null;}
return elReturn;}else{return null;}},_setSelectedAgain:function(){if(this._elSelected){var sClassPrefix=this.getCalendar().option("sClassPrefix");jindo.$Element(this._elSelected).addClass(sClassPrefix+"selected");this._elSelected=null;}},_setAsideSelected:function(){if(!this._elSelected){var sClassPrefix=this.getCalendar().option("sClassPrefix");this._elSelected=jindo.$$.getSingle("."+sClassPrefix+"selected",this.elWeekAppendTarget);if(this._elSelected){jindo.$Element(this._elSelected).removeClass(sClassPrefix+"selected");}}},_onMouseOverDate:function(we){var sClassPrefix=this.getCalendar().option("sClassPrefix");var elDateContainer=this._getTargetDateContainerElement(we.element);if(elDateContainer){var htDate=this.getCalendar().getDateOfElement(elDateContainer);var htParam={element:we.element,nYear:htDate.nYear,nMonth:htDate.nMonth,nDate:htDate.nDate,bSelectable:false};if(this._htSelectedDatePickerSet&&this.isSelectable(this._htSelectedDatePickerSet,htDate)){this._setAsideSelected();jindo.$Element(elDateContainer).addClass(sClassPrefix+"over");htParam.bSelectable=true;}
this.fireEvent("mouseover",htParam);}},_onMouseOutDate:function(we){var sClassPrefix=this.getCalendar().option("sClassPrefix");var elDateContainer=this._getTargetDateContainerElement(we.element);if(elDateContainer){var htDate=this.getCalendar().getDateOfElement(elDateContainer);var htParam={element:we.element,nYear:htDate.nYear,nMonth:htDate.nMonth,nDate:htDate.nDate,bSelectable:false};if(this._htSelectedDatePickerSet&&this.isSelectable(this._htSelectedDatePickerSet,htDate)){jindo.$Element(elDateContainer).removeClass(sClassPrefix+"over");htParam.bSelectable=true;this._setSelectedAgain();}
this.fireEvent("mouseout",htParam);}else{this._setSelectedAgain();}},_onClickDate:function(we){we.stop(jindo.$Event.CANCEL_DEFAULT);var el=we.element;var elDate=this._getTargetDateElement(el);if(elDate){var elDateContainer=this._getTargetDateContainerElement(elDate);if(elDateContainer){var htDate=this.getCalendar().getDateOfElement(elDateContainer);if(this.isSelectable(this._htSelectedDatePickerSet,htDate)){this.setDate(this._htSelectedDatePickerSet,htDate);}}}}}).extend(jindo.UIComponent);jindo.DefaultTextValue=jindo.$Class({$init:function(el,htOption){this.option({sValue:"",bActivateOnload:true});this.option(htOption||{});this._elBaseTarget=jindo.$(el);this._wfOnFocusAndBlur=jindo.$Fn(this._onFocusAndBlur,this);if(this.option("bActivateOnload")){this.activate();}},getBaseElement:function(){return this._elBaseTarget;},setDefault:function(){this.getBaseElement().value=this.option("sValue");return this;},setDefaultValue:function(sValue){var sOldValue=this.option("sValue");this.option("sValue",sValue);if(this.getBaseElement().value==sOldValue){this.setDefault();}
return this;},getDefaultValue:function(){return this.option("sValue");},paint:function(){return this;},_onActivate:function(){var elInput=this.getBaseElement();if(elInput.value==""){this.setDefault();}
this._wfOnFocusAndBlur.attach(elInput,"focus").attach(elInput,"blur");},_onDeactivate:function(){var elInput=this.getBaseElement();this._wfOnFocusAndBlur.detach(elInput,"focus").detach(elInput,"blur");},_onFocusAndBlur:function(we){var el=this._elBaseTarget;var sValue=el.value;switch(we.type){case"focus":if(sValue.replace(/\r\n/g,"\n")==this.getDefaultValue()){el.value="";el.select();}
break;case"blur":if(jindo.$S(sValue).trim().$value()==""){this.setDefault();}
break;}}}).extend(jindo.UIComponent);jindo.FileUploader=jindo.$Class({_bIsActivating:false,_aHiddenInput:[],$init:function(elFileSelect,htOption){var htDefaultOption={sUrl:'',sCallback:'',htData:{},sFiletype:'*',sMsgNotAllowedExt:"업로드가 허용되지 않는 파일형식입니다",bAutoUpload:false,bAutoReset:true,bActivateOnload:true};this.option(htDefaultOption);this.option(htOption||{});this._el=jindo.$(elFileSelect);this._wel=jindo.$Element(this._el);this._elForm=this._el.form;this._aHiddenInput=[];this.constructor._oCallback={};this._wfChange=jindo.$Fn(this._onFileSelectChange,this);this._sFunctionName=null;if(this.option("bActivateOnload")){this.activate();}},_appendIframe:function(){var sIframeName='tmpFrame_'+this._makeUniqueId();this._welIframe=jindo.$Element(jindo.$('<iframe name="'+sIframeName+'" src="'+this.option("sCallback")+'?blank">')).css({position:'absolute',width:'1px',height:'1px',left:'-100px',top:'-100px'});document.body.appendChild(this._welIframe.$value());},_removeIframe:function(){if(this._welIframe){this._welIframe.leave();}},getBaseElement:function(){return this.getFileSelect();},getFileSelect:function(){return this._el;},getFormElement:function(){return this._elForm;},upload:function(){this._appendIframe();var elForm=this.getFormElement(),welForm=jindo.$Element(elForm),sIframeName=this._welIframe.attr("name"),sFunctionName=this._sFunctionName=sIframeName+'_func',sAction=this.option("sUrl");welForm.attr({target:sIframeName,action:sAction});this._aHiddenInput.push(this._createElement('input',{'type':'hidden','name':'callback','value':this.option("sCallback")}));this._aHiddenInput.push(this._createElement('input',{'type':'hidden','name':'callback_func','value':sFunctionName}));for(var k in this.option("htData")){this._aHiddenInput.push(this._createElement('input',{'type':'hidden','name':k,'value':this.option("htData")[k]}));}
for(var i=0;i<this._aHiddenInput.length;i++){elForm.appendChild(this._aHiddenInput[i]);}
this.constructor._oCallback[sFunctionName+'_success']=jindo.$Fn(function(oParameter){this.fireEvent("success",{htResult:oParameter});this._clear();},this).bind();this.constructor._oCallback[sFunctionName+'_error']=jindo.$Fn(function(oParameter){this.fireEvent("error",{htResult:oParameter});this._clear();},this).bind();elForm.submit();if(this.option("bAutoReset")){this.reset();}},reset:function(){var elWrapForm=jindo.$("<form>");this._wel.wrap(elWrapForm);elWrapForm.reset();jindo.$Element(elWrapForm).replace(this._el);var elForm=this.getFormElement(),welForm=jindo.$Element(elForm);welForm.attr({target:this._sPrevTarget,action:this._sAction});this._clear();return this;},_onActivate:function(){var elForm=this.getFormElement(),welForm=jindo.$Element(elForm);this._sPrevTarget=welForm.attr("target");this._sAction=welForm.attr("action");this._el.value="";this._wfChange.attach(this._el,"change");},_onDeactivate:function(){this._wfChange.detach(this._el,"change");},_makeUniqueId:function(){return new Date().getMilliseconds()+Math.floor(Math.random()*100000);},_createElement:function(name,attributes){var el=jindo.$("<"+name+">");var wel=jindo.$Element(el);for(var k in attributes){wel.attr(k,attributes[k]);}
return el;},_checkExtension:function(sFile){var aType=this.option("sFiletype").split(';');for(var i=0,sType;i<aType.length;i++){sType=(aType[i]=="*.*")?"*":aType[i];sType=sType.replace(/^\s+|\s+$/,'');sType=sType.replace(/\./g,'\\.');sType=sType.replace(/\*/g,'[^\\\/]+');if((new RegExp(sType+'$','gi')).test(sFile)){return true;}}
return false;},_onFileSelectChange:function(we){var sValue=we.element.value,bAllowed=this._checkExtension(sValue),htParam={sValue:sValue,bAllowed:bAllowed,sMsgNotAllowedExt:this.option("sMsgNotAllowedExt")};if(sValue.length&&this.fireEvent("select",htParam)){if(bAllowed){if(this.option("bAutoUpload")){this.upload();}}else{alert(htParam.sMsgNotAllowedExt);}}},_clear:function(){if(this._sFunctionName!=null){delete this.constructor._oCallback[this._sFunctionName+'_success'];delete this.constructor._oCallback[this._sFunctionName+'_error'];this._sFunctionName=null;}
for(var i=0,length=this._aHiddenInput.length;i<length;i++){jindo.$Element(this._aHiddenInput[i]).leave();}
this._aHiddenInput.length=0;this._removeIframe();}}).extend(jindo.UIComponent);jindo.FloatingLayer=jindo.$Class({$init:function(el,htOption){this._el=jindo.$(el);this._wel=jindo.$Element(el);this.option({nDelay:0,nDuration:500,fEffect:jindo.Effect.easeOut,bActivateOnload:true});this.option(htOption||{});this._htPos=this._getPosition();this._oTransition=new jindo.Transition().fps(60);this._oTimer=new jindo.Timer();this._wfScroll=jindo.$Fn(this._onScroll,this);if(this.option("bActivateOnload")){this.activate();}},getTransition:function(){return this._oTransition;},getTimer:function(){return this._oTimer;},_onActivate:function(){var self=this;setTimeout(function(){self._onScroll();},0);this._wfScroll.attach(window,'scroll').attach(window,'resize');},_onDeactivate:function(){this._wfScroll.detach(window,'scroll').detach(window,'resize');},_getPosition:function(){var el=this._el,wel=this._wel,sLeft=el.style.left,sRight=el.style.right,sTop=el.style.top,sBottom=el.style.bottom,htPos={sAlignX:sLeft?'left':(sRight?'right':null),sAlignY:sTop?'top':(sBottom?'bottom':null)},htOffset=wel.offset(),htClientSize=jindo.$Document().clientSize();switch(htPos.sAlignX){case"left":htPos.nX=htOffset.left;break;case"right":htPos.nX=Math.max(htClientSize.width-htOffset.left-wel.width(),parseFloat(sRight));break;}
switch(htPos.sAlignY){case"top":htPos.nY=htOffset.top;break;case"bottom":htPos.nY=Math.max(htClientSize.height-htOffset.top-wel.height(),parseFloat(sBottom));break;}
return htPos;},_onScroll:function(){var self=this;this._oTimer.start(function(){self._paint();},this.option('nDelay'));},_paint:function(){var oDoc=document.documentElement||document,elBody=document.body,el=this._el,wel=this._wel,htPos=this._htPos,htScrollPos={},htOffset=jindo.$Element(el).offset(),nPosX,nPosY,htParam={nX:null,nY:null};if(htPos.sAlignX){switch(htPos.sAlignX){case'left':htScrollPos.x=oDoc.scrollLeft||elBody.scrollLeft;nPosX=htOffset.left-htScrollPos.x;break;case'right':htScrollPos.x=(oDoc.scrollLeft||elBody.scrollLeft)+jindo.$Document().clientSize().width;nPosX=htScrollPos.x-(htOffset.left+wel.width());break;}
htParam.nX=parseFloat(wel.css(htPos.sAlignX))+(htPos.nX-nPosX);}
if(htPos.sAlignY){switch(htPos.sAlignY){case'top':htScrollPos.y=oDoc.scrollTop||elBody.scrollTop;nPosY=htOffset.top-htScrollPos.y;break;case'bottom':htScrollPos.y=(oDoc.scrollTop||elBody.scrollTop)+jindo.$Document().clientSize().height;nPosY=htScrollPos.y-(htOffset.top+wel.height());break;}
htParam.nY=parseFloat(wel.css(htPos.sAlignY))+(htPos.nY-nPosY);}
if(this.fireEvent('beforeMove',htParam)){var htTransition={},fEffect=this.option("fEffect");if(htParam.nX!==null){htTransition['@'+htPos.sAlignX]=fEffect(htParam.nX+'px');}
if(htParam.nY!==null){htTransition['@'+htPos.sAlignY]=fEffect(htParam.nY+'px');}
var self=this;this._oTransition.abort().start(this.option('nDuration'),el,htTransition).start(function(){self.fireEvent('move');});}}}).extend(jindo.UIComponent);jindo.NumberFormatter=jindo.$Class({$init:function(el,htOption){this.option({nDecimalPoint:0});this.option(htOption||{});this.attach('beforeChange',function(oCustomEvent){var sText=oCustomEvent.sText;var sOutput='';var nDecimalPoint=this.option("nDecimalPoint");if(nDecimalPoint===0){sText=sText.replace(new RegExp('[^0-9'+oCustomEvent.sStartMark+oCustomEvent.sEndMark+']','g'),'');sText=sText.replace(/^0+/,'');sText=sText.replace(new RegExp('^0*'+oCustomEvent.sStartMark+'0*'+oCustomEvent.sEndMark+'0*'),oCustomEvent.startMark+oCustomEvent.endMark);}else{sText=sText.replace(new RegExp('[^0-9\.'+oCustomEvent.sStartMark+oCustomEvent.sEndMark+']','g'),'');sText=sText.replace(/\.{2,}/g,".");sText=sText.replace(/^\.+/,'');sText=sText.replace(/(\.[^.]*?)(\.)/g,function(){return arguments[1];});sText=sText.replace(/^0+/,'');sText=sText.replace(new RegExp('^0*'+oCustomEvent.sStartMark+'0*'+oCustomEvent.sEndMark+'0*'),oCustomEvent.startMark+oCustomEvent.endMark);sText=sText.replace(new RegExp("^0([^\."+oCustomEvent.sStartMark+oCustomEvent.sEndMark+"]+?)","g"),function(){return arguments[1];});}
sOutput=this._convertCurrency(sText);if(nDecimalPoint>0){sOutput=this._limitDecimalPoint(sOutput,nDecimalPoint);}
oCustomEvent.sText=sOutput;});},getValue:function(){return this._el.value.replace(new RegExp("[,"+this._aMarks[0]+this._aMarks[1]+"]+?","g"),"");},_convertCurrency:function(sText){var nDot=0,sReturn="",nDotPosition=sText.indexOf("."),nLastPosition=sText.length;if(nDotPosition>-1){nLastPosition=nDotPosition-1;}
for(var i=sText.length;i>=0;i--){var sChar=sText.charAt(i);if(i>nLastPosition){sReturn=sChar+sReturn;continue;}
if(/[0-9]/.test(sChar)){if(nDot>=3){sReturn=','+sReturn;nDot=0;}
nDot++;sReturn=sChar+sReturn;}else if(sChar==this._aMarks[0]||sChar==this._aMarks[1]){sReturn=sChar+sReturn;}}
return sReturn;},_limitDecimalPoint:function(sText,nDecimalPoint){var sReturn="",nDotPosition=sText.indexOf("."),nLastPosition=sText.length;if(nDotPosition>-1){nLastPosition=nDotPosition-1;}
nDotPosition=sText.indexOf(".");if(nDotPosition>-1&&nDecimalPoint>0){var nDecimalCount=0;for(var i=0;i<sText.length;i++){var sChar=sText.charAt(i),bIsNumber=/[0-9]/.test(sChar);if(bIsNumber){if(nDecimalCount==nDecimalPoint){continue;}
if(i>nDotPosition){nDecimalCount++;}}
sReturn+=sChar;}}else{sReturn=sText;}
return sReturn;}}).extend(jindo.Formatter);jindo.NumericStepper=jindo.$Class({_bIsOnFocus:false,$init:function(el,htOption){this._el=jindo.$(el);this.option({sClassPrefix:'ns-',bActivateOnload:true,bUseMouseWheel:false,nStep:1,nDecimalPoint:0,nMin:-Infinity,nMax:Infinity,nDefaultValue:0,bInputReadOnly:true});this.option(htOption||{});this._assignHTMLElements();this._wfPlusClick=jindo.$Fn(this._onPlusClick,this);this._wfMinusClick=jindo.$Fn(this._onMinusClick,this);this._wfWheel=jindo.$Fn(this._onWheel,this);this._wfFocus=jindo.$Fn(this._onFocus,this);this._wfBlur=jindo.$Fn(this._onBlur,this);if(this.option("bActivateOnload")){this.activate();}},_assignHTMLElements:function(){var sPrefix=this.option("sClassPrefix");this._elInput=jindo.$$.getSingle("."+sPrefix+"input",this._el);this._elPlusButton=jindo.$$.getSingle("."+sPrefix+"plus",this._el);this._elMinusButton=jindo.$$.getSingle("."+sPrefix+"minus",this._el);},reset:function(){this._elInput.value=this.option("nDefaultValue").toFixed(this.option("nDecimalPoint"));},getValue:function(){return parseFloat(this._elInput.value);},setValue:function(n){if(isNaN(n)){this._elInput.value=this.option("nDefaultValue");return;}
n=n.toFixed(this.option("nDecimalPoint"));var nMin=this.option("nMin"),nMax=this.option("nMax"),htParam={"nValue":n,"nMin":nMin,"nMax":nMax};if(n>nMax||n<nMin){this.fireEvent("overLimit",htParam);this._elInput.value=Math.max(nMin,Math.min(nMax,n));return;}
if(!this.fireEvent("beforeChange",htParam)){return;}
this._elInput.value=htParam.nValue;this.fireEvent("change",htParam);},getBaseElement:function(){return this._el;},getInputElement:function(){return this._elInput;},getPlusElement:function(){return this._elPlusButton;},getMinusElement:function(){return this._elMinusButton;},isFocused:function(){return this._bIsOnFocus;},_onActivate:function(){var elInput=this.getInputElement();this._wfPlusClick.attach(this.getPlusElement(),"click");this._wfMinusClick.attach(this.getMinusElement(),"click");this._wfFocus.attach(elInput,"focus");this._wfBlur.attach(elInput,"blur");if(this.option("bUseMouseWheel")){this._wfWheel.attach(elInput,"mousewheel");}
this._elInput.readOnly=this.option("bInputReadOnly");this.reset();},_onDeactivate:function(){var elInput=this.getInputElement();this._wfPlusClick.detach(this.getPlusElement(),"click");this._wfMinusClick.detach(this.getMinusElement(),"click");this._wfFocus.detach(elInput,"focus");this._wfBlur.detach(elInput,"blur");this._wfWheel.detach(elInput,"mousewheel");},_onMinusClick:function(we){this.setValue(this.getValue()-this.option("nStep"));},_onPlusClick:function(we){this.setValue(this.getValue()+this.option("nStep"));},_onWheel:function(we){if(this.isFocused()){we.stop(jindo.$Event.CANCEL_DEFAULT);if(we.mouse().delta>0){this._onPlusClick();}else{this._onMinusClick();}}},_onFocus:function(we){this._bIsOnFocus=true;},_onBlur:function(we){this._bIsOnFocus=false;this.setValue(this.getValue());this._elInput.readOnly=this.option("bInputReadOnly");}}).extend(jindo.UIComponent);jindo.Pagination=jindo.$Class({$init:function(sId,htOption){this._elPageList=jindo.$(sId);this._welPageList=jindo.$Element(this._elPageList);this._waPage=jindo.$A([]);this._fClickPage=jindo.$Fn(this._onClickPageList,this);this.option({bActivateOnload:true,nItem:10,nItemPerPage:10,nPagePerPageList:10,nPage:1,sMoveUnit:"pagelist",bAlignCenter:false,sInsertTextNode:"",sClassPrefix:"",sClassFirst:"first-child",sClassLast:"last-child",sPageTemplate:"<a href='#'>{=page}</a>",sCurrentPageTemplate:"<strong>{=page}</strong>",elFirstPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("pre_end"),this._elPageList),elPrevPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("pre"),this._elPageList),elNextPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("next"),this._elPageList),elLastPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("next_end"),this._elPageList),elFirstPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("pre_end"),this._elPageList),elPrevPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("pre"),this._elPageList),elNextPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("next"),this._elPageList),elLastPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("next_end"),this._elPageList)});this.option(htOption||{});if(this.option("bActivateOnload")){this.activate();}},option:function(sName,vValue){var oThis=jindo.Component.prototype.option.apply(this,arguments);if(typeof sName==='object'||typeof vValue!='undefined'){var sMoveUnit=this.option('sMoveUnit');var bAlignCenter=this.option('bAlignCenter');if(bAlignCenter&&sMoveUnit==='pageunit'){throw new Error('Invalid Option : sMoveUnit can\'t be set to "pageunit" when bAlignCenter is true.');}}
return oThis;},_wrapPrefix:function(sClassName){var sClassPrefix=this.option('sClassPrefix');return sClassPrefix?sClassPrefix+sClassName.replace(/_/g,'-'):sClassName;},getBaseElement:function(){return this._elPageList;},getItemCount:function(){return this.option("nItem");},setItemCount:function(n){this.option({"nItem":n});},getItemPerPage:function(){return this.option("nItemPerPage");},setItemPerPage:function(n){this.option("nItemPerPage",n);},getCurrentPage:function(){return this._nCurrentPage;},getFirstItemOfPage:function(n){return this.getItemPerPage()*(n-1)+1;},getPageOfItem:function(n){return Math.ceil(n/this.getItemPerPage());},_getLastPage:function(){return Math.ceil(this.getItemCount()/this.getItemPerPage());},_getRelativePage:function(sRelative){var nPage=null;var bMovePage=this.option("sMoveUnit")=="page";var nThisPageList=this._getPageList(this.getCurrentPage());switch(sRelative){case"pre_end":nPage=1;break;case"next_end":nPage=this._getLastPage();break;case"pre":nPage=bMovePage?this.getCurrentPage()-1:(nThisPageList-1)*this.option("nPagePerPageList");break;case"next":nPage=bMovePage?this.getCurrentPage()+1:(nThisPageList)*this.option("nPagePerPageList")+1;break;}
return nPage;},_getPageList:function(nThisPage){if(this.option("bAlignCenter")){var nLeft=Math.floor(this.option("nPagePerPageList")/2);var nPageList=nThisPage-nLeft;nPageList=Math.max(nPageList,1);nPageList=Math.min(nPageList,this._getLastPage());return nPageList;}
return Math.ceil(nThisPage/this.option("nPagePerPageList"));},_isIn:function(el,elParent){if(!elParent){return false;}
return(el===elParent)?true:jindo.$Element(el).isChildOf(elParent);},_getPageElement:function(el){for(var i=0,nLength=this._waPage.$value().length;i<nLength;i++){var elPage=this._waPage.get(i);if(this._isIn(el,elPage)){return elPage;}}
return null;},_onClickPageList:function(we){we.stop(jindo.$Event.CANCEL_DEFAULT);var nPage=null,htOption=this.option(),el=we.element;if(this._isIn(el,htOption.elFirstPageLinkOn)){nPage=this._getRelativePage("pre_end");}else if(this._isIn(el,htOption.elPrevPageLinkOn)){nPage=this._getRelativePage("pre");}else if(this._isIn(el,htOption.elNextPageLinkOn)){nPage=this._getRelativePage("next");}else if(this._isIn(el,htOption.elLastPageLinkOn)){nPage=this._getRelativePage("next_end");}else{var elPage=this._getPageElement(el);if(elPage){nPage=parseInt(jindo.$Element(elPage).text(),10);}else{return;}}
if(!this.fireEvent("click",{nPage:nPage,weEvent:we})){return;}
this.movePageTo(nPage);},_convertToAvailPage:function(nPage){var nLastPage=this._getLastPage();nPage=Math.max(nPage,1);nPage=Math.min(nPage,nLastPage);return nPage;},movePageTo:function(nPage,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
nPage=this._convertToAvailPage(nPage);this._nCurrentPage=nPage;if(bFireEvent){if(!this.fireEvent("beforeMove",{nPage:nPage})){return;}}
this._paginate(nPage);if(bFireEvent){this.fireEvent("move",{nPage:nPage});}},reset:function(nItemCount){if(typeof nItemCount=="undefined"){nItemCount=this.option("nItem");}
this.setItemCount(nItemCount);this.movePageTo(1,false);},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._welPageList.preventTapHighlight(true);this._fClickPage.attach(this._elPageList,"click");this.setItemCount(this.option("nItem"));this.movePageTo(this.option("nPage"),false);this._welPageList.addClass(this._wrapPrefix("loaded"));},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._welPageList.preventTapHighlight(false);this._fClickPage.detach(this._elPageList,"click");this._welPageList.removeClass(this._wrapPrefix("loaded"));},_addTextNode:function(){var sTextNode=this.option("sInsertTextNode");this._elPageList.appendChild(document.createTextNode(sTextNode));},_paginate:function(nPage){this._empty();this._addTextNode();var htOption=this.option(),elFirstPageLinkOn=htOption.elFirstPageLinkOn,elPrevPageLinkOn=htOption.elPrevPageLinkOn,elNextPageLinkOn=htOption.elNextPageLinkOn,elLastPageLinkOn=htOption.elLastPageLinkOn,elFirstPageLinkOff=htOption.elFirstPageLinkOff,elPrevPageLinkOff=htOption.elPrevPageLinkOff,elNextPageLinkOff=htOption.elNextPageLinkOff,elLastPageLinkOff=htOption.elLastPageLinkOff,nLastPage=this._getLastPage(),nThisPageList=this._getPageList(nPage),nLastPageList=this._getPageList(nLastPage);if(nLastPage===0){this._welPageList.addClass(this._wrapPrefix("no-result"));}else if(nLastPage==1){this._welPageList.addClass(this._wrapPrefix("only-one")).removeClass(this._wrapPrefix("no-result"));}else{this._welPageList.removeClass(this._wrapPrefix("only-one")).removeClass(this._wrapPrefix("no-result"));}
var nFirstPageOfThisPageList,nLastPageOfThisPageList;if(htOption.bAlignCenter){var nLeft=Math.floor(htOption.nPagePerPageList/2);nFirstPageOfThisPageList=nPage-nLeft;nFirstPageOfThisPageList=Math.max(nFirstPageOfThisPageList,1);nLastPageOfThisPageList=nFirstPageOfThisPageList+htOption.nPagePerPageList-1;if(nLastPageOfThisPageList>nLastPage){nFirstPageOfThisPageList=nLastPage-htOption.nPagePerPageList+1;nFirstPageOfThisPageList=Math.max(nFirstPageOfThisPageList,1);nLastPageOfThisPageList=nLastPage;}}else{nFirstPageOfThisPageList=(nThisPageList-1)*htOption.nPagePerPageList+1;nLastPageOfThisPageList=(nThisPageList)*htOption.nPagePerPageList;nLastPageOfThisPageList=Math.min(nLastPageOfThisPageList,nLastPage);}
if(htOption.sMoveUnit=="page"){nThisPageList=nPage;nLastPageList=nLastPage;}
if(nPage>1){if(elFirstPageLinkOn){this._welPageList.append(elFirstPageLinkOn);this._addTextNode();}}else{if(elFirstPageLinkOff){this._welPageList.append(elFirstPageLinkOff);this._addTextNode();}}
if(nThisPageList>1){if(elPrevPageLinkOn){this._welPageList.append(elPrevPageLinkOn);this._addTextNode();}}else{if(elPrevPageLinkOff){this._welPageList.append(elPrevPageLinkOff);this._addTextNode();}}
var el,wel;for(var i=nFirstPageOfThisPageList;i<=nLastPageOfThisPageList;i++){if(i==nPage){el=jindo.$(jindo.$Template(htOption.sCurrentPageTemplate).process({page:i.toString()}));}else{el=jindo.$(jindo.$Template(htOption.sPageTemplate).process({page:i.toString()}));this._waPage.push(el);}
wel=jindo.$Element(el);if(i==nFirstPageOfThisPageList){wel.addClass(this._wrapPrefix(this.option("sClassFirst")));}
if(i==nLastPageOfThisPageList){wel.addClass(this._wrapPrefix(this.option("sClassLast")));}
this._welPageList.append(el);this._addTextNode();}
if(nThisPageList<nLastPageList){if(elNextPageLinkOn){this._welPageList.append(elNextPageLinkOn);this._addTextNode();}}else{if(elNextPageLinkOff){this._welPageList.append(elNextPageLinkOff);this._addTextNode();}}
if(nPage<nLastPage){if(elLastPageLinkOn){this._welPageList.append(elLastPageLinkOn);this._addTextNode();}}else{if(elLastPageLinkOff){this._welPageList.append(elLastPageLinkOff);this._addTextNode();}}},_empty:function(){var htOption=this.option(),elFirstPageLinkOn=htOption.elFirstPageLinkOn,elPrevPageLinkOn=htOption.elPrevPageLinkOn,elNextPageLinkOn=htOption.elNextPageLinkOn,elLastPageLinkOn=htOption.elLastPageLinkOn,elFirstPageLinkOff=htOption.elFirstPageLinkOff,elPrevPageLinkOff=htOption.elPrevPageLinkOff,elNextPageLinkOff=htOption.elNextPageLinkOff,elLastPageLinkOff=htOption.elLastPageLinkOff;htOption.elFirstPageLinkOn=this._clone(elFirstPageLinkOn);htOption.elPrevPageLinkOn=this._clone(elPrevPageLinkOn);htOption.elLastPageLinkOn=this._clone(elLastPageLinkOn);htOption.elNextPageLinkOn=this._clone(elNextPageLinkOn);htOption.elFirstPageLinkOff=this._clone(elFirstPageLinkOff);htOption.elPrevPageLinkOff=this._clone(elPrevPageLinkOff);htOption.elLastPageLinkOff=this._clone(elLastPageLinkOff);htOption.elNextPageLinkOff=this._clone(elNextPageLinkOff);this._waPage.empty();this._welPageList.empty();},_clone:function(el){if(el&&el.cloneNode){return el.cloneNode(true);}
return el;}}).extend(jindo.UIComponent);jindo.RollingChart=jindo.$Class({_nIndexOfRolling:0,_bIsRolling:false,$init:function(el,htOption){var htDefaultOption={sClassPrefix:'rollingchart-',sDirection:'down',nFPS:50,nDuration:300,nRollingInterval:100,sUrl:"",sRequestType:"jsonp",sRequestMethod:"get",htRequestParameter:null,nRequestInterval:10000,bActivateOnload:true};this.option(htDefaultOption);this.option(htOption||{});this._el=jindo.$(el);this._assignHTMLElements();this._initTimer();this._initRolling();if(this.option("bActivateOnload")){this.activate();}},_assignHTMLElements:function(){this._elList=jindo.$$.getSingle("ol",this._el);this._aItems=jindo.$$("> li",this._elList);},getList:function(){return this._elList;},getItems:function(){return this._aItems;},getListOfItem:function(elItem){return jindo.$$.getSingle("ul",elItem);},isRolling:function(){return this._bIsRolling;},_initTimer:function(){this._oRequestTimer=new jindo.Timer();},getTimer:function(){return this._oRequestTimer;},_initRolling:function(){var self=this;this._oRollingEventHandler={"end":function(){setTimeout(function(){self.fireEvent("afterRolling",{nIndex:self._nIndexOfRolling});self._roll(self._nIndexOfRolling+1);},self.option("nRollingInterval"));}};this._oRolling=new jindo.Rolling(this._el,{nFPS:this.option("nFPS"),nDuration:this.option("nDuration"),sDirection:'vertical',fEffect:jindo.Effect.linear});},getRolling:function(){return this._oRolling;},_setItemIndexToRolling:function(n){var elList=this.getListOfItem(this.getItems()[n]);var oRolling=this.getRolling();oRolling._el=elList;oRolling._elList=elList;},_onActivate:function(){var self=this;this.getTimer().start(function(){self._stopRequest();self._request();return true;},this.option("nRequestInterval"));},_onDeactivate:function(){this.getTimer().abort();},_request:function(sQuery){if(this.isRolling()){return;}
var htOption=this.option();var sUrl=htOption.sUrl;var htParameter=htOption.htRequestParameter;var self=this;this._oAjax=jindo.$Ajax(sUrl,{type:htOption.sRequestType,method:htOption.sRequestMethod,onload:function(oResponse){try{var htParam={htResponseJSON:oResponse.json()};if(!self.fireEvent("response",htParam)){return;}
if(!self.fireEvent("beforeUpdate")){return;}
var oChart=htParam.htResponseJSON;self._addItemToRolling(oChart);self.getRolling().getTransition().attach(self._oRollingEventHandler);self._roll(0);}
catch(e){}}});if(!self.fireEvent("request")){return;}
this._oAjax.request(htParameter);},_stopRequest:function(){try{this._oAjax.abort();this._oAjax=null;}
catch(e){}},_addItemToRolling:function(oChart){var self=this;var sDirection=this.option("sDirection");jindo.$A(this.getItems()).forEach(function(el,i){var wel=jindo.$Element(jindo.$("<li>"));wel.html(oChart.items[i]);var elList=self.getListOfItem(el);if(sDirection=="down"){elList.insertBefore(wel.$value(),elList.firstChild);elList.scrollTop=9999;}
else{jindo.$Element(elList).append(wel.$value());elList.scrollTop=0;}});},_removeItemRolled:function(){var self=this;var sDirection=this.option("sDirection");jindo.$A(this.getItems()).forEach(function(el,i){if(sDirection=="down"){jindo.$Element(jindo.$$("li",self.getListOfItem(el))[1]).leave();}
else{var elList=self.getListOfItem(el);jindo.$Element(jindo.$$.getSingle("li",elList)).leave();elList.scrollTop=0;}});this._nIndexOfRolling=0;},_roll:function(n){this._bIsRolling=true;this._nIndexOfRolling=n;this.fireEvent("beforeRolling",{nIndex:n});var nIndex=n;if(nIndex==this.getItems().length){this._removeItemRolled();this._nIndexOfRolling=0;this.getRolling().getTransition().detach(this._oRollingEventHandler);this._bIsRolling=false;this.fireEvent("afterUpdate");return;}
this._setItemIndexToRolling(nIndex);var nDistance=1;if(this.option("sDirection")=="down"){nDistance=-1;}
this.getRolling().moveBy(nDistance);}}).extend(jindo.UIComponent);jindo.ScrollBox=new jindo.$Class({$init:function(el,htOption){this.option({sClassPrefix:"scrollbar-",bActivateOnload:true,sOverflowX:"auto",sOverflowY:"auto",bAdjustThumbSize:true,nMinThumbSize:50,nDelta:16});this.option(htOption||{});this._el=jindo.$(el);if(this.option("bActivateOnload")){this.activate();this.reset();}},reset:function(){this._autoToggleScrollBar();var oStatusH=this.hasScrollBarHorizontal();var oStatusV=this.hasScrollBarVertical();this._adjustBoxSize();this._adjustContentSize();this._autoToggleScrollBar();if(oStatusH!=this.hasScrollBarHorizontal()||oStatusV!=this.hasScrollBarVertical()){this._adjustBoxSize();this._adjustContentSize();}
this._autoToggleAvailability();this._adjustTrackSize();this._adjustThumbSize();this.$super.reset();},_onActivate:function(){this.$super._onActivate();this.reset();},_onDeactivate:function(){this.$super._onDeactivate();this._adjustBoxSize();},setSize:function(nWidth,nHeight){if(nWidth){jindo.$Element(this._el).css("width",nWidth+"px");}
if(nHeight){jindo.$Element(this._el).css("height",nHeight+"px");}
this.setBoxSize(nWidth,nHeight);this._oBoxSize={nWidth:jindo.$Element(this._elBox).width(),nHeight:jindo.$Element(this._elBox).height()};this.reset();},getContentSize:function(){var welContent=jindo.$Element(this._elContent);return{nWidth:parseInt(welContent.width(),10),nHeight:parseInt(welContent.height(),10)};},setContentSize:function(nWidth,nHeight){var welContent=jindo.$Element(this._elContent);if(nWidth){if(nWidth==Infinity){welContent.css("width","");}
else{welContent.css("width",nWidth+"px");}}
if(nHeight){if(nHeight==Infinity){welContent.css("height","auto");}
else{welContent.css("height",nHeight+"px");}}
this.$super.reset();},getBoxSize:function(){var welBox=jindo.$Element(this._elBox);return{nWidth:parseInt(welBox.width(),10),nHeight:parseInt(welBox.height(),10)};},setBoxSize:function(nWidth,nHeight){var welBox=jindo.$Element(this._elBox);if(nWidth){welBox.css("width",nWidth+"px");}
if(nHeight){welBox.css("height",nHeight+"px");}
this.$super.reset();},getTrackSize:function(ht){if(!ht.elScrollBar){return{nWidth:0,nHeight:0};}
var welTrack=jindo.$Element(ht.elTrack);return{nWidth:parseInt(welTrack.width(),10),nHeight:parseInt(welTrack.height(),10)};},setTrackSize:function(o,nWidth,nHeight){var welTrack=jindo.$Element(o.elTrack);if(nWidth){welTrack.css("width",nWidth+"px");}
if(nHeight){welTrack.css("height",nHeight+"px");}},isNeededScrollBarHorizontal:function(){if(this.option("sOverflowX")=="scroll"){return true;}
var oContentSize=this.getContentSize();var oBoxSize=this.getDefaultBoxSize();if(this.getScrollBarHorizontal().elScrollBar&&this.option("sOverflowX")!="hidden"){if(this.hasScrollBarVertical()){if(oContentSize.nWidth>oBoxSize.nWidth-jindo.$Element(this.getScrollBarVertical().elScrollBar).width()){return true;}}
if(oContentSize.nWidth>oBoxSize.nWidth){return true;}}
return false;},isNeededScrollBarVertical:function(){if(this.option("sOverflowY")=="scroll"){return true;}
var oContentSize=this.getContentSize();var oBoxSize=this.getDefaultBoxSize();if(this.getScrollBarVertical().elScrollBar&&this.option("sOverflowY")!="hidden"){if(this.hasScrollBarHorizontal()){if(oContentSize.nHeight>oBoxSize.nHeight-jindo.$Element(this.getScrollBarHorizontal().elScrollBar).height()){return true;}}
if(oContentSize.nHeight>oBoxSize.nHeight){return true;}}
return false;},_autoToggleScrollBar:function(){if(!this.isActivating()){return;}
var sClassPrefix=this.option("sClassPrefix");var oH=this.getScrollBarHorizontal();var oV=this.getScrollBarVertical();var welScrollBar;var bAjustThumbSize=this.option("bAdjustThumbSize");var bV=this.isNeededScrollBarVertical();if(oV.elScrollBar){welScrollBar=jindo.$Element(oV.elScrollBar);if(bV){welScrollBar.addClass(sClassPrefix+"show");}else{welScrollBar.removeClass(sClassPrefix+"show");}
if(oV.elThumb&&bAjustThumbSize){jindo.$Element(oV.elThumb).css("height","0px");}}
var bH=this.isNeededScrollBarHorizontal();if(oH.elScrollBar){welScrollBar=jindo.$Element(oH.elScrollBar);if(bH){welScrollBar.addClass(sClassPrefix+"show");}else{welScrollBar.removeClass(sClassPrefix+"show");}
if(oH.elThumb&&bAjustThumbSize){jindo.$Element(oH.elThumb).css("width","0px");}}
if(oV.elScrollBar){welScrollBar=jindo.$Element(oV.elScrollBar);if(this.isNeededScrollBarVertical()){welScrollBar.addClass(sClassPrefix+"show");}else{welScrollBar.removeClass(sClassPrefix+"show");}
if(oV.elThumb&&bAjustThumbSize){jindo.$Element(oV.elThumb).css("height","0px");}}},_adjustTrackSize:function(){if(!this.isActivating()){return;}
var oBoxSize=this.getDefaultBoxSize();var oH=this.getScrollBarHorizontal();var oV=this.getScrollBarVertical();var bH=this.isNeededScrollBarHorizontal();if(bH&&oH.elScrollBar){var nTrackWidth=oBoxSize.nWidth;var wel=jindo.$Element(oH.elScrollBar);wel.css("top",oBoxSize.nHeight-wel.height()+"px");var nVerticalWidth=0;if(this.hasScrollBarVertical()&&oV.elScrollBar){nVerticalWidth=parseInt(jindo.$Element(oV.elScrollBar).width(),10);nTrackWidth-=nVerticalWidth;}
wel.width(nTrackWidth);var nButtonLeftWidth=0;if(oH.elButtonLeft){nButtonLeftWidth=parseInt(jindo.$Element(oH.elButtonLeft).width(),10);nTrackWidth-=nButtonLeftWidth;}
if(oH.elButtonRight){nTrackWidth-=parseInt(jindo.$Element(oH.elButtonRight).width(),10);}
jindo.$Element(oH.elTrack).css("left",nButtonLeftWidth+"px");this.setTrackSize(oH,nTrackWidth,null);}
var bV=this.isNeededScrollBarVertical();if(bV&&oV.elScrollBar){var nTrackHeight=oBoxSize.nHeight;var nHorizontalHeight=0;if(this.hasScrollBarHorizontal()&&oH.elScrollBar){nHorizontalHeight=parseInt(jindo.$Element(oH.elScrollBar).height(),10);nTrackHeight-=nHorizontalHeight;}
if(oV.elButtonUp){nTrackHeight-=parseInt(jindo.$Element(oV.elButtonUp).height(),10);}
if(oV.elButtonDown){nTrackHeight-=parseInt(jindo.$Element(oV.elButtonDown).height(),10);}
this.setTrackSize(oV,null,nTrackHeight);}},_adjustBoxSize:function(){var oBoxSize=this.getDefaultBoxSize();var oH=this.getScrollBarHorizontal();var oV=this.getScrollBarVertical();var bV=this.hasScrollBarVertical();var bH=this.hasScrollBarHorizontal();this.setBoxSize(oBoxSize.nWidth,oBoxSize.nHeight);if(this.isActivating()){if(bH&&oH.elScrollBar){var nHeight=oBoxSize.nHeight;nHeight-=parseInt(jindo.$Element(oH.elScrollBar).height(),10);this.setBoxSize(null,nHeight);}
if(bV&&oV.elScrollBar){var nWidth=oBoxSize.nWidth;nWidth-=parseInt(jindo.$Element(oV.elScrollBar).width(),10);this.setBoxSize(nWidth,null);}}},_adjustContentSize:function(){if(!this.isActivating()){return;}
var oBoxSize=this.getBoxSize();var bV=this.option("sOverflowY")!="hidden";var bH=this.option("sOverflowX")!="hidden";var nWidth,nHeight;if(bV&&!bH){nWidth=oBoxSize.nWidth;}
if(bH&&!bV){nHeight=oBoxSize.nHeight;}
this.setContentSize(nWidth||Infinity,nHeight||Infinity);},_adjustThumbSize:function(){if(!this.isActivating()){return;}
if(!this.option("bAdjustThumbSize")){return;}
var nMinThumbSize=this.option("nMinThumbSize");if(typeof nMinThumbSize=="undefined"){nMinThumbSize=50;}
var oContentSize=this.getContentSize();var oBoxSize=this.getBoxSize();var nGap;var oH=this.getScrollBarHorizontal();var oV=this.getScrollBarVertical();if(oV.elScrollBar){var oTrackSizeV=this.getTrackSize(oV);var nThumbHeight=Math.floor(parseInt(oTrackSizeV.nHeight*oBoxSize.nHeight/oContentSize.nHeight,10));if(isNaN(nThumbHeight)){nThumbHeight=0;}
if(nThumbHeight<nMinThumbSize){nThumbHeight=nMinThumbSize;}
if(nThumbHeight>=oTrackSizeV.nHeight){nThumbHeight=oTrackSizeV.nHeight;}
jindo.$Element(oV.elThumb).height(nThumbHeight);nGap=0;if(oV.elThumbHead){nGap+=jindo.$Element(oV.elThumbHead).height();}
if(oV.elThumbFoot){nGap+=jindo.$Element(oV.elThumbFoot).height();}
if(oV.elThumbBody){jindo.$Element(oV.elThumbBody).height(nThumbHeight-nGap);}}
if(oH.elScrollBar){var oTrackSizeH=this.getTrackSize(oH);var nThumbWidth=Math.floor(parseInt(oTrackSizeH.nWidth*oBoxSize.nWidth/oContentSize.nWidth,10));if(isNaN(nThumbWidth)){nThumbWidth=0;}
if(nThumbWidth<nMinThumbSize){nThumbWidth=nMinThumbSize;}
if(nThumbWidth>=oTrackSizeH.nWidth){nThumbWidth=oTrackSizeH.nWidth;}
jindo.$Element(oH.elThumb).width(nThumbWidth);nGap=0;if(oH.elThumbHead){nGap+=jindo.$Element(oH.elThumbHead).width();}
if(oH.elThumbFoot){nGap+=jindo.$Element(oH.elThumbFoot).width();}
if(oH.elThumbBody){jindo.$Element(oH.elThumbBody).width(nThumbWidth-nGap);}}},_autoToggleAvailability:function(){var sClassPrefix=this.option("sClassPrefix");var oContentSize=this.getContentSize();var oBoxSize=this.getBoxSize();var oH=this.getScrollBarHorizontal();var oV=this.getScrollBarVertical();if(oH.elScrollBar){if(this.option("sOverflowX")=="scroll"&&oBoxSize.nWidth>=oContentSize.nWidth){jindo.$Element(oH.elScrollBar).addClass(sClassPrefix+"disabled");this.$super._onDeactivate("horizontal");if(this.isActivating()){jindo.$Element(this._el).removeClass(sClassPrefix+"noscript");}}else{jindo.$Element(oH.elScrollBar).removeClass(sClassPrefix+"disabled");if(this.isActivating()){this.$super._onActivate("horizontal");}}}
if(oV.elScrollBar){if(this.option("sOverflowY")=="scroll"&&oBoxSize.nHeight>=oContentSize.nHeight){jindo.$Element(oV.elScrollBar).addClass(sClassPrefix+"disabled");this.$super._onDeactivate("vertical");if(this.isActivating()){jindo.$Element(this._el).removeClass(sClassPrefix+"noscript");}}else{jindo.$Element(oV.elScrollBar).removeClass(sClassPrefix+"disabled");if(this.isActivating()){this.$super._onActivate("vertical");}}}}}).extend(jindo.ScrollBar);jindo.SelectArea=jindo.$Class({_waToggleCandidate:null,_waSelected:null,_aSizeInfo:null,$init:function(el,htOption){this._el=jindo.$(el);this._wel=jindo.$Element(this._el);var htDefaultOption={bActivateOnload:true,sClassName:"selectable",htStatus:{sSelected:"selected"},bMultiSelection:true,bDragSelect:true,nThreshold:5,bDeselectAllOutside:true,bRemainOne:false,bToggleSelected:false};this.option(htDefaultOption);this.option(htOption||{});this._waToggleCandidate=jindo.$A([]);this._waSelected=jindo.$A([]);this._sCtrl=(jindo.$Agent().os().mac)?"meta":"ctrl";this._welRectIndicator=null;this._wfDragStart=jindo.$Fn(this._onDragSelectStart,this);this._wfSelectStart=jindo.$Fn(this._onDragSelectStart,this);this._wfMouseDown=jindo.$Fn(this._onMouseDown,this);this._wfMouseMove=jindo.$Fn(this._onMouseMove,this);this._wfMouseUp=jindo.$Fn(this._onMouseUp,this);this._wfMouseUpWithinSelected=jindo.$Fn(this._onMouseUpWithinSelected,this);this._wfCompute=jindo.$Fn(this._computeSizeAndPos,this);if(this.option("bActivateOnload")){this.activate();}},getSelectableElement:function(){return jindo.$$("."+this.option("sClassName"),this._el);},isSelectable:function(el){return jindo.$Element(el).isChildOf(this._el)&&jindo.$$.test(el,"."+this.option("sClassName"));},getIndex:function(el){return jindo.$A(this.getSelectableElement()).indexOf(el);},select:function(a,bRemainSelected,bFireChangeEvent){a=this._convertArray(a);if(typeof bRemainSelected=="undefined"){bRemainSelected=false;}
if(typeof bFireChangeEvent=="undefined"){bFireChangeEvent=true;}
if(!bRemainSelected||!this.option("bMultiSelection")){this.deselectAll(false);}
var aLastSelected=this._convertArray(this.getSelected()).concat();var htStatus=this.option("htStatus");for(var i=0;i<a.length;i++){var el=a[i];var wel=jindo.$Element(el);var htCustomEvent={elSelectable:el,nIndex:this.getIndex(el),bSelectedAgain:(a.length===1&&this._vLastSelected===a[0])};if(this.isSelectable(el)&&!this.isSelected(el)&&this.fireEvent("beforeSelect",htCustomEvent)){htCustomEvent={elSelectable:el,nIndex:this.getIndex(el),bSelectedAgain:(a.length===1&&this._vLastSelected===a[0])};wel.addClass(htStatus.sSelected);this._waSelected.push(el);this.fireEvent("select",htCustomEvent);}}
if(bFireChangeEvent){this._fireChangeEvent(aLastSelected);}
return this;},deselect:function(a,bFireChangeEvent){a=this._convertArray(a);if(typeof bFireChangeEvent=="undefined"){bFireChangeEvent=true;}
var aLastSelected=this._convertArray(this.getSelected()).concat();var htStatus=this.option("htStatus");for(var i=0;i<a.length;i++){var el=a[i];var wel=jindo.$Element(el);var htParam={elSelectable:el,nIndex:this.getIndex(el)};if(this.isSelectable(el)&&this.isSelected(el)&&this.fireEvent("beforeDeselect",htParam)){wel.removeClass(htStatus.sSelected);this._waSelected=this._waSelected.refuse(el);this.fireEvent("deselect",htParam);}}
if(bFireChangeEvent){this._fireChangeEvent(aLastSelected);}
return this;},deselectAll:function(bFireChangeEvent){if(typeof bFireChangeEvent=="undefined"){bFireChangeEvent=true;}
this.deselect(this.getSelected(),bFireChangeEvent);return this;},toggle:function(a,bFireChangeEvent){a=this._convertArray(a);if(typeof bFireChangeEvent=="undefined"){bFireChangeEvent=true;}
for(var i=0;i<a.length;i++){var el=a[i];if(!this.isSelected(el)){this.select(el,true,bFireChangeEvent);}else{this.deselect(el,bFireChangeEvent);}}
return this;},getSelected:function(){if(this._waSelected.length()>0){return(this._waSelected.length()===1)?this._waSelected.get(0):this._waSelected.$value();}
return null;},isSelected:function(el){return this._waSelected.has(el);},_getSelectableUntil:function(el){var aReturn=el;var elFrom=this._elStartPoint;if(elFrom&&this.isSelected(elFrom)){var wa=jindo.$A(this.getSelectableElement());var nFrom=wa.indexOf(elFrom);var nTo=wa.indexOf(el);aReturn=wa.slice(Math.min(nFrom,nTo),Math.min(nFrom,nTo)+Math.abs(nFrom-nTo)+1).$value();}
return aReturn;},_findSelectableElement:function(el){var sClassName=this.option("sClassName");return(jindo.$$.test(el,"."+sClassName))?el:jindo.$$.getSingle("! ."+sClassName,el);},_isChanged:function(aLastSelected){var waLast=jindo.$A(aLastSelected),a=this._convertArray(this.getSelected());if(aLastSelected.length!=a.length){return true;}
for(var i=0;i<a.length;i++){if(!waLast.has(a[i])){return true;}}
return false;},_fireChangeEvent:function(aLastSelected){if(this._isChanged(aLastSelected)){this.fireEvent("change");}},_convertArray:function(a){if(!(a instanceof Array)){if(a){a=[a];}else{a=[];}}
return a;},_onMouseDown:function(we){var htKey=we.key();var htMouse=we.mouse(true);if(htMouse.scrollbar){return;}
var elSelectable=this._findSelectableElement(we.element);var aLastSelected=this._convertArray(this.getSelected()).concat();this._vLastSelected=this.getSelected();this._waSelectable=jindo.$A(this.getSelectableElement());this._waLastSelected=jindo.$A(this._convertArray(this._vLastSelected));if(elSelectable){var bWithinSelected=jindo.$A(this._convertArray(this._vLastSelected)).has(elSelectable);if(this.fireEvent("selectStart",{vLastSelected:this._vLastSelected,elSelectable:elSelectable,bWithinSelected:bWithinSelected,weEvent:we})){if(bWithinSelected&&!htKey.shift&&!htKey[this._sCtrl]){this._elWaitMouseUp=elSelectable;this._wfMouseUpWithinSelected.attach(this._elWaitMouseUp,"mouseup");}else{var bRemainSelected=false;if(this.option("bMultiSelection")){if(htKey.shift){if(htKey[this._sCtrl]){bRemainSelected=true;}
var aSelectable=this._getSelectableUntil(elSelectable);if(aSelectable==elSelectable){this._elStartPoint=elSelectable;}
this.select(aSelectable,bRemainSelected,false);}else{this._elStartPoint=elSelectable;if(htKey[this._sCtrl]){this.toggle(elSelectable,false);}else{this.select(elSelectable,bRemainSelected,false);}}}else{if(!this.option("bRemainOne")&&this.option("bToggleSelected")&&this.getSelected()==elSelectable){this.deselect(elSelectable,false);}else{this.select(elSelectable,bRemainSelected,false);}}
this._fireChangeEvent(aLastSelected);this.fireEvent("selectEnd",{vSelected:this.getSelected()});}}}else{this._wfMouseUp.attach(document,"mouseup");this._wfCompute.attach(window,"resize").attach(this._el,"scroll");if(this.option("bMultiSelection")&&this.option("bDragSelect")){this._bOverThreshold=null;this._htDragStartPos=we.pos();this._htDragStartPos.scrollTop=this._el.scrollTop;this._htDragStartPos.scrollLeft=this._el.scrollLeft;this._wfMouseMove.attach(document,"mousemove");}}},_onDragSelectStart:function(we){we.stop(jindo.$Event.CANCEL_DEFAULT);},_getRectangleElement:function(){if(!this._welRectIndicator&&this.option("bMultiSelection")&&this.option("bDragSelect")){this._welRectIndicator=jindo.$Element(jindo.$('<div style="position:absolute;left:-10px;top:-10px;width:1px;height:1px;margin:0;padding:0;border:1px dotted black;z-index:99999;">'));this._welRectIndicator.appendTo(this._el);}
return this._welRectIndicator;},getRectangleElement:function(){return this._getRectangleElement().$value();},_computeSizeAndPos:function(){var aSizeInfo=this._aSizeInfo=[];jindo.$A(this.getSelectableElement()).forEach(function(el){aSizeInfo.push([el,el.offsetLeft,el.offsetTop,el.offsetLeft+el.offsetWidth,el.offsetTop+el.offsetHeight]);});},_onMouseMove:function(we){this._htDragEndPos=we.pos();var welRect=this._getRectangleElement(),elRect=welRect.$value();var nGapX=this._htDragEndPos.pageX-this._htDragStartPos.pageX;var nGapY=this._htDragEndPos.pageY-this._htDragStartPos.pageY;var nX=this._htDragStartPos.layerX;var nY=this._htDragStartPos.layerY;var nThreshold=this.option("nThreshold");if(nThreshold&&!this._bOverThreshold){var nDistance=Math.sqrt(nGapX*nGapX+nGapY*nGapY);if(nThreshold>nDistance){return;}
this.fireEvent("dragStart");this._bOverThreshold=true;this._computeSizeAndPos();this._nRectX=nX;this._nRectY=nY;this._nDragDirectionX=1;this._nDragDirectionY=1;welRect.offset(nY,nX);if(!we.key()[this._sCtrl]){this.deselectAll(false);}}
var nWidth=nGapX;var nHeight=nGapY;this._placeRect(nX,nY,nWidth,nHeight);this._setToggleCandidate(this._getSelectableByRect([elRect,elRect.offsetLeft,elRect.offsetTop,elRect.offsetLeft+elRect.offsetWidth,elRect.offsetTop+elRect.offsetHeight]));},_placeRect:function(nX,nY,nWidth,nHeight){var welRect=this._getRectangleElement();welRect.show();this._nDragDirectionX=(nX>this._nRectX)?1:-1;this._nDragDirectionY=(nY>this._nRectY)?1:-1;nWidth-=((this._el.scrollLeft-this._htDragStartPos.scrollLeft)*this._nDragDirectionX);nHeight-=((this._el.scrollTop-this._htDragStartPos.scrollTop)*this._nDragDirectionY);welRect.width(Math.max(Math.abs(nWidth),2)).height(Math.max(Math.abs(nHeight),2));nX+=Math.min(nWidth,0);nY+=Math.min(nHeight,0);welRect.css("left",nX+"px").css("top",nY+"px");},_getSelectableByRect:function(aRect){var aReturn=[];jindo.$A(this._aSizeInfo).forEach(function(aSelectable){if(aSelectable[1]<aRect[3]&&aSelectable[3]>aRect[1]&&aSelectable[2]<aRect[4]&&aSelectable[4]>aRect[2]){aReturn.push(aSelectable[0]);jindo.$A.Continue();}});return aReturn;},_setToggleCandidate:function(a){a=this._convertArray(a);var bChanged=false;if(this._waToggleCandidate.length()!=a.length){bChanged=true;}
var htStatus=this.option("htStatus");var wa=jindo.$A(a);var waRemove=jindo.$A([]);this._waToggleCandidate.forEach(function(el,i){if(!wa.has(el)){waRemove.push(el);bChanged=true;}});if(bChanged){waRemove.forEach(function(el){this._waToggleCandidate=this._waToggleCandidate.refuse(el);jindo.$Element(el).toggleClass(htStatus.sSelected);},this);wa.forEach(function(el){if(this.isSelected(el)){jindo.$Element(el).removeClass(htStatus.sSelected);}else{jindo.$Element(el).addClass(htStatus.sSelected);}},this);this._waToggleCandidate=jindo.$A(this._waToggleCandidate.$value().concat(a)).unique();this.fireEvent("dragSelecting",{aSelectable:this._waToggleCandidate.$value()});}},_onMouseUp:function(we){var bDeselectAll=(!this.isDragging()&&!we.key()[this._sCtrl]&&(!this.option("bRemainOne")&&this.option("bDeselectAllOutside"))),bHasCandidate=this._waToggleCandidate.length(),aLastSelected=this._convertArray(this.getSelected()).concat();if(bDeselectAll){this.deselectAll(false);}
if(bHasCandidate){this._elStartPoint=this._waToggleCandidate.$value()[0];this.toggle(this._waToggleCandidate.$value());}
this._fireChangeEvent(aLastSelected);this._stopDragging();},stopSelecting:function(){this._wfMouseUpWithinSelected.detach(this._elWaitMouseUp,"mouseup");return this;},isDragging:function(){return this._bOverThreshold;},_restore:function(){jindo.$ElementList(this._waToggleCandidate.$value()).removeClass(this.option("htStatus").sSelected);this.deselectAll(false);if(this._waLastSelected.$value().length){this.select(this._waLastSelected.$value(),false,false);}},_stopDragging:function(){this._waToggleCandidate.empty();this._htDragStartPos=null;this._htDragEndPos=null;this._wfMouseMove.detach(document,"mousemove");this._wfMouseUp.detach(document,"mouseup");this._wfCompute.detach(window,"resize").detach(this._el,"scroll");if(this.isDragging()){this._bOverThreshold=null;this._getRectangleElement().hide();this.fireEvent("dragEnd");}},stopDragging:function(){if(this.isDragging()){this._restore();this._stopDragging();}
return this;},_onMouseUpWithinSelected:function(we){this.stopSelecting();var elSelectable=this._findSelectableElement(we.element);if(elSelectable&&elSelectable==we.currentElement){this.deselectAll(false);this.select(elSelectable,false,true);}},_onActivate:function(){this._sMozUserSelect=this._wel.css("MozUserSelect");this._wel.css("MozUserSelect","none");jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(true);this._wfMouseDown.attach(this._el,"mousedown");this._wfDragStart.attach(this._el,"dragstart");this._wfSelectStart.attach(this._el,'selectstart');},_onDeactivate:function(){this._wel.css("MozUserSelect",this._sMozUserSelect||'');jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(false);this._wfMouseDown.detach(this._el,"mousedown");this._wfDragStart.detach(this._el,"dragstart");this._wfSelectStart.detach(this._el,'selectstart');}}).extend(jindo.UIComponent);jindo.StarRating=jindo.$Class({$init:function(el,htOption){var htDefaultOption={nStep:1,nMaxValue:10,nDefaultValue:0,bSnap:false,bActivateOnload:true};this.option(htDefaultOption);this.option(htOption||{});this._el=jindo.$(el);this._wel=jindo.$Element(el);this._assignHTMLElements();this._wfMouseMove=jindo.$Fn(this._onMouseMove,this);this._wfMouseLeave=jindo.$Fn(this._onMouseLeave,this);this._wfClick=jindo.$Fn(this._onClick,this);if(this.option("bActivateOnload")){this.activate();}},_assignHTMLElements:function(){this._elRatingElement=jindo.$$.getSingle("span",this.getBaseElement());this._welRatingElement=jindo.$Element(this._elRatingElement);},getBaseElement:function(){return this._el;},getRatingElement:function(){return this._elRatingElement;},getValue:function(){return this._nValue;},getValueByWidth:function(){return this._welRatingElement.width()/this._nBaseWidth*this.option("nMaxValue");},getValueToBeSet:function(nValue){nValue=this._round(nValue,this.option("nStep"));nValue=Math.min(nValue,this.option("nMaxValue"));nValue=Math.max(nValue,0);return nValue;},setValue:function(nValue,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
var nMaxValue=this.option("nMaxValue");nValue=this.getValueToBeSet(nValue);var nWidth=this._nBaseWidth*nValue/nMaxValue;nWidth=Math.min(nWidth,this._nBaseWidth);this._welRatingElement.width(nWidth);this._nValue=nValue;if(bFireEvent){this.fireEvent("set",{nValue:this._nValue});}
return this;},reset:function(){var nValue=this.option("nDefaultValue")||0;this.setValue(nValue,false);return this;},_round:function(nValue,nStep){var nResult=nValue,nFloor=Math.floor(nValue),nMaxCandidate=nFloor+1,nCompare=1,nTempCompare,nCandidate,nFixed;for(nCandidate=nFloor;nCandidate<=nMaxCandidate;nCandidate+=nStep){nTempCompare=Math.abs(nValue-nCandidate);if(nTempCompare<=nCompare){nCompare=nTempCompare;nResult=nCandidate;}}
return nResult.toFixed(Math.max((nStep.toString().length-2),0));},_onActivate:function(){var el=this.getBaseElement();this._wfMouseMove.attach(el,"mousemove");this._wfMouseLeave.attach(el,"mouseleave");this._wfClick.attach(el,"click");this._nBaseWidth=this._wel.width();this.reset();},_onDeactivate:function(){var el=this.getBaseElement();this._wfMouseMove.detach(el,"mousemove");this._wfMouseLeave.detach(el,"mouseleave");this._wfClick.detach(el,"click");},_onMouseMove:function(we){var nOffsetX=we.pos(true).offsetX+1,nWidth=(nOffsetX>this._nBaseWidth)?this._nBaseWidth:nOffsetX,nValue;if(this.option("bSnap")){nValue=nOffsetX/this._nBaseWidth*this.option("nMaxValue");nWidth=this._round(nValue,this.option("nStep"))*this._nBaseWidth/this.option("nMaxValue");nWidth=Math.min(nWidth,this._nBaseWidth);}
this._welRatingElement.css("width",nWidth+"px");nValue=this.getValueByWidth();this.fireEvent("move",{nValue:nValue,nValueToBeSet:this.getValueToBeSet(nValue)});},_onMouseLeave:function(we){this.setValue(this._nValue,false);this.fireEvent("out");},_onClick:function(we){this.setValue(this.getValueByWidth());}}).extend(jindo.UIComponent);jindo.TabControl=jindo.$Class({_bIsActivating:false,_nCurrentIndex:null,_welSelectedTab:null,_welSelectedPanel:null,$init:function(el,htOption){var htDefaultOption={sClassPrefix:'tc-',sCheckEvent:"click",bActivateOnload:true};this.option(htDefaultOption);this.option(htOption||{});this._el=jindo.$(el);this._wfEventTab=jindo.$Fn(this._onEventTab,this);this._assignHTMLElements();if(this.option("bActivateOnload")){this._selectTab(this._elSelectedTab);this.activate();}},_assignHTMLElements:function(){var sPrefix=this.option('sClassPrefix'),el=this._el;this._aTab=jindo.$$('.'+sPrefix+'tab',el);this._aPanel=jindo.$$('.'+sPrefix+'panel',el);this._elSelectedTab=jindo.$$.getSingle('.'+sPrefix+'tab.'+sPrefix+'selected',el)||this.getTab(0);this._waTab=jindo.$A(this._aTab);},getTab:function(n){return this.getTabs()[n];},getTabs:function(){return this._aTab;},getPanel:function(n){return this.getPanels()[n];},getPanels:function(){return this._aPanel;},selectTab:function(n,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
this._selectTab(this.getTab(n),bFireEvent);},getIndex:function(elTab){return this._waTab.indexOf(elTab);},getCurrentIndex:function(){return this._nCurrentIndex;},_selectTab:function(elTab,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
var sPrefix=this.option('sClassPrefix'),nIndex=this.getIndex(elTab),elPanel=this.getPanel(nIndex);if(bFireEvent){if(!this.fireEvent("beforeSelect",{nIndex:nIndex,elTab:elTab,elPanel:elPanel})){return;}}
var welTab=jindo.$Element(elTab);if(this._welSelectedTab){this._welSelectedTab.removeClass(sPrefix+'selected');}
this._welSelectedTab=welTab;welTab.addClass(sPrefix+'selected');var welPanel=jindo.$Element(elPanel);if(this._welSelectedPanel){this._welSelectedPanel.removeClass(sPrefix+'selected');}
this._welSelectedPanel=welPanel;welPanel.addClass(sPrefix+'selected');this._nCurrentIndex=nIndex;if(bFireEvent){this.fireEvent("select",{nIndex:nIndex,elTab:elTab,elPanel:elPanel});}},getBaseElement:function(){return this._el;},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(true);this._wfEventTab.attach(this._el,this.option("sCheckEvent"));},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(false);this._wfEventTab.detach(this._el,this.option("sCheckEvent"));},_onEventTab:function(we){if(this.fireEvent(we.type,{weEvent:we})){var sPrefix=this.option('sClassPrefix'),el=we.element,elTab=jindo.$$.test(el,'.'+sPrefix+'tab')?el:jindo.$$.getSingle('! .'+sPrefix+'tab',el);if(elTab){this._selectTab(elTab);}}}}).extend(jindo.UIComponent);jindo.DynamicTree=jindo.$Class({$init:function(el,htOption){var htDefaultOption={sUrl:"",sRequestType:"jsonp",sRequestMethod:"get",htRequestParameter:{}};this.option(htDefaultOption);this.option(htOption||{});this._attachEvents();this._initAjax();},_attachEvents:function(){var self=this;this.attach("beforeExpand",function(oCustomEvent){var el=oCustomEvent.element;var self=this;if(self.getNodeData(el).hasOwnProperty("_aChildren")&&self.getNodeData(el)._aChildren.length){return;}
var htRequestParameter=self.option("htRequestParameter");htRequestParameter.key=self._getNodeDataKey(el);var htParam={element:el,htRequestParameter:htRequestParameter};if(self.fireEvent("request",htParam)){self._request(htParam.htRequestParameter);}
else{oCustomEvent.stop();}});},_initAjax:function(){var htOption=this.option();var sPrefix=this.option("sClassPrefix");var sUrl=htOption.sUrl;var self=this;this._oAjax=jindo.$Ajax(sUrl,{type:htOption.sRequestType,method:htOption.sRequestMethod,onload:function(oResponse){try{var htParam={htResponseJSON:oResponse.json()};if(!self.fireEvent("response",htParam)){return;}
var elNode=self.createNode(htParam.htResponseJSON["aChildren"]);var elTargetNode=jindo.$$.getSingle("."+htParam.htResponseJSON["sKey"],self.getRootList());if(self.getChildListOfNode(elTargetNode)){return;}
self.appendNode(elTargetNode,elNode);jindo.$A(elNode).forEach(function(el){if(jindo.$$.getSingle("."+sPrefix+"has-child",el)){jindo.$Element(el).addClass(sPrefix+"collapsed");}});}
catch(e){}}});},_request:function(htRequestParameter){this._oAjax.abort();this._oAjax.request(htRequestParameter);},hasChild:function(elNode){return this._htNodeData[this._getNodeDataKey(elNode)]["bHasChild"]||(this.getChildNodes(elNode).length>0);},_makeNodeData:function(elNode){var oNodeData=this.getNodeData(elNode);oNodeData["bHasChild"]=false;if(jindo.$Element(this.getPartsOfNode(elNode).elItem).hasClass(this.option('sClassPrefix')+'has-child')){oNodeData["bHasChild"]=true;}
this.$super._makeNodeData(elNode);}}).extend(jindo.Tree);jindo.CheckBox=jindo.$Class({sTagName:'input[type=checkbox]',$init:function(el,htOption){this.option({sClassPrefix:'checkbox-'});this.option(htOption||{});this._elWrapper=jindo.$(el);this._welWrapper=jindo.$Element(el);this._assignHTMLElements();this.wfOnClickInput=jindo.$Fn(this._onClickInput,this);this.wfOnClickWrapper=jindo.$Fn(this._onClickWrapper,this);this.wfOnFocusInput=jindo.$Fn(this._onFocusInput,this);this.wfOnBlurInput=jindo.$Fn(this._onBlurInput,this);this.activate();this.paint();},_assignHTMLElements:function(){var elWrapper=this._elWrapper;this._elInput=jindo.$$.getSingle('input',elWrapper);if(this._elInput.type=="radio"){this.sTagName="input[type=radio]";this.option("sClassPrefix","radio-");}
var sPrefix=this.option('sClassPrefix');this._elSubstitute=jindo.$$.getSingle("."+sPrefix+"mark",elWrapper);this._welSubstitute=jindo.$Element(this._elSubstitute);},getInput:function(){return this._elInput;},getChecked:function(){return this.getInput().checked;},setChecked:function(b,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
var elInput=this.getInput(),bValue=elInput.checked;if(bValue!=b){elInput.checked=b;switch(elInput.type){case"checkbox":this.paint();break;case"radio":var self=this;jindo.$A(this.constructor.getInstance()).forEach(function(oRadioButton){if(oRadioButton.getInput().name==elInput.name){oRadioButton.paint();}});break;}
if(bFireEvent){this._fireChangeEvent(b);}}
return this;},_fireChangeEvent:function(b){this.fireEvent("change",{bChecked:b});},enable:function(){this.getInput().disabled=false;this.paint();return this;},disable:function(){this.getInput().disabled=true;this.paint();return this;},_onClickInput:function(we){we.stop(jindo.$Event.CANCEL_DEFAULT);var self=this;setTimeout(function(){self._welWrapper.fireEvent("click");},1);},_onClickWrapper:function(we){var elInput=this._elInput;if(elInput.disabled||we.element===elInput){return;}
elInput.focus();if(this.fireEvent("beforeChange",{bChecked:elInput.checked})){this.setChecked(((elInput.type=="radio")?true:!elInput.checked));}},_onFocusInput:function(we){this._welWrapper.addClass(this.option('sClassPrefix')+'focused');},_onBlurInput:function(we){this._welWrapper.removeClass(this.option('sClassPrefix')+'focused');},_onActivate:function(){this._welWrapper.addClass(this.option('sClassPrefix')+'applied');this.wfOnClickInput.attach(this._elInput,'click');this.wfOnClickWrapper.attach(this._elWrapper,'click');this.wfOnFocusInput.attach(this._elInput,'focus');this.wfOnBlurInput.attach(this._elInput,'blur');},_onDeactivate:function(){this._welWrapper.removeClass(this.option('sClassPrefix')+'applied');this.wfOnClickInput.detach(this._elInput,'click');this.wfOnClickWrapper.detach(this._elWrapper,'click');this.wfOnFocusInput.detach(this._elInput,'focus');this.wfOnBlurInput.detach(this._elInput,'blur');},_onPaint:function(){var sPrefix=this.option('sClassPrefix');if(this._elInput.disabled){this._welWrapper.addClass(sPrefix+'disabled');}else{this._welWrapper.removeClass(sPrefix+'disabled');}
if(this._elInput.checked){this._welSubstitute.addClass(sPrefix+'checked');}else{this._welSubstitute.removeClass(sPrefix+'checked');}}}).extend(jindo.HTMLComponent);jindo.SelectBox=jindo.$Class({sTagName:'select',_bDisabled:false,_sPrevValue:null,_nSelectedIndex:0,_bRealFocused:false,$init:function(el,htOption){this._aItemData=[];this._aListItem=[];this._aOptions=[];this.option({sClassPrefix:'selectbox-',nWidth:null,nHeight:null,bUseLayerPosition:true,aOptionHTML:[],aOptionLabel:[],LayerPosition:{sPosition:"outside-bottom",sAlign:"left",nTop:0,nLeft:0},LayerManager:{sCheckEvent:"mousedown",nShowDelay:20,nHideDelay:0}});this.option(htOption||{});this._el=jindo.$(el);this._assignHTMLElements();if(this.option("bUseLayerPosition")){this._initLayerPosition();}
this._initLayerManager();this._initRolloverClick();this._oTimer=new jindo.Timer();this._wfOnFocusSelect=jindo.$Fn(this._onFocusSelect,this);this._wfOnBlurSelect=jindo.$Fn(this._onBlurSelect,this);this._wfOnMouseDownBox=jindo.$Fn(this._onMouseDownBox,this);this._wfOnMouseDownList=jindo.$Fn(this._onMouseDownList,this);this._wfOnKeyDown=jindo.$Fn(this._onKeyDown,this);this._wfOnMouseWheel=jindo.$Fn(function(e){e.stop(jindo.$Event.CANCEL_DEFAULT);this._elLayer.scrollTop-=e.mouse().delta*16;},this);this._wfOnMouseWheelOnBody=jindo.$Fn(this.close,this);this._oAgent=jindo.$Agent();this.activate();},_assignHTMLElements:function(){var sPrefix=this.option("sClassPrefix"),el=this._el;this._wel=jindo.$Element(el);this._elSelect=jindo.$$.getSingle('select.'+sPrefix+'source',el);this._sSelectInnerHTML=this._elSelect.innerHTML;this._elOptionDefault=jindo.$$.getSingle('option.'+sPrefix+'default',el);this._elSelectOptionGroup=jindo.$$.getSingle('select.'+sPrefix+'source-option-group',el);this._elBox=jindo.$$.getSingle('.'+sPrefix+'box',el);this._elLabel=jindo.$$.getSingle('.'+sPrefix+'label',el);this._elLayer=jindo.$$.getSingle('.'+sPrefix+'layer',el);this._elList=jindo.$$.getSingle('.'+sPrefix+'list',el);this._elList.innerHTML="";this._elSelectList=jindo.$('<ul>');this._elList.insertBefore(this._elSelectList,this._elList.firstChild);},getSelectElement:function(){return this._elSelect;},getBoxElement:function(){return this._elBox;},getLabelElement:function(){return this._elLabel;},getLayerElement:function(){return this._elLayer;},getListElement:function(){return this._elList;},getSelectListElement:function(){return this._elSelectList;},_limitWidth:function(){var nWidth=this.option("nWidth");if(nWidth){jindo.$Element(this.getBoxElement()).css({"width":nWidth+"px","overflowX":"hidden"});jindo.$Element(this.getLayerElement()).css({"width":nWidth+"px","overflowX":"hidden","overflowY":"auto"});}},_limitHeight:function(){var nHeight=this.option("nHeight");if(nHeight){var welLayer=jindo.$Element(this.getLayerElement()),elToMeasure=welLayer.$value().cloneNode(true),welToMeasure=jindo.$Element(elToMeasure),nLayerHeight;welToMeasure.opacity(0);welLayer.after(welToMeasure);welToMeasure.show();nLayerHeight=welToMeasure.height();welToMeasure.leave();if(nHeight<nLayerHeight){welLayer.css({"height":nHeight+"px","overflowX":"hidden","overflowY":"auto"});}}},_initLayerManager:function(){var self=this,sPrefix=this.option("sClassPrefix"),elSelect=this.getSelectElement();this._oLayerManager=new jindo.LayerManager(this.getLayerElement(),this.option("LayerManager")).attach({beforeShow:function(oCustomEvent){if(self.fireEvent("open")){self._limitWidth();self._limitHeight();setTimeout(function(){try{elSelect.focus();}catch(e){}},10);self._wel.addClass(sPrefix+'open');if(self.option("bUseLayerPosition")){self.getLayerPosition().setPosition();}}else{oCustomEvent.stop();}},show:function(oCustomEvent){self._paintSelected();},beforeHide:function(oCustomEvent){if(self.fireEvent("close")){self._wel.removeClass(sPrefix+'open').removeClass(sPrefix+'focused');setTimeout(function(){try{self.getSelectElement().blur();}catch(e){}},10);}else{oCustomEvent.stop();setTimeout(function(){try{elSelect.focus();}catch(e){}},10);}}}).link(this.getBoxElement()).link(this.getLayerElement());},getLayerManager:function(){return this._oLayerManager;},_initRolloverClick:function(){var self=this,sPrefix=this.option("sClassPrefix");this._oRolloverClick=new jindo.RolloverClick(this.getSelectListElement(),{sCheckEvent:"mouseup",RolloverArea:{sClassName:sPrefix+"item",sClassPrefix:sPrefix+"item-"}}).attach({over:function(oCustomEvent){if(self._welOvered){self._welOvered.removeClass(sPrefix+"item-over");}
var wel=jindo.$Element(oCustomEvent.element);wel.addClass(sPrefix+"item-over");self._welOvered=wel;},out:function(oCustomEvent){oCustomEvent.stop();},click:function(oCustomEvent){var nLastSelectedIndex=self._nSelectedIndex;var nSelectedIndex=-1;jindo.$A(self._aItemData).forEach(function(htData,nIndex){if(htData.elItem===oCustomEvent.element){nSelectedIndex=nIndex;jindo.$A.Break();}});if(!self.fireEvent("click",{nIndex:nSelectedIndex,weEvent:oCustomEvent.weEvent})){return;}
if(nSelectedIndex!==-1){self.setValue(self._aItemData[nSelectedIndex].sValue);}
nSelectedIndex=self.getSelectedIndex();if(nSelectedIndex!=nLastSelectedIndex){jindo.$Element(self.getSelectElement()).fireEvent("change");self.fireEvent("change",{nIndex:nSelectedIndex,nLastIndex:nLastSelectedIndex});}
if(!jindo.$Element(oCustomEvent.element).hasClass(sPrefix+"notclose")){self.getLayerManager().hide();}}});},getRolloverClick:function(){return this._oRolloverClick;},_initLayerPosition:function(){this._oLayerPosition=new jindo.LayerPosition(this.getBoxElement(),this.getLayerElement(),this.option("LayerPosition"));},getLayerPosition:function(){return this._oLayerPosition;},_onActivate:function(){var sPrefix=this.option("sClassPrefix"),elSelect=this.getSelectElement();this._limitWidth();this._wel.removeClass(sPrefix+"noscript");jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this.getListElement()).preventTapHighlight(true);this._wfOnFocusSelect.attach(elSelect,"focus");this._wfOnBlurSelect.attach(elSelect,"blur");this._wfOnMouseDownBox.attach(this.getBoxElement(),"mousedown");this._wfOnMouseDownList.attach(this.getListElement(),"mousedown");this._wfOnKeyDown.attach(elSelect,"keydown");this._wfOnMouseWheel.attach(elSelect,"mousewheel");this._wfOnMouseWheelOnBody.attach(document,"mousewheel");this.paint();this._sPrevValue=this.getValue();},_onDeactivate:function(){this.getLayerManager().hide();var sPrefix=this.option("sClassPrefix"),elSelect=this.getSelectElement();this._wel.addClass(sPrefix+"noscript");jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this.getListElement()).preventTapHighlight(false);this._wfOnFocusSelect.detach(elSelect,"focus");this._wfOnBlurSelect.detach(elSelect,"blur");this._wfOnMouseDownBox.detach(this.getBoxElement(),"mousedown");this._wfOnMouseDownList.detach(this.getListElement(),"mousedown");this._wfOnKeyDown.detach(elSelect,"keydown");this._wfOnMouseWheel.detach(elSelect,"mousewheel");this._wfOnMouseWheelOnBody.detach(document,"mousewheel");},getValueOf:function(sText){for(var i=0,oItemData;(oItemData=this._aItemData[i]);i++){if(oItemData.sText==sText){return oItemData.sValue;}}
return null;},getValue:function(){return this.getSelectElement().value;},getText:function(){var oData=this._aItemData[this._nSelectedIndex];return oData&&oData.sText||'';},getHTML:function(){return this.getLabelElement().innerHTML;},setValue:function(sValue){this.getSelectElement().value=sValue;this._sPrevValue=this.getValue();this._paint();},getSelectedIndex:function(){return this.getSelectElement().selectedIndex;},setSelectedIndex:function(nIndex,bFireEvent){if(typeof bFireEvent=="undefined"){bFireEvent=true;}
if(this._isSelectable(nIndex)){var nLastSelectedIndex=this.getSelectedIndex();this._setSelectedIndex(nIndex);this._paint();if(bFireEvent&&nLastSelectedIndex!=nIndex){this.fireEvent("change",{nIndex:nIndex,nLastIndex:nLastSelectedIndex});}
return true;}
return false;},_setSelectedIndex:function(nIndex){this.getSelectElement().selectedIndex=nIndex;},_isSelectable:function(nIndex){var htItem=this._aItemData[nIndex];if(!htItem||htItem.bDisabled||htItem.bDefault){return false;}else{return true;}},getOptions:function(){return this._aOptions;},getListItems:function(){return this._aListItem;},getDisabled:function(){return this._bDisabled;},setOptionGroup:function(sName){if(!this._elSelectOptionGroup||!this._elOptionDefault){return false;}
var elSelect=this.getSelectElement(),sPrefix=this.option('sClassPrefix'),aGroupOption=jindo.$$("."+sPrefix+"option-group-"+sName,this._elSelectOptionGroup),elOptionDefault=this._elOptionDefault=this._elOptionDefault.cloneNode(true);elSelect.innerHTML="";elSelect.appendChild(elOptionDefault);this._nSelectedIndex=0;for(var i=0;i<aGroupOption.length;i++){elSelect.appendChild(aGroupOption[i].cloneNode(true));}
this._sPrevValue=this.getValue();this.paint();return true;},isSelected:function(){return!this._aItemData[this.getSelectedIndex()].bDefault;},setDefault:function(){var nDefaultOption=-1;jindo.$A(this._aItemData).forEach(function(o,i){if(o.bDefault||o.bSelected){nDefaultOption=i;}});if(nDefaultOption<0){nDefaultOption=0;}
this._nSelectedIndex=nDefaultOption;this._setSelectedIndex(nDefaultOption);this._sPrevValue=this.getValue();this._paint();},paint:function(){this._paintList();this._paintSelected();this._paintLabel();this.getLayerManager().setLayer(this.getLayerElement());},_paint:function(){this._paintSelected();this._paintLabel();},_paintLabel:function(){var welLabel=jindo.$Element(this.getLabelElement()),sHTML=this.option("aOptionHTML")[this._nSelectedIndex]||"",sLabel=this.option("aOptionLabel")[this._nSelectedIndex]||"",sText=this.getText();if(sHTML){if(sLabel){welLabel.html(sLabel);}else{welLabel.html(sHTML);}}else{welLabel.text(sText);}
welLabel.attr("unselectable","on");},_paintList:function(){var sPrefix=this.option('sClassPrefix');this._aOptions=jindo.$$('option',this.getSelectElement());var aOptions=this._aOptions;this._aItemData=[];this._aListItem=[];this._nSelectedIndex=0;var elList=this.getSelectListElement();elList.innerHTML="";if(this.option("nHeight")){jindo.$Element(this.getLayerElement()).css("height","auto");}
for(var i=0,elOption;(elOption=aOptions[i]);i++){var welOption=jindo.$Element(elOption),bDefault=welOption.hasClass(sPrefix+'default'),bSelected=welOption.attr("selected")=="selected",bDisabled=bDefault||elOption.disabled,sHTML=this.option("aOptionHTML")[i]||"",sText=welOption.text()||"",sValue=welOption.attr("value");if(!sValue){welOption.attr("value",sText);sValue=sText;}
this._aItemData[i]={elOption:elOption,elItem:null,sHTML:sHTML,sText:sText,sValue:sValue,bDisabled:bDisabled,bSelected:bSelected,bDefault:bDefault};var elItem=null,htItem=this._aItemData[i];if(!htItem.bDefault){elItem=jindo.$('<li>');elItem.style.cssText=htItem.elOption.style.cssText;elItem.className=htItem.elOption.className;var welItem=jindo.$Element(elItem);if(htItem.sHTML){welItem.html(htItem.sHTML);}else{welItem.text(htItem.sText);}
welItem.attr("unselectable","on");if(htItem.bDisabled){welItem.addClass(sPrefix+'item-disabled');}
else{welItem.addClass(sPrefix+'item');}
elList.appendChild(elItem);this._aListItem.push(elItem);this._aItemData[i].elItem=elItem;}}
if(jindo.$Element(this.getLayerElement()).visible()){this._limitWidth();this._limitHeight();}
if(this._elSelect.disabled){this.disable();return;}
this.enable();},_paintSelected:function(){var sPrefix=this.option('sClassPrefix'),n=this.getSelectedIndex(),htItem,nPrevSelectedIndex=this._nSelectedIndex;if(this._welSelected){this._welSelected.removeClass(sPrefix+"item-selected");this._welSelected=null;}
if(this._welOvered){this._welOvered.removeClass(sPrefix+"item-over");this._welOvered=null;}
n=Math.min(n,this._aItemData.length-1);this._nSelectedIndex=n;htItem=this._aItemData[n];if(htItem&&htItem.elItem){var elSelected=htItem.elItem,welSelected=jindo.$Element(elSelected);this._welSelected=this._welOvered=welSelected;welSelected.addClass(sPrefix+"item-selected").addClass(sPrefix+"item-over");if(this.isLayerOpened()){var elLayerElement=this.getLayerElement();var nHeight=parseInt(jindo.$Element(elLayerElement).css("height"),10),nOffsetTop=elSelected.offsetTop,nOffsetHeight=elSelected.offsetHeight,nScrollTop=elLayerElement.scrollTop,bDown;if(nPrevSelectedIndex<n){bDown=true;}else{bDown=false;}
if(nOffsetTop<nScrollTop||nOffsetTop>nScrollTop+nHeight){elLayerElement.scrollTop=nOffsetTop;}
if(bDown){if(nOffsetTop+nOffsetHeight>nHeight+nScrollTop){elLayerElement.scrollTop=(nOffsetTop+nOffsetHeight-nHeight);}}else{if(nOffsetTop<nScrollTop){elLayerElement.scrollTop=nOffsetTop;}}}}},isLayerOpened:function(){return this.getLayerManager().getVisible();},disable:function(){this.getLayerManager().hide();var sPrefix=this.option("sClassPrefix");this._wel.addClass(sPrefix+'disabled');this.getSelectElement().disabled=true;this._bDisabled=true;},enable:function(){var sPrefix=this.option("sClassPrefix");this._wel.removeClass(sPrefix+'disabled');this.getSelectElement().disabled=false;this._bDisabled=false;},open:function(){if(!this._bDisabled){this.getLayerManager().show();}
return this;},close:function(){this.getLayerManager().hide();return this;},_onMouseDownBox:function(we){we.stop(jindo.$Event.CANCEL_DEFAULT);if(!this._bDisabled){this.getLayerManager().toggle();}},_onMouseDownList:function(we){if(!jindo.$$.getSingle("! ."+this.option("sClassPrefix")+"notclose",we.element)){we.stop(jindo.$Event.CANCEL_DEFAULT);}},_getSelectableIndex:function(nIndex,nDirection,nTargetIndex){var nFirst=-1,nLast=this._aItemData.length-1,i;for(i=0;i<this._aItemData.length;i++){if(this._isSelectable(i)){if(nFirst<0){nFirst=i;}
else{nLast=i;}}}
switch(nDirection){case-1:if(nIndex==nFirst){return nIndex;}
for(i=nIndex-1;i>nFirst;i--){if(this._isSelectable(i)){return i;}}
return nFirst;case 1:if(nIndex==nLast){return nIndex;}
for(i=nIndex+1;i<nLast;i++){if(this._isSelectable(i)){return i;}}
return nLast;case Infinity:return nLast;case-Infinity:return nFirst;}},_onKeyDown:function(we){var htKey=we.key();if((this._oAgent.os().mac&&this._oAgent.navigator().safari)||(this._oAgent.navigator().ie&&this._oAgent.navigator().version==6)){var nKeyCode=htKey.keyCode;if(nKeyCode!=9){we.stop(jindo.$Event.CANCEL_DEFAULT);}
var nSelectedIndex=this.getSelectedIndex(),nTargetIndex=nSelectedIndex;switch(nKeyCode){case 37:nTargetIndex=this._getSelectableIndex(nSelectedIndex,-1);break;case 38:nTargetIndex=this._getSelectableIndex(nSelectedIndex,-1);break;case 39:nTargetIndex=this._getSelectableIndex(nSelectedIndex,1);break;case 40:nTargetIndex=this._getSelectableIndex(nSelectedIndex,1);break;case 33:nTargetIndex=this._getSelectableIndex(nSelectedIndex,-Infinity);break;case 34:nTargetIndex=this._getSelectableIndex(nSelectedIndex,Infinity);break;case 13:this.getLayerManager().hide();break;case 9:this.getLayerManager().hide();break;}
var oParam={nIndex:nTargetIndex,nLastIndex:parseInt(this._nSelectedIndex,10)};this._setSelectedIndex(nTargetIndex);this._paint();if(oParam.nIndex!=oParam.nLastIndex){this.fireEvent("change",oParam);}}else{if(this.isLayerOpened()&&(htKey.enter||htKey.keyCode==9)){this.getLayerManager().hide();}}},_onFocusSelect:function(we){var sPrefix=this.option('sClassPrefix'),wel=this._wel;if(!this.isLayerOpened()){if(this.fireEvent("focus")){this._bRealFocused=true;}else{this.getSelectElement().blur();return;}}
wel.addClass(sPrefix+'focused');if(!(this._oAgent.os().mac&&this._oAgent.navigator().safari)){var self=this;this._oTimer.start(function(){var sValue=self.getValue();if(!!self._sPrevValue&&self._sPrevValue!=sValue){var nSelectedIndex=self.getSelectElement().selectedIndex;if(!self._isSelectable(nSelectedIndex)){var nDiff=-(self._nSelectedIndex-nSelectedIndex);nDiff=(nDiff>0)?1:-1;self._setSelectedIndex(self._getSelectableIndex(self._nSelectedIndex,nDiff,nSelectedIndex));return true;}
var oParam={nIndex:nSelectedIndex,nLastIndex:parseInt(self._nSelectedIndex,10)};self._paint();if(oParam.nIndex!=oParam.nLastIndex){self.fireEvent("change",oParam);}
self._sPrevValue=sValue;}
return true;},10);}},_onBlurSelect:function(we){var self=this,sPrefix=this.option('sClassPrefix');if(this._bRealFocused){this.fireEvent("blur");this._wel.removeClass(sPrefix+'focused');this._bRealFocused=false;}
setTimeout(function(){self._oTimer.abort();},10);}}).extend(jindo.HTMLComponent);if(!document.createElement('canvas').getContext){(function(){var m=Math,mr=m.round,ms=m.sin,mc=m.cos,abs=m.abs,sqrt=m.sqrt,Z=10,Z2=Z/2,slice=Array.prototype.slice,dec2hex=[];for(var i=0;i<16;i++){for(var j=0;j<16;j++){dec2hex[i*16+j]=i.toString(16)+j.toString(16);}}
function getContext(){return this.context_||(this.context_=new CanvasRenderingContext2D_(this));}
function bind(f,obj,var_args){var a=slice.call(arguments,2);return function(){return f.apply(obj,a.concat(slice.call(arguments)));};}
var G_vmlCanvasManager_={init:function(opt_doc){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var doc=opt_doc||document;doc.createElement('canvas');doc.attachEvent('onreadystatechange',bind(this.init_,this,doc));}},init_:function(doc){if(!doc.namespaces['g_vml_']){doc.namespaces.add('g_vml_','urn:schemas-microsoft-com:vml','#default#VML');}
if(!doc.namespaces['g_o_']){doc.namespaces.add('g_o_','urn:schemas-microsoft-com:office:office','#default#VML');}
if(!doc.styleSheets['ex_canvas_']){var ss=doc.createStyleSheet();ss.owningElement.id='ex_canvas_';ss.cssText='canvas{display:inline-block;overflow:hidden;'+'text-align:left;width:300px;height:150px}'+'g_vml_\\:*{behavior:url(#default#VML)}'+'g_o_\\:*{behavior:url(#default#VML)}';}
var els=doc.getElementsByTagName('canvas');for(var i=0;i<els.length;i++){this.initElement(els[i]);}},initElement:function(el){if(!el.getContext){el.getContext=getContext;el.innerHTML='';el.attachEvent('onpropertychange',onPropertyChange);el.attachEvent('onresize',onResize);var attrs=el.attributes;if(attrs.width&&attrs.width.specified){el.style.width=attrs.width.nodeValue+'px';}else{el.width=el.clientWidth;}
if(attrs.height&&attrs.height.specified){el.style.height=attrs.height.nodeValue+'px';}else{el.height=el.clientHeight;}}
return el;}};G_vmlCanvasManager_.init();function onPropertyChange(e){var el=e.srcElement;switch(e.propertyName){case'width':el.style.width=el.attributes.width.nodeValue+'px';el.getContext().clearRect();break;case'height':el.style.height=el.attributes.height.nodeValue+'px';el.getContext().clearRect();break;}}
function onResize(e){var el=e.srcElement;if(el.firstChild){el.firstChild.style.width=el.clientWidth+'px';el.firstChild.style.height=el.clientHeight+'px';}}
function createMatrixIdentity(){return[[1,0,0],[0,1,0],[0,0,1]];}
function matrixMultiply(m1,m2){var result=createMatrixIdentity();for(var x=0;x<3;x++){for(var y=0;y<3;y++){var sum=0;for(var z=0;z<3;z++){sum+=m1[x][z]*m2[z][y];}
result[x][y]=sum;}}
return result;}
function copyState(o1,o2){o2.fillStyle=o1.fillStyle;o2.lineCap=o1.lineCap;o2.lineJoin=o1.lineJoin;o2.lineWidth=o1.lineWidth;o2.miterLimit=o1.miterLimit;o2.shadowBlur=o1.shadowBlur;o2.shadowColor=o1.shadowColor;o2.shadowOffsetX=o1.shadowOffsetX;o2.shadowOffsetY=o1.shadowOffsetY;o2.strokeStyle=o1.strokeStyle;o2.globalAlpha=o1.globalAlpha;o2.arcScaleX_=o1.arcScaleX_;o2.arcScaleY_=o1.arcScaleY_;o2.lineScale_=o1.lineScale_;}
function processStyle(styleString){var str,alpha=1;styleString=String(styleString);if(styleString.substring(0,3)=='rgb'){var start=styleString.indexOf('(',3);var end=styleString.indexOf(')',start+1);var guts=styleString.substring(start+1,end).split(',');str='#';for(var i=0;i<3;i++){str+=dec2hex[Number(guts[i])];}
if(guts.length==4&&styleString.substr(3,1)=='a'){alpha=guts[3];}}else{str=styleString;}
return{color:str,alpha:alpha};}
function processLineCap(lineCap){switch(lineCap){case'butt':return'flat';case'round':return'round';case'square':break;default:return'square';}}
function CanvasRenderingContext2D_(surfaceElement){this.m_=createMatrixIdentity();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle='#000';this.fillStyle='#000';this.lineWidth=1;this.lineJoin='miter';this.lineCap='butt';this.miterLimit=Z*1;this.globalAlpha=1;this.canvas=surfaceElement;var el=surfaceElement.ownerDocument.createElement('div');el.style.width=surfaceElement.clientWidth+'px';el.style.height=surfaceElement.clientHeight+'px';surfaceElement.appendChild(el);this.element_=el;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1;}
var contextPrototype=CanvasRenderingContext2D_.prototype;contextPrototype.clearRect=function(){this.element_.innerHTML='';};contextPrototype.beginPath=function(){this.currentPath_=[];};contextPrototype.moveTo=function(aX,aY){var p=this.getCoords_(aX,aY);this.currentPath_.push({type:'moveTo',x:p.x,y:p.y});this.currentX_=p.x;this.currentY_=p.y;};contextPrototype.lineTo=function(aX,aY){var p=this.getCoords_(aX,aY);this.currentPath_.push({type:'lineTo',x:p.x,y:p.y});this.currentX_=p.x;this.currentY_=p.y;};contextPrototype.bezierCurveTo=function(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){var p=this.getCoords_(aX,aY);var cp1=this.getCoords_(aCP1x,aCP1y);var cp2=this.getCoords_(aCP2x,aCP2y);bezierCurveTo(this,cp1,cp2,p);};function bezierCurveTo(self,cp1,cp2,p){self.currentPath_.push({type:'bezierCurveTo',cp1x:cp1.x,cp1y:cp1.y,cp2x:cp2.x,cp2y:cp2.y,x:p.x,y:p.y});self.currentX_=p.x;self.currentY_=p.y;}
contextPrototype.quadraticCurveTo=function(aCPx,aCPy,aX,aY){var cp=this.getCoords_(aCPx,aCPy);var p=this.getCoords_(aX,aY);var cp1={x:this.currentX_+2.0/3.0*(cp.x-this.currentX_),y:this.currentY_+2.0/3.0*(cp.y-this.currentY_)};var cp2={x:cp1.x+(p.x-this.currentX_)/3.0,y:cp1.y+(p.y-this.currentY_)/3.0};bezierCurveTo(this,cp1,cp2,p);};contextPrototype.arc=function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){aRadius*=Z;var arcType=aClockwise?'at':'wa';var xStart=aX+mc(aStartAngle)*aRadius-Z2;var yStart=aY+ms(aStartAngle)*aRadius-Z2;var xEnd=aX+mc(aEndAngle)*aRadius-Z2;var yEnd=aY+ms(aEndAngle)*aRadius-Z2;if(xStart==xEnd&&!aClockwise){xStart+=0.125;}
var p=this.getCoords_(aX,aY);var pStart=this.getCoords_(xStart,yStart);var pEnd=this.getCoords_(xEnd,yEnd);this.currentPath_.push({type:arcType,x:p.x,y:p.y,radius:aRadius,xStart:pStart.x,yStart:pStart.y,xEnd:pEnd.x,yEnd:pEnd.y});};contextPrototype.rect=function(aX,aY,aWidth,aHeight){this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();};contextPrototype.strokeRect=function(aX,aY,aWidth,aHeight){var oldPath=this.currentPath_;this.beginPath();this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();this.stroke();this.currentPath_=oldPath;};contextPrototype.fillRect=function(aX,aY,aWidth,aHeight){var oldPath=this.currentPath_;this.beginPath();this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();this.fill();this.currentPath_=oldPath;};contextPrototype.createLinearGradient=function(aX0,aY0,aX1,aY1){var gradient=new CanvasGradient_('gradient');gradient.x0_=aX0;gradient.y0_=aY0;gradient.x1_=aX1;gradient.y1_=aY1;return gradient;};contextPrototype.createRadialGradient=function(aX0,aY0,aR0,aX1,aY1,aR1){var gradient=new CanvasGradient_('gradientradial');gradient.x0_=aX0;gradient.y0_=aY0;gradient.r0_=aR0;gradient.x1_=aX1;gradient.y1_=aY1;gradient.r1_=aR1;return gradient;};contextPrototype.drawImage=function(image,var_args){var dx,dy,dw,dh,sx,sy,sw,sh;var oldRuntimeWidth=image.runtimeStyle.width;var oldRuntimeHeight=image.runtimeStyle.height;image.runtimeStyle.width='auto';image.runtimeStyle.height='auto';var w=image.width;var h=image.height;image.runtimeStyle.width=oldRuntimeWidth;image.runtimeStyle.height=oldRuntimeHeight;if(arguments.length==3){dx=arguments[1];dy=arguments[2];sx=sy=0;sw=dw=w;sh=dh=h;}else if(arguments.length==5){dx=arguments[1];dy=arguments[2];dw=arguments[3];dh=arguments[4];sx=sy=0;sw=w;sh=h;}else if(arguments.length==9){sx=arguments[1];sy=arguments[2];sw=arguments[3];sh=arguments[4];dx=arguments[5];dy=arguments[6];dw=arguments[7];dh=arguments[8];}else{throw Error('Invalid number of arguments');}
var d=this.getCoords_(dx,dy);var w2=sw/2;var h2=sh/2;var vmlStr=[];var W=10;var H=10;vmlStr.push(' <g_vml_:group',' coordsize="',Z*W,',',Z*H,'"',' coordorigin="0,0"',' style="width:',W,'px;height:',H,'px;position:absolute;');if(this.m_[0][0]!=1||this.m_[0][1]){var filter=[];filter.push('M11=',this.m_[0][0],',','M12=',this.m_[1][0],',','M21=',this.m_[0][1],',','M22=',this.m_[1][1],',','Dx=',mr(d.x/Z),',','Dy=',mr(d.y/Z),'');var max=d;var c2=this.getCoords_(dx+dw,dy);var c3=this.getCoords_(dx,dy+dh);var c4=this.getCoords_(dx+dw,dy+dh);max.x=m.max(max.x,c2.x,c3.x,c4.x);max.y=m.max(max.y,c2.y,c3.y,c4.y);vmlStr.push('padding:0 ',mr(max.x/Z),'px ',mr(max.y/Z),'px 0;filter:progid:DXImageTransform.Microsoft.Matrix(',filter.join(''),", sizingmethod='clip');");}else{vmlStr.push('top:',mr(d.y/Z),'px;left:',mr(d.x/Z),'px;');}
vmlStr.push(' ">','<g_vml_:image src="',image.src,'"',' style="width:',Z*dw,'px;',' height:',Z*dh,'px;"',' cropleft="',sx/w,'"',' croptop="',sy/h,'"',' cropright="',(w-sx-sw)/w,'"',' cropbottom="',(h-sy-sh)/h,'"',' />','</g_vml_:group>');this.element_.insertAdjacentHTML('BeforeEnd',vmlStr.join(''));};contextPrototype.stroke=function(aFill){var lineStr=[];var lineOpen=false;var a=processStyle(aFill?this.fillStyle:this.strokeStyle);var color=a.color;var opacity=a.alpha*this.globalAlpha;var W=10;var H=10;lineStr.push('<g_vml_:shape',' filled="',!!aFill,'"',' style="position:absolute;width:',W,'px;height:',H,'px;"',' coordorigin="0 0" coordsize="',Z*W,' ',Z*H,'"',' stroked="',!aFill,'"',' path="');var newSeq=false;var min={x:null,y:null};var max={x:null,y:null};var i;for(i=0;i<this.currentPath_.length;i++){var p=this.currentPath_[i];var c;switch(p.type){case'moveTo':c=p;lineStr.push(' m ',mr(p.x),',',mr(p.y));break;case'lineTo':lineStr.push(' l ',mr(p.x),',',mr(p.y));break;case'close':lineStr.push(' x ');p=null;break;case'bezierCurveTo':lineStr.push(' c ',mr(p.cp1x),',',mr(p.cp1y),',',mr(p.cp2x),',',mr(p.cp2y),',',mr(p.x),',',mr(p.y));break;case'at':case'wa':lineStr.push(' ',p.type,' ',mr(p.x-this.arcScaleX_*p.radius),',',mr(p.y-this.arcScaleY_*p.radius),' ',mr(p.x+this.arcScaleX_*p.radius),',',mr(p.y+this.arcScaleY_*p.radius),' ',mr(p.xStart),',',mr(p.yStart),' ',mr(p.xEnd),',',mr(p.yEnd));break;}
if(p){if(min.x===null||p.x<min.x){min.x=p.x;}
if(max.x===null||p.x>max.x){max.x=p.x;}
if(min.y===null||p.y<min.y){min.y=p.y;}
if(max.y===null||p.y>max.y){max.y=p.y;}}}
lineStr.push(' ">');if(!aFill){var lineWidth=this.lineScale_*this.lineWidth;if(lineWidth<1){opacity*=lineWidth;}
lineStr.push('<g_vml_:stroke',' opacity="',opacity,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',processLineCap(this.lineCap),'"',' weight="',lineWidth,'px"',' color="',color,'" />');}else if(typeof this.fillStyle=='object'){var fillStyle=this.fillStyle;var angle=0;var focus={x:0,y:0};var shift=0;var expansion=1;var p0;if(fillStyle.type_=='gradient'){var x0=fillStyle.x0_/this.arcScaleX_;var y0=fillStyle.y0_/this.arcScaleY_;var x1=fillStyle.x1_/this.arcScaleX_;var y1=fillStyle.y1_/this.arcScaleY_;p0=this.getCoords_(x0,y0);var p1=this.getCoords_(x1,y1);var dx=p1.x-p0.x;var dy=p1.y-p0.y;angle=Math.atan2(dx,dy)*180/Math.PI;if(angle<0){angle+=360;}
if(angle<1e-6){angle=0;}}else{p0=this.getCoords_(fillStyle.x0_,fillStyle.y0_);var width=max.x-min.x;var height=max.y-min.y;focus={x:(p0.x-min.x)/width,y:(p0.y-min.y)/height};width/=this.arcScaleX_*Z;height/=this.arcScaleY_*Z;var dimension=m.max(width,height);shift=2*fillStyle.r0_/dimension;expansion=2*fillStyle.r1_/dimension-shift;}
var stops=fillStyle.colors_;stops.sort(function(cs1,cs2){return cs1.offset-cs2.offset;});var length=stops.length;var color1=stops[0].color;var color2=stops[length-1].color;var opacity1=stops[0].alpha*this.globalAlpha;var opacity2=stops[length-1].alpha*this.globalAlpha;var colors=[];for(i=0;i<length;i++){var stop=stops[i];colors.push(stop.offset*expansion+shift+' '+stop.color);}
lineStr.push('<g_vml_:fill type="',fillStyle.type_,'"',' method="none" focus="100%"',' color="',color1,'"',' color2="',color2,'"',' colors="',colors.join(','),'"',' opacity="',opacity2,'"',' g_o_:opacity2="',opacity1,'"',' angle="',angle,'"',' focusposition="',focus.x,',',focus.y,'" />');}else{lineStr.push('<g_vml_:fill color="',color,'" opacity="',opacity,'" />');}
lineStr.push('</g_vml_:shape>');this.element_.insertAdjacentHTML('beforeEnd',lineStr.join(''));};contextPrototype.fill=function(){this.stroke(true);};contextPrototype.closePath=function(){this.currentPath_.push({type:'close'});};contextPrototype.getCoords_=function(aX,aY){var m=this.m_;return{x:Z*(aX*m[0][0]+aY*m[1][0]+m[2][0])-Z2,y:Z*(aX*m[0][1]+aY*m[1][1]+m[2][1])-Z2};};contextPrototype.save=function(){var o={};copyState(this,o);this.aStack_.push(o);this.mStack_.push(this.m_);this.m_=matrixMultiply(createMatrixIdentity(),this.m_);};contextPrototype.restore=function(){copyState(this.aStack_.pop(),this);this.m_=this.mStack_.pop();};function matrixIsFinite(m){for(var j=0;j<3;j++){for(var k=0;k<2;k++){if(!isFinite(m[j][k])||isNaN(m[j][k])){return false;}}}
return true;}
function setM(ctx,m,updateLineScale){if(!matrixIsFinite(m)){return;}
ctx.m_=m;if(updateLineScale){var det=m[0][0]*m[1][1]-m[0][1]*m[1][0];ctx.lineScale_=sqrt(abs(det));}}
contextPrototype.translate=function(aX,aY){var m1=[[1,0,0],[0,1,0],[aX,aY,1]];setM(this,matrixMultiply(m1,this.m_),false);};contextPrototype.rotate=function(aRot){var c=mc(aRot);var s=ms(aRot);var m1=[[c,s,0],[-s,c,0],[0,0,1]];setM(this,matrixMultiply(m1,this.m_),false);};contextPrototype.scale=function(aX,aY){this.arcScaleX_*=aX;this.arcScaleY_*=aY;var m1=[[aX,0,0],[0,aY,0],[0,0,1]];setM(this,matrixMultiply(m1,this.m_),true);};contextPrototype.transform=function(m11,m12,m21,m22,dx,dy){var m1=[[m11,m12,0],[m21,m22,0],[dx,dy,1]];setM(this,matrixMultiply(m1,this.m_),true);};contextPrototype.setTransform=function(m11,m12,m21,m22,dx,dy){var m=[[m11,m12,0],[m21,m22,0],[dx,dy,1]];setM(this,m,true);};contextPrototype.clip=function(){};contextPrototype.arcTo=function(){};contextPrototype.createPattern=function(){return new CanvasPattern_();};function CanvasGradient_(aType){this.type_=aType;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[];}
CanvasGradient_.prototype.addColorStop=function(aOffset,aColor){aColor=processStyle(aColor);this.colors_.push({offset:aOffset,color:aColor.color,alpha:aColor.alpha});};function CanvasPattern_(){}
G_vmlCanvasManager=G_vmlCanvasManager_;CanvasRenderingContext2D=CanvasRenderingContext2D_;CanvasGradient=CanvasGradient_;CanvasPattern=CanvasPattern_;})();}
jindo.Canvas=jindo.$Class({$init:function(el){if(typeof el=="undefined"){el=jindo.Canvas.create();}
this._el=el;this._elContainer=this._el.parentNode;this._oContext=jindo.Canvas.getContext(el);},getElement:function(){return this._el;},getContainer:function(){return this._elContainer;},width:function(n){if(typeof n=="number"){this._el.width=n;return this;}
return this._el.width;},height:function(n){if(typeof n=="number"){this._el.height=n;return this;}
return this._el.height;},getContext:function(){return this._oContext;},clear:function(){this._oContext.clearRect(0,0,this._el.width,this._el.height);return this;},_merge:function(ctx,htOption){for(var sKey in htOption){ctx[sKey]=htOption[sKey];}},drawLine:function(a,htOption,bBlockAntiAlias){var ctx=this._oContext,nAdjust=0,nLen=a.length,i;htOption=htOption||{};if(nLen>1){if(typeof bBlockAntiAlias=="undefined"){bBlockAntiAlias=true;}
ctx.save();this._merge(ctx,htOption);ctx.beginPath();if(bBlockAntiAlias){if(ctx.lineWidth%2===1){nAdjust=0.5;}
if(nLen===2){if(a[0][0]===a[1][0]){ctx.moveTo((Math.round(a[0][0])+nAdjust),a[0][1]);ctx.lineTo((Math.round(a[1][0])+nAdjust),a[1][1]);}
if(a[0][1]===a[1][1]){ctx.moveTo(a[0][0],(Math.round(a[0][1])+nAdjust));ctx.lineTo(a[1][0],(Math.round(a[1][1])+nAdjust));}}else{ctx.moveTo((Math.round(a[0][0])+nAdjust),(Math.round(a[0][1])+nAdjust));for(i=1;i<nLen;i++){ctx.lineTo((Math.round(a[i][0])+nAdjust),(Math.round(a[i][1])+nAdjust));}}}else{ctx.moveTo(a[0][0],a[0][1]);for(i=1;i<nLen;i++){ctx.lineTo(a[i][0],a[i][1]);}}
ctx.stroke();ctx.closePath();ctx.restore();}
return this;},drawFace:function(a,htOption){var ctx=this._oContext,nLen=a.length;htOption=htOption||{};if(nLen>2){ctx.save();this._merge(ctx,htOption);ctx.beginPath();ctx.moveTo(a[0][0],a[0][1]);for(var i=1;i<nLen;i++){ctx.lineTo(a[i][0],a[i][1]);}
ctx.fill();ctx.closePath();ctx.restore();}
return this;},_round:function(n,nLineWidth){return(nLineWidth%2===1)?Math.round(n)+0.5:n;},drawRect:function(nX,nY,nWidth,nHeight,htOption,bBlockAntiAlias){var ctx=this._oContext,bFillDefined=typeof htOption["fillStyle"]!="undefined",bStrokeDefined=typeof htOption["strokeStyle"]!="undefined"&&htOption["lineWidth"]>0;htOption=htOption||{};if(bFillDefined||bStrokeDefined){ctx.save();this._merge(ctx,htOption);if(bFillDefined){ctx.fillRect(nX,nY,nWidth,nHeight);}
if(bStrokeDefined){if(typeof bBlockAntiAlias=="undefined"){bBlockAntiAlias=true;}
if(bBlockAntiAlias){nX=this._round(nX,ctx.lineWidth);nY=this._round(nY,ctx.lineWidth);nHeight=Math.round(nHeight);nWidth=Math.round(nWidth);}
ctx.strokeRect(nX,nY,nWidth,nHeight);}
ctx.restore();}
return this;}});jindo.Canvas.create=function(nWidth,nHeight,elParent){var elCanvas=document.createElement('canvas');elCanvas.setAttribute("width",nWidth||300);elCanvas.setAttribute("height",nHeight||150);if(typeof elCanvas.getContext=="undefined"){G_vmlCanvasManager.initElement(elCanvas);}
if(elParent){elParent.appendChild(elCanvas);}
return elCanvas;};jindo.Canvas.getContext=function(el){return el.getContext("2d");};jindo.LazyLoading={_bIE:jindo.$Agent().navigator().ie,_waLoading:jindo.$A([]),_waLoaded:jindo.$A([]),_whtScript:jindo.$H({}),_whtCallback:jindo.$H({})};jindo.LazyLoading.load=function(sUrl,fCallback,sCharset){if(typeof fCallback!="function"){fCallback=function(){};}
this._queueCallback(sUrl,fCallback);if(this._checkIsLoading(sUrl)){return false;}
if(this._checkAlreadyLoaded(sUrl)){this._doCallback(sUrl);return true;}
this._waLoading.push(sUrl);var self=this;var elHead=document.getElementsByTagName("head")[0];var elScript=document.createElement("script");elScript.type="text/javascript";elScript.charset=sCharset||"utf-8";elScript.src=sUrl;this._whtScript.add(sUrl,elScript);if(this._bIE){elScript.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){self._waLoaded.push(sUrl);self._waLoading=self._waLoading.refuse(sUrl);self._doCallback(sUrl);this.onreadystatechange=null;}};}else{elScript.onload=function(){self._waLoaded.push(sUrl);self._waLoading=self._waLoading.refuse(sUrl);self._doCallback(sUrl);};}
elHead.appendChild(elScript);return true;};jindo.LazyLoading._queueCallback=function(sUrl,fCallback){var aCallback=this._whtCallback.$(sUrl);if(aCallback){aCallback.push(fCallback);}else{this._whtCallback.$(sUrl,[fCallback]);}};jindo.LazyLoading._doCallback=function(sUrl){var aCallback=this._whtCallback.$(sUrl).concat();for(var i=0;i<aCallback.length;i++){this._whtCallback.$(sUrl).splice(i,1);aCallback[i]();}};jindo.LazyLoading.abort=function(sUrl){if(this._checkIsLoading(sUrl)){var elScript=this.getScriptElement(sUrl);this._waLoading=this._waLoading.refuse(sUrl);if(this._bIE){elScript.onreadystatechange=null;}else{elScript.onload=null;}
jindo.$Element(elScript).leave();this._whtScript.remove(sUrl);this._whtCallback.remove(sUrl);return true;}else{return false;}};jindo.LazyLoading._checkAlreadyLoaded=function(sUrl){return this._waLoaded.has(sUrl);};jindo.LazyLoading._checkIsLoading=function(sUrl){return this._waLoading.has(sUrl);};jindo.LazyLoading.getLoaded=function(){return this._waLoaded.$value();};jindo.LazyLoading.getLoading=function(){return this._waLoading.$value();};jindo.LazyLoading.getScriptElement=function(sUrl){return this._whtScript.$(sUrl)||null;};